function resetWithholdeeInfoInShipping(){
	document.getElementById('in_shippingTaxTable_14').value="";
	document.getElementById('in_shippingTaxTable_4').value="";
	document.getElementById('in_shippingTaxTable_3').value="";
	document.getElementById('in_shippingTaxTable_15').value = "";
	document.getElementById('in_shippingTaxTable_16').value = "";
	document.getElementById('in_shippingTaxTable_4').readOnly=false;
	document.getElementById('in_shippingTaxTable_16').readOnly=false;
	document.getElementById('in_shippingTaxTable_15').readOnly=false;
	document.getElementById("in_shippingTaxTable_4").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById("in_shippingTaxTable_16").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById("in_shippingTaxTable_15").className='form101_textfcurr form101_textfcurr_width';
}

function calcOnShippingInvoice()
{
	resetErrorList();
	if(document.getElementById('in_shippingTaxTable_12').value=="")
	{
		document.getElementById('in_shippingTaxTable_12').value=0;
	}
	if(document.getElementById('in_shippingTaxTable_13').value=="")
	{
		document.getElementById('in_shippingTaxTable_13').value=0;
	}
	if(validateFormFields(shippingGrossOutwardJsone))
	{

		if(validateFormFields(shippingOutwardPassengerJsone))
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			var grossOutwardFreights=removeCommaFrmInput(document.getElementById('in_shippingTaxTable_12').value);
			var outwardPassengerFares=removeCommaFrmInput(document.getElementById('in_shippingTaxTable_13').value);
			document.getElementById('in_shippingTaxTable_7').value=convertToKenyanShillingFormatVal(parseInt(grossOutwardFreights,10)+parseInt(outwardPassengerFares,10));
			var invoiceValue=removeCommaFrmInput(document.getElementById('in_shippingTaxTable_7').value);
			var taxRate=document.getElementById('in_shippingTaxTable_11').value;
			var afterTax=parseInt(Math.ceil(parseInt(invoiceValue,10)*parseFloat(taxRate)/parseInt(100,10)),10);
			document.getElementById('in_shippingTaxTable_7').value=convertToKenyanShillingFormatVal(invoiceValue, true);
			document.getElementById('in_shippingTaxTable_8').value=convertToKenyanShillingFormatVal(afterTax, true);
			document.getElementById('in_shippingTaxTable_12').value=convertToKenyanShillingFormatVal(grossOutwardFreights, true);
			document.getElementById('in_shippingTaxTable_13').value=convertToKenyanShillingFormatVal(outwardPassengerFares, true);
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
	}
	else
	{
		getErrTabToggle('TabView','2');	
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}
}

function beforeAddShippingFunction(row)
{
	if(document.getElementById('hidIsPartial').value != "Y")
	{
		if(checkDuplicateFlag){
			checkDuplicateFlag = isShippingRegistered();
		}
	}
	var checkDuplicateFlag = checkMonthYearInAddRowShipping(row,'shippingTaxTable'); 
	if(checkDuplicateFlag==false)
	{
		return false;
	}
	var checkDuplicateFlag = checkDuplicateShipping(row,'shippingTaxTable');
	if(checkDuplicateFlag==false)
	{
		return false;
	}
	else
	{
		amtToPaidShipping=parseInt(removeCommaFrmInput(document.getElementById('in_shippingTaxTable_8').value),10)+parseInt(removeCommaFrmInput(document.getElementById('txtTotalTaxValue').value),10);
		amtOfInvoceShipping=parseInt(removeCommaFrmInput(document.getElementById('in_shippingTaxTable_7').value),10)+parseInt(removeCommaFrmInput(document.getElementById('txtTotalInvocieValue').value),10);
		document.getElementById('shippingTaxTable').style.display = '';
		document.getElementById('hidTaxRateShipping').value=document.getElementById('in_shippingTaxTable_11').value;
	}
}

function afterAddShippingFunction()
{
//	document.getElementById('in_shippingTaxTable_11').value=document.getElementById('hidTaxRateShipping').value;
	document.getElementById('txtTotalTaxValue').value=convertToKenyanShillingFormatVal(amtToPaidShipping,true);
	document.getElementById('txtTotalInvocieValue').value=convertToKenyanShillingFormatVal(amtOfInvoceShipping,true);
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(amtToPaidShipping,true); 
	document.getElementById('in_shippingTaxTable_4').readOnly=false;
	document.getElementById('in_shippingTaxTable_16').readOnly=false;
	document.getElementById('in_shippingTaxTable_15').readOnly=false;
	document.getElementById("in_shippingTaxTable_4").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById("in_shippingTaxTable_16").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById("in_shippingTaxTable_15").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById('in_shippingTaxTable_12').value=0;
	document.getElementById('in_shippingTaxTable_13').value=0;
	document.getElementById('in_shippingTaxTable_7').value=0;
	document.getElementById('in_shippingTaxTable_8').value=0;
	document.getElementById('in_shippingTaxTable_9').selectedIndex=0;
	selectedFlagShipping=selectedFlagShipping+1;
	if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
	{
		for(var i=3; i<18;i++)
		{
			document.getElementById('in_shippingTaxTable_'+i).readOnly=true;
			if(document.getElementById('in_shippingTaxTable_'+i).className=='readonlyInput form101_textfcurr_width textonlyRight' || document.getElementById('in_shippingTaxTable_'+i).className=='form101_textfcurr form101_textfcurr_width textonlyRight')
			{
				document.getElementById('in_shippingTaxTable_'+i).className='readonlyInput form101_textfcurr_width textonlyRight';
			}
			else
			{
				document.getElementById('in_shippingTaxTable_'+i).className='readonlyInput form101_textfcurr_width';
			}
		}
		var tabObj1 = document.getElementById('shippingTaxTable');
		for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
		{ 
			document.getElementById('id_shippingTaxTable_'+i+'_2').href = '#'; 
			document.getElementById('id_shippingTaxTable_'+i+'_2').style.visibility = 'hidden'; 
		}
		document.getElementById('shippingRadio_'+rowNumbmerPartial).checked=false;
		selectedFlagPartial=selectedFlagPartial+1;
	}
	createSkipFieldForAddRow('shippingTaxTable','paymentRegForm');
}

function onchangeWithholPINShip(obj){
	var pin = trim(obj.value);
	if(validPIN(obj)){
		FetchTaxpayerDetailWithoutValidationSplObl.fetchTaxpayerDetailWithoutValidationSplObl(pin, {async:false,callback:function(data){
			if(data != NULL &&  data != null){
				if(data.isDataAvailable == N_FLAG){
					if(data.isAgent == ERROR ||data.isAgent == NO_CALL_MADE){ // Handled Scenario : 1) if no call made from Controller to impl 2) impl to facade
						alert(errFetchingData);
					}
					else if(data.isAgent == NO_DETAILS_FOUND){// Handled Scenario : 1) call made to facade with invalid PIN
						alert(validPin);
					}
					resetWithholdeeInfoInShipping();
					return false;
				}
				if(data.taxPayerFirstName != null || data.taxPayerId != null){
					document.getElementById('in_shippingTaxTable_4').readOnly=true;
					document.getElementById('in_shippingTaxTable_16').readOnly=true;
					document.getElementById('in_shippingTaxTable_15').readOnly=true;
					document.getElementById("in_shippingTaxTable_4").className='readonlyInput form101_textfcurr_width';
					document.getElementById("in_shippingTaxTable_16").className='readonlyInput form101_textfcurr_width';
					document.getElementById("in_shippingTaxTable_15").className='readonlyInput form101_textfcurr_width';
					if(data.taxPayerId!=null || data.taxPayerId!="")
					{
						document.getElementById('in_shippingTaxTable_14').value = data.taxPayerId;
					}
					if(data.taxPayerFirstName!=null || data.taxPayerFirstName!="")
					{
						document.getElementById('in_shippingTaxTable_4').value=data.taxPayerFirstName;
					}
					if(data.mobileNumber!=null || data.mobileNumber!="")
					{
						document.getElementById('in_shippingTaxTable_16').value=data.mobileNumber;
					}
					if(data.taxPayerFullAddr!=null || data.taxPayerFullAddr!="")
					{
						dwr.util.setValue('in_shippingTaxTable_15',data.taxPayerFullAddr);
					}
					updateAddrCountdownShip();
				}
				if(data.taxPayerFirstName == 'null' || data.taxPayerFirstName == null){
					alert(validPin);
					resetWithholdeeInfoInShipping();
					return false;
				}
			}
			else{
				alert(errFetchingData);
				resetWithholdeeInfoInShipping();
				return false;
			}

		}});
		return true;
	}
	else{
		resetWithholdeeInfoInShipping();
		return false;
	}
}
function addShipingData(row)
{
	resetErrorList();
	if(validateFormFields(shippingJson))
	{
		hideTab('TabView',5);
		resetErrorList();
		incError=0;
		var checkDuplicateFlag = checkMonthYearInAddRowShipping(row,'shippingTaxTable'); 
		if(checkDuplicateFlag==false)
		{
			return false;
		}
		var checkDuplicateFlag = checkDuplicateShipping(row,'shippingTaxTable');
		if(checkDuplicateFlag==false)
		{
			return false;
		}
		if( removeCommaFrmInput(document.getElementById('in_shippingTaxTable_7').value)>0  &&  removeCommaFrmInput(document.getElementById('in_shippingTaxTable_8').value)>0 )
		{
			if(addConfirm('a_shippingTaxTable'))
			{
				if(document.getElementById('a_shippingTaxTable').innerHTML!="Modify")
				{
					if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
					{
						addrow('shippingTaxTable', '6', '19','4','validateDeleteRowShippingTable','validateModifyRowShippingTable','N','N','','3,7');
					}
					else
					{
						addrow('shippingTaxTable', '6', '19','4','validateDeleteRowShippingTable','validateModifyRowShippingTable','N','N','','3');
					}
				}
				else
				{
					return true;
				}
			}
			updateAddrCountdownShip();
			//	return true;
		}
		else
		{
			document.getElementById('in_shippingTaxTable_7').value=0;
			document.getElementById('in_shippingTaxTable_8').value=0;
			alert(payableValueGreaterThanZero);
			return false;
		}
	}
	else
	{
		getErrTabToggle('TabView','2');	
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}
}

function validateDeleteRowShippingTable(tab_str, rowno, cols) 
{
	if(deleteFlagShipping==1 && modifyFlagShipping==0)
	{
		var table = document.getElementById('shippingTaxTable');  
		var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
		var tempAmt = table.rows[rowno].cells[8].innerHTML;
		totalAmt = totalAmt - parseInt(removeCommaFrmInput(tempAmt),"10");
		amtOfInvoceShipping=removeCommaFrmInput(document.getElementById('txtTotalInvocieValue').value);
		amtOfInvoceShipping=amtOfInvoceShipping-parseInt(removeCommaFrmInput(table.rows[rowno].cells[7].innerHTML),"10");
		if(document.getElementById('hidIsPartial').value != "Y" && document.getElementById('hidIsPartial').value != "y" )
		{
			document.getElementById('txtTotalInvocieValue').value=convertToKenyanShillingFormatVal(amtOfInvoceShipping, true);
		}
		else{
			document.getElementById('txtTotalInvocieValue').value=0;
		}
		document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
		document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
		document.getElementById('txtTotalTaxValue').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true); 
		selectedFlagShipping=selectedFlagShipping-1;
		if(selectedFlagShipping==0)
		{
			clear_table_data('shippingTaxTable');
		}
		deleteFlagShipping = 0;
		if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
		{
			selectedFlagPartial=selectedFlagPartial-1;
		}
		currentPaymentShipping();
	}
	else
	{
		deleteFlagShipping = 0;
	}
}
function beforeModifyShippingTable(row) 
{
//	var checkDuplicateFlag = checkDuplicateShipping(row,'shippingTaxTable');
	if(addShipingData())
	{
		var checkDuplicateFlag = checkDuplicateShipping(row,'shippingTaxTable');
		if(checkDuplicateFlag==false)
		{
			return false;
		}
		else
		{
			var table = document.getElementById('shippingTaxTable');
			amtToPaidShipping=table.rows[rowno].cells[8].innerHTML;
			document.getElementById('hidTaxRateShipping').value=document.getElementById('in_shippingTaxTable_11').value;
			amtOfInvoceShipping=(removeCommaFrmInput(table.rows[rowno].cells[7].innerHTML));
		}
	}
	else
	{
		return false;
	}
}
function validateModifyRowShippingTable(tab_str, rowno, cols) 
{
	modifyFlagShipping = 1;
	commonModifyFlag=1;
	if(document.getElementById('in_shippingTaxTable_3').value!=""||document.getElementById('in_shippingTaxTable_3').value!==null)
	{
		document.getElementById('in_shippingTaxTable_4').readOnly=true;
		document.getElementById('in_shippingTaxTable_16').readOnly=true;
		document.getElementById('in_shippingTaxTable_15').readOnly=true;
		document.getElementById("in_shippingTaxTable_4").className='readonlyInput form101_textfcurr_width';
		document.getElementById("in_shippingTaxTable_16").className='readonlyInput form101_textfcurr_width';
		document.getElementById("in_shippingTaxTable_15").className='readonlyInput form101_textfcurr_width';
	}
	updateAddrCountdownShip();
}

function afterModifyShippingTable() 
{
	modifyFlagShipping = 0;
	commonModifyFlag=0;
	var table = document.getElementById('shippingTaxTable');
	//document.getElementById('in_shippingTaxTable_11').value=document.getElementById('hidTaxRateShipping').value;
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var modifyAmt;
	document.getElementById('in_shippingTaxTable_9').selectedIndex=0;
	if(document.all)
	{
		modifyAmt=(table.rows[rowno].cells[8].innerText);
	}
	else
	{
		modifyAmt=table.rows[rowno].cells[8].textContent;
	}
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(modifyAmt),"10")-parseInt(removeCommaFrmInput(amtToPaidShipping),10),true); 
	document.getElementById('txtTotalTaxValue').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true; 
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalInvocieValue').value);
	var modifyAmt1;
	if(document.all)
	{
		modifyAmt1=(table.rows[rowno].cells[7].innerText);
	}
	else
	{
		modifyAmt1=table.rows[rowno].cells[7].textContent;
	}
	document.getElementById('txtTotalInvocieValue').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(modifyAmt1),"10")-parseInt(removeCommaFrmInput(amtOfInvoceShipping),10),true); 
	document.getElementById('in_shippingTaxTable_4').readOnly=false;
	document.getElementById('in_shippingTaxTable_16').readOnly=false;
	document.getElementById('in_shippingTaxTable_15').readOnly=false;
	document.getElementById("in_shippingTaxTable_4").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById("in_shippingTaxTable_16").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById("in_shippingTaxTable_15").className='form101_textfcurr form101_textfcurr_width';
	document.getElementById('in_shippingTaxTable_12').value=0;
	document.getElementById('in_shippingTaxTable_13').value=0;
	document.getElementById('in_shippingTaxTable_7').value=0;
	document.getElementById('in_shippingTaxTable_8').value=0;
}
function afterDeleteShippingTable()
{
	deleteFlagShipping = 1;
}
function clearFormShipping()
{
	document.getElementById('hidTaxRateShipping').value=document.getElementById('in_shippingTaxTable_11').value;
	if(clear_table('shippingTaxTable','14'))
	{
		document.getElementById('in_shippingTaxTable_11').value=document.getElementById('hidTaxRateShipping').value;
		if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
		{
			document.getElementById('shippingRadio_'+rowNumbmerPartial).checked=false;
		}
		currentPaymentShipping();
	}

}

function showShippingPartialTable(partialDetailArray)
{
	if(partialDetailArray.length>=1){
		var cntr = 0;
		var tabObj = document.getElementById("in_TaxSplObligHdrTbl_1");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		for(var i=0;i<partialDetailArray.length;i++){
			cntr = parseInt(cntr);
			var tabRow = tabObj.insertRow(tabObj.rows.length);
			tabRow.id="shippingHdrRow_"+cntr;
			var tabCell = new Array();
			for (var j=0;j<18;j++){
				tabCell[j] = tabRow.insertCell(j);
			}
			var pmtSplDetailVO = partialDetailArray[i];
			/*if(document.all)
			{
				var element = document.createElement("<input type = 'radio' onclick = 'onSelectShippingHdrRadio(this);'>");
				element.setAttribute("name", "shippingRadio");
				element.setAttribute("id", "shippingRadio_"+cntr);
				element.setAttribute("value", cntr);					            
				tabCell[0].appendChild(element);

			}
			else{
				var element = document.createElement('input');       
				element.setAttribute('type', 'radio');     
				element.setAttribute('name', 'shippingRadio');
				element.setAttribute('id', 'shippingRadio_'+cntr);
				element.setAttribute('value', cntr);     
				element.setAttribute("onclick","javascript:onSelectShippingHdrRadio(this);");
				tabCell[0].appendChild(element);
			}*/
			var element = document.createElement('input');       
			element.type ='radio';
			element.onclick = function () {onSelectShippingHdrRadio(this);};
			element.value = cntr;
			element.id = 'shippingRadio_'+cntr;
			element.name = "shippingRadio";
			element.className='bordercl';
			tabCell[0].appendChild(element); 


			tabCell[1].innerHTML = pmtSplDetailVO.sailingDtShip;
			tabCell[1].style.textAlign="center";
			tabCell[1].style.fontSize="11";

			tabCell[2].innerHTML = pmtSplDetailVO.shippingLineShip;
			tabCell[2].style.textAlign="center";
			tabCell[2].style.fontSize="11";
			tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPrincipalAmount).toFixed(2),true);
			tabCell[3].style.textAlign="right";
			tabCell[3].style.fontSize="11";


			tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualFineAmount).toFixed(2),true);
			tabCell[4].style.textAlign="right";
			tabCell[4].style.fontSize="11";


			tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPenaltyAmount).toFixed(2),true);
			tabCell[5].style.textAlign="right";
			tabCell[5].style.fontSize="11";

			tabCell[6].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualInterestAmount).toFixed(2),true);
			tabCell[6].style.textAlign="right";
			tabCell[6].style.fontSize="11";

			tabCell[7].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			tabCell[7].style.textAlign="right";
			tabCell[7].style.fontSize="11";
			
			
			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.bclSplObilgationHdrId;
			element.width = "0%";
			tabCell[8].appendChild(element);
			tabCell[8].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.bclSplObilgationDtlId;
			element.width = "0%";
			tabCell[9].appendChild(element);
			tabCell[9].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.obilgationHdrId;
			element.width = "0%";
			tabCell[10].appendChild(element);
			tabCell[10].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.obilgationDtlId;
			element.width = "0%";
			tabCell[11].appendChild(element);
			tabCell[11].style.display = "none";


			var element = document.createElement('input'); //actualPrincipalAmount
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.actualPrincipalAmount;
			element.width = "0%";
			tabCell[12].appendChild(element);
			tabCell[12].style.display = "none";

			var element = document.createElement('input'); //actualFineAmount
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.actualFineAmount;
			element.width = "0%";
			tabCell[13].appendChild(element);
			tabCell[13].style.display = "none";

			var element = document.createElement('input'); //actualPenaltyAmount
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.actualPenaltyAmount;
			element.width = "0%";
			tabCell[14].appendChild(element);
			tabCell[14].style.display = "none";

			var element = document.createElement('input');  //actualInterestAmount
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.actualInterestAmount;
			element.width = "0%";
			tabCell[15].appendChild(element);
			tabCell[15].style.display = "none";

			var element = document.createElement('input'); // actualLiabilityAmount
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.actualLiabilityAmount;
			element.width = "0%";
			tabCell[16].appendChild(element);
			tabCell[16].style.display = "none";
			
			var element = document.createElement('input'); // actualLiabilityAmount
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.parentId;
			element.width = "0%";
			tabCell[17].appendChild(element);
			tabCell[17].style.display = "none";

			cntr = cntr+1;
		}
		document.getElementById("in_TaxSplObligHdrTbl_1").style.display = "";
		document.getElementById("navigationFieldset").style.display = "";
		document.getElementById("navigationTableTaxSpl").style.display = "";
		//	document.getElementById("navigationTable").style.display = "";
		document.getElementById('hidNavigationFlag').value = "6";
		validatePaginationLastTaxSpl();
		validatePaginationFirstTaxSpl();
	}
}

function onSelectShippingHdrRadio(obj)
{
	rowNumbmerPartial=obj.value;
	if(selectedFlagShipping>0 && document.getElementById('hidIsPartial').value != "Y")
	{
		alert(cntAddPrevLiab);
		document.getElementById('shippingRadio_'+rowNumbmerPartial).checked=false;
	}
	else
	{

		var taxPayerId=document.getElementById('hidTaxPayerId').value;
		var rowNum = obj.value;
		objValue=obj.value;
		//alert(rowNum);
		var rowRef = document.getElementById("shippingHdrRow_" + rowNum);
		bclPaymentHdrId = 0;// not of use
		bclPaymentDtlId = 0 ;// not of use


		var rowNum = obj.value;
		objValue=obj.value;
		var rowRef = document.getElementById("shippingHdrRow_" + rowNum);
		bclPaymentHdrId = 0;// not of use
		bclPaymentDtlId = 0 ;// not of use

		bclSplObligHdrId = 0;
		bclSplObliDtlId = 0;// not of use

		obligationHdrId = 0;// of no use
		obligationDtlId = 0;// used

		document.getElementById('hidIsPartial').value = "Y";

		var taxPayableValue;
		var amountPaid
		var amountToBePaid;
		startIndexStr=parseInt(document.getElementById('startIndexUpdate').value);
		if(document.all)
		{
			bclSplObligHdrId = (rowRef.getElementsByTagName("INPUT")[1].value);
			bclSplObliDtlId = (rowRef.getElementsByTagName("INPUT")[2].value);
			obligationHdrId = (rowRef.getElementsByTagName("INPUT")[3].value);
			obligationDtlId = (rowRef.getElementsByTagName("INPUT")[4].value);

			taxPayableValue	=rowRef.getElementsByTagName("TD")[3].innerText;
			amountPaid		=rowRef.getElementsByTagName("TD")[4].innerText;
			amountToBePaid	=rowRef.getElementsByTagName("TD")[5].innerText;

			actualPrincipalAmount = (rowRef.getElementsByTagName("INPUT")[5].value);
			actualFineAmount = (rowRef.getElementsByTagName("INPUT")[6].value);
			actualPenaltyAmount = (rowRef.getElementsByTagName("INPUT")[7].value);
			actualInterestAmount = (rowRef.getElementsByTagName("INPUT")[8].value);
			actualLiabilityAmount = (rowRef.getElementsByTagName("INPUT")[9].value);
			
			parentId = (rowRef.getElementsByTagName("INPUT")[10].value);

		}
		else
		{
			bclSplObligHdrId = (rowRef.getElementsByTagName("INPUT")[1].value);
			bclSplObliDtlId = (rowRef.getElementsByTagName("INPUT")[2].value);
			obligationHdrId = (rowRef.getElementsByTagName("INPUT")[3].value);
			obligationDtlId = (rowRef.getElementsByTagName("INPUT")[4].value);

			taxPayableValue	=rowRef.getElementsByTagName("TD")[3].textContent;
			amountPaid		=rowRef.getElementsByTagName("TD")[4].textContent;
			amountToBePaid	=rowRef.getElementsByTagName("TD")[5].textContent;
			
			actualPrincipalAmount = (rowRef.getElementsByTagName("INPUT")[5].value);
			actualFineAmount = (rowRef.getElementsByTagName("INPUT")[6].value);
			actualPenaltyAmount = (rowRef.getElementsByTagName("INPUT")[7].value);
			actualInterestAmount = (rowRef.getElementsByTagName("INPUT")[8].value);
			actualLiabilityAmount = (rowRef.getElementsByTagName("INPUT")[9].value);
			
			parentId = (rowRef.getElementsByTagName("INPUT")[10].value);


		}

		FetchSpecialObligationDtlWeb.fetchSpecialObligationDtlWeb(bclSplObliDtlId,shippingOblCode,taxPayerId,parentId,startIndexStr,{async:false,callback:function(data){
			if(data!=null){
				clear_Page_data('shippingTaxTable','14');
				document.getElementById('btnShippingDate').style.display="none";
				document.getElementById('shippingTaxRow5').style.display="none";
				document.getElementById('shippingTaxRow8').style.display="";
				document.getElementById('shippingTaxRow9').style.display="";
				document.getElementById('shippingTotalValueTh').style.display="none";
				document.getElementById('shippingTaxRow6').style.display="none";
				document.getElementById('tdTotalInvocieValue1').style.display="none";
				document.getElementById('tdTotalInvocieValue2').style.display="none";
				document.getElementById('tdTotalInvocieValue3').style.display="";
				document.getElementById('tdTotalInvocieValue4').style.display="";
				
				
				
				var pmtSplDetailVOList=data;
				if(pmtSplDetailVOList.length>=1 && pmtSplDetailVOList[0].isDataAvailable == "Y"){
					document.getElementById('bclSplObligationHdrId').value = bclSplObligHdrId;	
					var pmtSplDetailVO = pmtSplDetailVOList[0];
					for(var i=3; i<22;i++)
					{
						document.getElementById('in_shippingTaxTable_'+i).readOnly=true;
						if(document.getElementById('in_shippingTaxTable_'+i).className=='readonlyInput form101_textfcurr_width textonlyRight' || document.getElementById('in_shippingTaxTable_'+i).className=='form101_textfcurr form101_textfcurr_width textonlyRight')
						{
							document.getElementById('in_shippingTaxTable_'+i).className='readonlyInput form101_textfcurr_width textonlyRight';
						}
						else
						{
							document.getElementById('in_shippingTaxTable_'+i).className='readonlyInput form101_textfcurr_width';
						}
						document.getElementById('in_shippingTaxTable_9').disabled=true; 
					}
					if(pmtSplDetailVO.withholPINShip != null &&pmtSplDetailVO.withholPINShip != "" && pmtSplDetailVO.withholPINShip != 'null' && pmtSplDetailVO.withholPINShip != "null"){
						document.getElementById('in_shippingTaxTable_3').value = pmtSplDetailVO.withholPINShip;
					}
					if(pmtSplDetailVO.withholNameShip != null &&pmtSplDetailVO.withholNameShip != "" && pmtSplDetailVO.withholNameShip != 'null' && pmtSplDetailVO.withholNameShip != "null"){
						document.getElementById('in_shippingTaxTable_4').value = pmtSplDetailVO.withholNameShip;
					}
					if(pmtSplDetailVO.withholAddressShip != null &&pmtSplDetailVO.withholAddressShip != "" && pmtSplDetailVO.withholAddressShip != 'null' && pmtSplDetailVO.withholAddressShip != "null"){
						document.getElementById('in_shippingTaxTable_15').value = pmtSplDetailVO.withholAddressShip;
					}
					if(pmtSplDetailVO.withholTelNoShip != null &&pmtSplDetailVO.withholTelNoShip != "" && pmtSplDetailVO.withholTelNoShip != 'null' && pmtSplDetailVO.withholTelNoShip != "null"){
						document.getElementById('in_shippingTaxTable_16').value = pmtSplDetailVO.withholTelNoShip;
					}
					if(pmtSplDetailVO.countryOfRegionShip != null &&pmtSplDetailVO.countryOfRegionShip != "" && pmtSplDetailVO.countryOfRegionShip != 'null' && pmtSplDetailVO.countryOfRegionShip != "null"){
						document.getElementById('in_shippingTaxTable_9').value = pmtSplDetailVO.countryOfRegionShip;
					}
					if(pmtSplDetailVO.vesselShip != null &&pmtSplDetailVO.vesselShip != "" && pmtSplDetailVO.vesselShip != 'null' && pmtSplDetailVO.vesselShip != "null"){
						document.getElementById('in_shippingTaxTable_5').value = pmtSplDetailVO.vesselShip;
					}
					if(pmtSplDetailVO.sailingDtShip != null &&pmtSplDetailVO.sailingDtShip != "" && pmtSplDetailVO.sailingDtShip != 'null' && pmtSplDetailVO.sailingDtShip != "null"){
						document.getElementById('in_shippingTaxTable_6').value = pmtSplDetailVO.sailingDtShip;
					}
					if(pmtSplDetailVO.shippingLineShip != null &&pmtSplDetailVO.shippingLineShip != "" && pmtSplDetailVO.shippingLineShip != 'null' && pmtSplDetailVO.shippingLineShip != "null"){
						document.getElementById('in_shippingTaxTable_10').value = pmtSplDetailVO.shippingLineShip;
					}
					if(pmtSplDetailVO.taxRateShip != null &&pmtSplDetailVO.taxRateShip != "" && pmtSplDetailVO.taxRateShip != 'null' && pmtSplDetailVO.taxRateShip != "null"){
						document.getElementById('in_shippingTaxTable_11').value = convertToKenyanShillingFormatValWithDecimal(parseFloat( pmtSplDetailVO.taxRateShip,10).toFixed(2),true);
					}
					if(pmtSplDetailVO.grosOutFrtShip != null &&pmtSplDetailVO.grosOutFrtShip != "" && pmtSplDetailVO.grosOutFrtShip != 'null' && pmtSplDetailVO.grosOutFrtShip != "null"){
						document.getElementById('in_shippingTaxTable_12').value = convertToKenyanShillingFormatVal(Math.ceil(pmtSplDetailVO.grosOutFrtShip),true);
					}
					if(pmtSplDetailVO.outPasFaresShip != null &&pmtSplDetailVO.outPasFaresShip != "" && pmtSplDetailVO.outPasFaresShip != 'null' && pmtSplDetailVO.outPasFaresShip != "null"){
						document.getElementById('in_shippingTaxTable_13').value = convertToKenyanShillingFormatVal(Math.ceil(pmtSplDetailVO.outPasFaresShip),true);
					}
					if(pmtSplDetailVO.totalValueShip != null &&pmtSplDetailVO.totalValueShip != "" && pmtSplDetailVO.totalValueShip != 'null' && pmtSplDetailVO.totalValueShip != "null"){
						document.getElementById('in_shippingTaxTable_7').value = convertToKenyanShillingFormatVal(Math.ceil(pmtSplDetailVO.totalValueShip),true);
					}
					
					document.getElementById('in_shippingTaxTable_8').value =convertToKenyanShillingFormatVal(Math.ceil(actualLiabilityAmount),true); ;
					document.getElementById('in_shippingTaxTable_18').value=	convertToKenyanShillingFormatVal(Math.ceil(actualPrincipalAmount),true);
					document.getElementById('in_shippingTaxTable_19').value=	convertToKenyanShillingFormatVal(Math.ceil(actualFineAmount),true);
					document.getElementById('in_shippingTaxTable_20').value=convertToKenyanShillingFormatVal(Math.ceil(actualPenaltyAmount),true);
					document.getElementById('in_shippingTaxTable_21').value=convertToKenyanShillingFormatVal(Math.ceil(actualInterestAmount),true) ;

					if(pmtSplDetailVO.withholIdShip != null &&pmtSplDetailVO.withholIdShip != "" && pmtSplDetailVO.withholIdShip != 'null' && pmtSplDetailVO.withholIdShip != "null"){
						document.getElementById('in_shippingTaxTable_14').value = pmtSplDetailVO.withholIdShip;
					}
					document.getElementById('in_shippingTaxTable_17').value = bclSplObliDtlId;
				}

			}
			else{
			}

		}});	
	}
}

function validateShippingDtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, shippingJson);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}

function updateAddrCountdownShip()
{
	limitText(document.getElementById('in_shippingTaxTable_15'),document.getElementById('withholAddressShipCountdown'),200);
}
function currentPaymentShipping()
{
	if((document.getElementById('hidIsPartial').value != "Y" || document.getElementById('hidIsPartial').value != "y" )&&(selectedFlagPartial==0))
	{
		for(var i=3; i<18;i++)
		{
			document.getElementById('in_shippingTaxTable_'+i).readOnly=false;
			if(document.getElementById('in_shippingTaxTable_'+i).className=='readonlyInput form101_textfcurr_width textonlyRight' || document.getElementById('in_shippingTaxTable_'+i).className=='form101_textfcurr form101_textfcurr_width textonlyRight')
			{
				document.getElementById('in_shippingTaxTable_'+i).className='form101_textfcurr form101_textfcurr_width textonlyRight';
			}
			else 
			{
				document.getElementById('in_shippingTaxTable_'+i).className='form101_textfcurr form101_textfcurr_width';
			}
		}
		document.getElementById('hidIsPartial').value = "N";
		document.getElementById('btnShippingDate').style.display="";
		
		document.getElementById('shippingTaxRow5').style.display="";
		document.getElementById('shippingTaxRow8').style.display="none";
		document.getElementById('shippingTaxRow9').style.display="none";
		document.getElementById('shippingTotalValueTh').style.display="";
		document.getElementById('shippingTaxRow6').style.display="";
		document.getElementById('tdTotalInvocieValue1').style.display="";
		document.getElementById('tdTotalInvocieValue2').style.display="";
		document.getElementById('tdTotalInvocieValue3').style.display="none";
		document.getElementById('tdTotalInvocieValue4').style.display="none";
		
		document.getElementById('in_shippingTaxTable_7').readOnly=true;
		document.getElementById('in_shippingTaxTable_7').className='readonlyInput form101_textfcurr_width textonlyRight';
		document.getElementById('in_shippingTaxTable_8').readOnly=true;
		document.getElementById('in_shippingTaxTable_8').className='readonlyInput form101_textfcurr_width textonlyRight';
		document.getElementById('in_shippingTaxTable_11').readOnly=true;
		document.getElementById('in_shippingTaxTable_11').className='readonlyInput form101_textfcurr_width';
		modifyFlagShipping=0;
		commonModifyFlag=0;
	//	document.getElementById('hidTaxRateShipping').value=document.getElementById('in_shippingTaxTable_11').value;
		clear_Page_data('shippingTaxTable','14');
		document.getElementById('in_shippingTaxTable_9').selectedIndex=0;
		document.getElementById('in_shippingTaxTable_11').value=0.00;
		document.getElementById('in_shippingTaxTable_9').disabled=false;
	}
}

function confirmForPartialShipping()
{
	if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
	{
		if(selectedFlagPartial==0)
		{
			if (confirm(previousLiabilityAddingAlert))
			{
				return addShipingData();
			}
		}
		else
		{
			return addShipingData();
		}
	}
	else
	{
		return addShipingData();
	}
}

function beforeDeleteShipping()
{
	if(modifyFlagShipping==1)
	{
		alert(confirmModifyingOperation);
		return false;
	}
}
function checkDuplicateShipping(r,id)
{
	rows=r;
	{

		//	document.getElementById(id).value;
		var transactionDate=document.getElementById('in_shippingTaxTable_6').value;
		var name=document.getElementById('in_shippingTaxTable_4').value;
		var vessel = document.getElementById('in_shippingTaxTable_5').value;
		var tabObj1 = document.getElementById(id);
		if(tabObj1.rows.length==1)
		{
		}
		else
		{ 	
			for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
			{ 
				var modify;
				if(document.all)
				{
					modify=trim(tabObj1.rows[i].cells[2].innerText);
				}
				else
				{
					modify=trim(tabObj1.rows[i].cells[2].textContent,"");
				}
				if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify")  &&  (tabObj1.rows[i].cells[6].innerHTML==transactionDate)&&  (tabObj1.rows[i].cells[4].innerHTML==name)&&  (tabObj1.rows[i].cells[5].innerHTML==vessel))
				{
					alert(detailsExists);
					return false;
				}
			}
		}

		return true;
	}

}
function isShippingRegistered(){
	var taxpayerId = document.getElementById('hidTaxPayerId').value;
	var obligationId = shippingOblCode;
	//var obligationId = document.getElementById('hidTaxPayerId').value;

	var vesselShip = document.getElementById('in_shippingTaxTable_5').value;
	var withholNameShip = document.getElementById('in_shippingTaxTable_4').value;
	var sailingDtShip = document.getElementById('in_shippingTaxTable_6').value;
	var withholTelNoShip = document.getElementById('in_shippingTaxTable_16').value;

	var PmtSplDetailVO = {
			taxpayerId  : taxpayerId,
			obligationId : obligationId,

			vesselShip : vesselShip,
			withholNameShip  : withholNameShip,
			sailingDtShip : sailingDtShip,
			withholTelNoShip : withholTelNoShip

	};

	if(isSplObligationRegisteredWeb(PmtSplDetailVO))
		return true;
	else
		return false;

}
function getTaxRate()
{
	var obligationId=shippingOblCode;
	if(document.getElementById('in_shippingTaxTable_9').selectedIndex!=0 && document.getElementById('in_shippingTaxTable_6').value!="")
	{	
		var countryCode=document.getElementById('in_shippingTaxTable_9').value;
		fetchTaxRateValueFromCategoryWeb(obligationId,null,null,countryCode);	
		calcOnShippingInvoice();
	}
}
function checkMonthYearInAddRowShipping(r,id)
{
	rows=r;
	{

		document.getElementById(id).value;
		var transactionDate=document.getElementById('in_'+id+'_6').value.substr(2, document.getElementById('in_'+id+'_6').value.length);
		var tabObj1 = document.getElementById(id);
		if(tabObj1.rows.length==1)
		{
		}
		else
		{ 	
			for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
			{ 
				if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" &&  (tabObj1.rows[i].cells[6].innerHTML.substr(2, tabObj1.rows[i].cells[6].innerHTML.length)!=transactionDate))
				{
					alert(cntGenPaymentslip);
					return false;
				}
			}
		}

		return true;
	}

}