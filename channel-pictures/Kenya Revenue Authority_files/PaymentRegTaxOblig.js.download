function savePaymentDetailOblig()
{
	{
		//if(document.getElementById('cmbPaymentType').value==SAT || document.getElementById('cmbPaymentType').value==VTDP)
		if(document.getElementById('cmbPaymentType').value==SAT || document.getElementById('cmbPaymentType').value==VTDP 
				|| document.getElementById('cmbPaymentType').value==LEGDBT)
		{
			if(document.getElementById('cmbTaxSubHead').value==VisOblCode||document.getElementById('cmbTaxSubHead').value==WithHoldee || document.getElementById('cmbTaxSubHead').value==TransmissionOblCode || document.getElementById('cmbTaxSubHead').value==shippingOblCode)
			{

				if (document.getElementById('cmbTaxSubHead').value==WithHoldee && document.getElementById('splPmtType').value=='e'){
					
					if(document.getElementById('isAmendment').value=='Y')
					{
					var  tableObj =document.getElementById('ITWithPreviousDetailsTable');
					document.getElementById('prnString').value='';
					var prnstring ='';
					var prn = null; 
					if(tableObj.rows.length > 1){
						for(var i = 1, n = tableObj.rows.length; i <n; i++) 
						{
							if(document.getElementById('itWithHoldeeHdrCheckbox_'+(i-1)).checked){
								if (document.all) {// for IE
									prn = tableObj.rows[i].cells[1].innerText;
								}
								else{
									var innrhtmltext = tableObj.rows[i].cells[1].textContent;
									prn = innrhtmltext; 
								}
								
								prnstring =prnstring.concat(prn+',');
							}

						}
						if(prnstring.length==0){
							alert("Please select Prn for amendedment");
							return false;
						}else{
							document.getElementById('prnString').value=prnstring;
						}
					}
				}		
					
						if(validateFile())
					{
						if(saveConfirm())
						{
							paymentRegFormSubmitForm("savePaymentExcelDetail");

						}
					}

				}
				else{

					if(validateFormFields(paymentRegTaxObligPaymentDetailsJson))
					{
						hideTab('TabView',5);
						resetErrorList();
						incError=0;
						if(document.getElementById('cmbTaxSubHead').value==WithHoldee && document.getElementById('cmbPaymentType').value!=VTDP)
						{
							if(document.getElementById('specOblPmtTypeRadio1').checked == false && document.getElementById('specOblPmtTypeRadio2').checked == false)
							{
								alert('Please select atleast one operation for withholding payment.');
								return false;
							}
						}
						if(document.getElementById('checkDisclaimer').checked==true /*&& document.getElementById('cmbPaymentType').value !=VTDP*/)
						{
							if(modifyFlagWithHoldee==1||modifyFlagShipping==1||modifyFlagCable==1||modifyFlagVis==1 ||modifyFlagAGENCY==1 || modifyFlagAUCTION==1)
							{
								alert(firstModify);
								return false;
							}
							else
							{
								if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
								{
									if(saveConfirm())
									{	var table = document.getElementById('withholdeeWebFormTable');  
										document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
										var rows = document.getElementById('withholdeeWebFormTable').rows.length;
										var flag=false;
										for(var i=0; i<rows;i++)
										{
											
											if (null!=document.getElementById('id_'+'withholdeeWebFormTable'+'_'+i+'_1') && ""!=document.getElementById('id_'+'withholdeeWebFormTable'+'_'+i+'_1'))
											 {
												modify=document.getElementById('id_'+'withholdeeWebFormTable'+'_'+i+'_2').innerHTML;
												del=document.getElementById('id_'+'withholdeeWebFormTable'+'_'+i+'_1').innerHTML;
											if((trim(document.getElementById('id_'+'withholdeeWebFormTable'+'_'+i+'_1').innerHTML))=="Delete" && (modify=="Modify"))
											{
												flag=true;
												break;
											}
											 }
											
											
											/*if(document.getElementById('withHoldeeWebFormRadio_'+i).checked==true)
											{
												flag=true;
											}*/
										}
										if(flag==true)
										{
											document.getElementById('isPrevLiabilityChosenForITWht').value='Y';
										}
										else
										{
											document.getElementById('isPrevLiabilityChosenForITWht').value='N';
										}
										paymentRegFormSubmitForm("saveObligationDetail");
										
									}
								}
								else
								{
									alert(totalAmtGreaterThenZero);
									return false;
								}
							}
						}

						else
						{
							if(document.getElementById('cmbPaymentType').value !=VTDP){
								alert(checkDisclaimer);
								return false;
							}
							if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
							{
								if(saveConfirm())
								{
									document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
									paymentRegFormSubmitForm("saveObligationDetail");
								}
							}
							else{
								alert(atleastOneObligation);
								return false;
							}
							
						}
					}
					else
					{
						errorPage();
						
					}
				}
			}
			else
			{	
				if(modifyFlagTaxOblig == 1)
				{
					alert(firstModify);
					return false;
				}
				else
				{
					if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
					{
						if(isWithoutLogin == "Y" || isWithoutLogin =="y"){

							if(document.getElementById('cmbTaxSubHead').value==exciseTaxOblCode)
							{
								if(document.getElementById("taxPayerRegWith").value==goods || document.getElementById("taxPayerRegWith").value==services )
								{
									if(saveConfirm())
									{
										document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
										paymentRegFormSubmitForm("saveObligationDetail");
																			
									}
								}
								else
								{
									alert(paymentAlert);	
									return false;
								}
							}
							else
							{
								if(saveConfirm())
								{
									document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
									paymentRegFormSubmitForm("saveObligationDetail");
									
								}
							}
						}
						else
						{
							if(saveConfirm())
							{
								document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
								paymentRegFormSubmitForm("saveObligationDetail");
								
							}
						}
					}
					else
					{
						alert(atleastOneObligation);
						return false;
					}
				}
			}
		}
	}
}
function validateFileForVATWithholding()
{
	var file=document.getElementById("fileVATWith");
	var returnValue = true;

	if(file){
		fileName= file.value;

		if(fileName=="")
		{	
			alert('Please upload file.');
			file.value='';
			file.focus();
			return false;
		}else{
			var index = fileName.lastIndexOf(".");
			var length = fileName.length;
			var ext = fileName.substring(index+1).toLowerCase();
			if(fileName!='')
			{
				if (!(ext == 'xls'|| ext == 'zip' ))
				{
					alert("Please upload xls or zip file.");
					file.value='';
					file.focus();
					return false;
				}else{
					return true;
				}
			}
		}
	}
	else{
		alert('Please upload file.');
		return false;
	}
}

function validateFile(){
	var file=document.getElementById("file");
	var returnValue = true;

	if(file){
		fileName= file.value;

		if(fileName=="")
		{	
			alert('Please upload file.');
			file.value='';
			file.focus();
			return false;
		}else{
			var index = fileName.lastIndexOf(".");
			var length = fileName.length;
			var ext = fileName.substring(index+1).toLowerCase();
			if(fileName!='')
			{
				if (!(ext == 'xls'|| ext == 'zip' ))
				{
					alert("Please upload xls or zip file.");
					file.value='';
					file.focus();
					return false;
				}else{
					return true;
				}
			}
		}
	}
	else{
		alert('Please upload file.');
		return false;
	}
}

function saveTipDetails()
{
	if(document.getElementById('cmbPaymentType').value==TIP)
	{
		
		if(modifyFlagInstallment == 1)
		{
			alert(firstModify);
			return false;
		}
		else{
			if(selectedFlagInstallment>0)
			{

				if(validateFormFields(paymentRegTaxObligPaymentDetailsJson))
				{
					hideTab('TabView',5);
					resetErrorList();
					incError=0;
					if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
					{
						if(saveConfirm())
						{
							document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
							paymentRegFormSubmitForm("saveObligationDetail");
							
						}
					}
					else
					{
						alert(totalAmtGreaterThenZero);
						return false;
					}
				}
				else
				{
					errorPage();
				}
			}
			else
			{
				alert(oneInstallmentPayment);
				return false;
			}
		}
	}
}
//start add for Minimum tax sam & chang 02/02/2021
function saveTmtDetails()
{
	if(document.getElementById('cmbPaymentType').value==TMT)
	{
		
		if(modifyFlagInstallment == 1)
		{
			alert(firstModify);
			return false;
		}
		else{
			if(selectedFlagMinimum>0)
			{

				if(validateFormFields(paymentRegTaxObligPaymentDetailsJson))
				{
					hideTab('TabView',5);
					resetErrorList();
					incError=0;
					if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
					{
						if(saveConfirm())
						{
							//TODO add logger to check period
							
							document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
							paymentRegFormSubmitForm("saveObligationDetail");
							
						}
					}
					else
					{
						alert(totalAmtGreaterThenZero);
						return false;
					}
				}
				else
				{
					errorPage();
				}
			}
			else
			{
				alert(oneInstallmentPayment);
				return false;
			}
		}
	}
}
// end add for Minimum tax sam & chang 02/02/2021
function saveTapDetails()
{
	if(document.getElementById('cmbPaymentType').value==TAP)
	{
		if(modifyFlagAdvance == 1)
		{
			alert(firstModify);
			return false;
		}
		else{
			if(selectedFlagAdvanceTax>0)
			{
				if(validateFormFields(paymentRegTaxObligPaymentDetailsJson))
				{
					hideTab('TabView',5);
					resetErrorList();
					incError=0;
					if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
					{		
						if (document.getElementById('cmbTaxSubHead').value==exciseTaxOblCode)
						{
							if(document.getElementById("taxPayerRegWith").value==goods || document.getElementById("taxPayerRegWith").value==services )
							{
								if(saveConfirm())
								{
									document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
									paymentRegFormSubmitForm("saveObligationDetail");
									
								}
							}
							else
							{
								alert(advancePaymentAlert);	
							}
						}
						else
						{
							if(saveConfirm())
							{
								document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
								paymentRegFormSubmitForm("saveObligationDetail");								
							}
						}
					}
					else
					{
						alert(totalAmtGreaterThenZero);
						return false;
					}
				}
				else
				{
					errorPage();
				}
			}
			else
			{
				alert(atleastOneAdvPayDetail);
				return false;
			}
		}
	}
}
function saveAgencyDetails()
{
	if (document.getElementById('cmbTaxHead').value==AGENCY_NOTICE)
	{
		if(validateFormFields(paymentRegTaxHeadJson,paymentRegPmtTtypeJson,agencyJson,paymentRegTaxObligPaymentDetailsJson ))
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
			{
				if(saveConfirm())
				{
					document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
					paymentRegFormSubmitForm("saveObligationDetail");
					
				}
			}
			else
			{
				alert(totalAmtGreaterThenZero);
				return false;
			}
		}
		else
		{
			errorPage();
		}
	}
}
function saveAuctionDetails(){

	if (document.getElementById('cmbTaxHead').value==AUCTION_NOTICE){

		if(validateFormFields(paymentRegTaxHeadJson,paymentRegPmtTtypeJson,auctionJson,paymentRegTaxObligPaymentDetailsJson )){

			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0){

				if(saveConfirm()){

					document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
					paymentRegFormSubmitForm("saveObligationDetail");
				}
			}
			else{
				alert(totalAmtGreaterThenZero);
				return false;
			}
		}
		else{
			errorPage();
			}
	}
}

function setOtrParamForCSV(){
	var curdate = new Date();
	var curmonth = parseInt(curdate.getMonth() + 1);
	var curyear = parseInt(curdate.getFullYear());
	var curday = parseInt(curdate.getDate());
	var todayDate = curday + "/" + curmonth + "/" + curyear;
	document.getElementById('hidObligationFromDate').value = todayDate;
	document.getElementById('hidObligationToDate').value = todayDate;		
	document.getElementById('hidObligationType').value = Obligation_Type_Tax;


}
function onChangeCmbTaxType(obj)
{
	/*if(document.getElementById('cmbPaymentType').value == VTDP)
	{
		document.getElementById('paymentTaxObligForm').style.display='';
		fetchTotalLiabilityDetailsWeb(true);
		document.getElementById('totalAmountPaidFieldSet').style.display='';
		document.getElementById('hidObligationId').value=document.getElementById('cmbTaxSubHead').value;
		document.getElementById("CmbTaxPeriodLabelTd").style.display='';
		document.getElementById("CmbTaxPeriodTd").style.display="none";
		document.getElementById("cmbTaxPeriodYear").style.display='';
		document.getElementById("cmbTaxPeriodMonth").style.display='';
		document.getElementById("paymentRegVISFieldSet").style.display='none';
		document.getElementById("paymentSpecVatWithRadio").style.display='none';
	}*/
    if(obj.value == selectOblCode || obj.value == "")
	{
		alert(validObligation);
		
		document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
		return false;
	}
	else
	{
		document.getElementById('hidObligationId').value = obj.value;
	}
	document.getElementById('disclaimerFieldSet').style.display='none';

	if(document.getElementById('cmbPaymentType').value!=agencyValue && document.getElementById('cmbPaymentType').value != VTDP)
	{ 
		var obligationId=obj.value;
		taxSubHeadValueForPrevRecord=obj.value;
		if(document.getElementById('cmbPaymentType').value ==TIP)
		{
			if(obligationId >5) 
			{
				document.getElementById('cmbTaxSubHead').selectedIndex=0;
				document.getElementById('cmbTaxPeriod').options.length = 1;
				alert(validYearlyObligation);
				return false;
			}
		}
		if(document.getElementById('cmbPaymentType').value ==TAP)
		{
			if(obligationId ==WithHoldee ||obligationId ==shippingOblCode||obligationId ==TransmissionOblCode||obligationId ==VisOblCode) 
			{
				document.getElementById('cmbTaxSubHead').selectedIndex=0;
				document.getElementById('cmbTaxPeriod').options.length = 1;
				alert(validObligationForAdv);
				return false;
			}
		}
		if(selectedFlagTaxOblig>0 &&(obligationId==WithHoldee||obligationId==shippingOblCode||obligationId==TransmissionOblCode||obligationId==VisOblCode||obligationId==selectOblCode || obligationId==advanceObligationId ||obligationId==exciseObligationId||obligationId==NSSF))
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			if(flagForCGT>0 || flagForMRI>0 || flagForAmnesty>0)
			{
				flagForCGT=0;
				flagForMRI=0;
				flagForAmnesty=0;
			}
			return false;
		}
		else if(selectedFlagShipping>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		else if(selectedFlagNSSF>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		//changes done for PR
		else if(flagForCGT>0)
		{
			
				alert(cntMergeObligationPay);
				//document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
				flagForCGT=0;
				return false;
		
		}
		//end
		//changes done for CR Monthly Rental Income
		else if(flagForMRI>0)
		{
			
				alert(cntMergeObligationPay);
				//document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
				flagForMRI=0;
				return false;
	
		}
		//end
		//changes done for CR Amnesty
		else if(flagForAmnesty>0)
		{
			
				alert(cntMergeObligationPay);
				flagForAmnesty=0;
				return false;
	
		}
		//end
		else if(selectedFlagCable>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		else if(selectedFlagVis>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		else if(selectedFlagWithHoldee>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		//changes done for CR Rent Income Withholding
		else if(selectedFlagRentIncomeWithHoldee>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		//end
		else if(selectedFlagAdvance>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		else if(selectedExciseFlag>0)
		{
			alert(cntMergeObligationPay);
			document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
			return false;
		}
		else
		{
			clearSpecObligationData();
		}
		if(obligationId==WithHoldee)
		{
			document.getElementById("paymentSpecOblRadioForm").style.display="";
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			
			/*document.getElementById('paymentRegWithholdeeSet').style.display = '';*/
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			/*document.getElementById('disclaimerFieldSet').style.display='';*/
			document.getElementById('disclaimerFieldSet').style.display='none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById("tblPenaltyList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			rowNumbmerPartial=0;
			selectedFlagPartial=0;
			setOtrParamForCSV();
			clearNevigationData();
//			if(document.getElementById('isWithoutLogin').value == "N")
//				fetchSplOblHdrWebByObligation("N");

		}
		//changes done for CR Rent Income Withholding
		else if(obligationId==rentIncomeWith)
		{
			document.getElementById("paymentSpecOblRadioForm").style.display="none";
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById('paymentRentIncomeWithRadioForm').style.display = '';
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			/*document.getElementById('disclaimerFieldSet').style.display='';*/
			document.getElementById('disclaimerFieldSet').style.display='none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById("tblPenaltyList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			rowNumbmerPartial=0;
			selectedFlagPartial=0;
			setOtrParamForCSV();
			clearNevigationData();
//			if(document.getElementById('isWithoutLogin').value == "N")
//				fetchSplOblHdrWebByObligation("N");

		}
		//end
		else if (obligationId==VatWithholding && obj.value != VTDP)
		{
			document.getElementById("paymentSpecVatWithRadio").style.display="";
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById("paymentSpecOblRadioForm").style.display='none';
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			document.getElementById('disclaimerFieldSet').style.display='none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById("tblPenaltyList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			rowNumbmerPartial=0;
			selectedFlagPartial=0;
			setOtrParamForCSV();
			clearNevigationData();
		}
		else if(obligationId==shippingOblCode)
		{
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = '';
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';
			document.getElementById('TotalTaxFieldSet').style.display = '';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			document.getElementById("txtTotalTaxValue").value=0;
			document.getElementById("txtTotalInvocieValue").value=0;
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			document.getElementById('disclaimerFieldSet').style.display='';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById("tblPenaltyList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			rowNumbmerPartial=0;
			selectedFlagPartial=0;
			setOtrParamForCSV();
			clearNevigationData();
			if(document.getElementById('isWithoutLogin').value == "N")
				fetchSplOblHdrWebByObligation("N");

		}
		else  if(obligationId==TransmissionOblCode)
		{
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';
			//END
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = '';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('TotalTaxFieldSet').style.display = '';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			document.getElementById("txtTotalTaxValue").value=0;
			document.getElementById("txtTotalInvocieValue").value=0;
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			document.getElementById('disclaimerFieldSet').style.display='';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			document.getElementById("tblPenaltyList").style.display="none";
			setOtrParamForCSV();
			selectedFlagPartial=0;
			rowNumbmerPartial=0;
			clearNevigationData();
			if(document.getElementById('isWithoutLogin').value == "N")
				fetchSplOblHdrWebByObligation("N");


		}
		
		else  if(obligationId==44)
		{
			GetYearFromEffetciveYear('cmbTaxPeriodYear');
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			//unCommented for Ticket 79025
			document.getElementById('paymentRegDTSTaxFieldSet').style.display = '';
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';
			
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			document.getElementById("txtTotalTaxValue").value=0;
			document.getElementById("txtTotalInvocieValue").value=0;
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			document.getElementById('disclaimerFieldSet').style.display='none';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			document.getElementById("tblPenaltyList").style.display="none";
			setOtrParamForCSV();
			selectedFlagPartial=0;
			rowNumbmerPartial=0;
			clearNevigationData();
			//Commented for Ticket 79025
			/*if(document.getElementById('isWithoutLogin').value == "N")
				fetchSplOblHdrWebByObligation("N");
			*/


		}
		
		//START:::::Added for DAT - 11/2023
		else  if(obligationId==45)
		{
			GetYearFromEffetciveYear('cmbTaxPeriodYear');
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';

			//document.getElementById('paymentRegDTSTaxFieldSet').style.display = '';
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			document.getElementById("txtTotalTaxValue").value=0;
			document.getElementById("txtTotalInvocieValue").value=0;
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			document.getElementById('disclaimerFieldSet').style.display='none';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			document.getElementById("tblPenaltyList").style.display="none";
			setOtrParamForCSV();
			selectedFlagPartial=0;
			rowNumbmerPartial=0;
			clearNevigationData();
			//Commented for Ticket 77089
			/*if(document.getElementById('isWithoutLogin').value == "N")
				fetchSplOblHdrWebByObligation("N");*/
		
			
		}
		//END:::::Added for DAT - 11/2023
		
		//START:::::Added for DST -#81171 
		else  if(obligationId==47)
		{
			GetYearFromEffetciveYear('cmbTaxPeriodYear');
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display = 'none';
			
			document.getElementById('paymentRegSEPTaxFieldSet').style.display = '';
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;  
			document.getElementById("txtTotalTaxValue").value=0;
			document.getElementById("txtTotalInvocieValue").value=0;
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			document.getElementById('disclaimerFieldSet').style.display='none';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			document.getElementById("tblPenaltyList").style.display="none";
			setOtrParamForCSV();
			selectedFlagPartial=0;
			rowNumbmerPartial=0;
			clearNevigationData();
			//Commented for Ticket 79025
			/*if(document.getElementById('isWithoutLogin').value == "N")
				fetchSplOblHdrWebByObligation("N");
			*/


		}
		//START:::::Added for DST -#81171 

		
		else  if(obligationId==VisOblCode)
		{
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegVISFieldSet').style.display = '';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			//END
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('TotalTaxFieldSet').style.display = '';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").value=0;
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById("txtTotalTaxValue").value=0;
			document.getElementById("txtTotalInvocieValue").value=0;
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('ObligationDetailFieldSet').style.display = 'none';
			document.getElementById('disclaimerFieldSet').style.display='';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById("tblFineList").style.display="none";
			document.getElementById("tblIntrestList").style.display="none";
			document.getElementById("tblPaymentList").style.display="none";
			document.getElementById("tblPenaltyList").style.display="none";
			document.getElementById('btnTbl').style.display="";
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="";
			//END
			rowNumbmerPartial=0;
			selectedFlagPartial=0;
			setOtrParamForCSV();
			clearNevigationData();
			if(document.getElementById('isWithoutLogin').value == "N")
				fetchSplOblHdrWebByObligation("N");

		}
		else  if(obligationId==PT)
		{
		
			document.getElementById('ptRadioBtnForm').style.display="";
			document.getElementById('amountToBePaidTr').style.display='none';
			
		

		}
		else
		{
			document.getElementById("paymentSpecVatWithRadio").style.display='none';
			document.getElementById("paymentVATWithExcelUploadForm").style.display='none';
			document.getElementById("paymentVATWitholdingWebForm").style.display='none';
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('navigationFieldset').style.display = 'none';
			document.getElementById("navigationTable").style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
			document.getElementById("txtTotalTaxValue").value=0;
			document.getElementById("txtTotalInvocieValue").value=0;
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
			document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('hidRadioValue').value='';
			taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
			document.getElementById('startIndex').value='0';
			var paymentType=document.getElementById('cmbPaymentType').value;  
			document.getElementById('navigationTableTaxSpl').style.display = 'none'; 
			clearPartialTableForTax();
			document.getElementById('navigationLegend').innerHTML = LibalityDetails ;
			document.getElementById('cmbTaxPeriod').disabled=false; 
			document.getElementById('btnTbl').style.display="";
			if(document.getElementById('cmbTaxSubHead').value!="32") {
			if(document.getElementById('cmbPaymentType').value !=TAP)
			{
				fetchTaxPeriod();

			}
			}
			//Added by Mingu for Legacy Debt Payment :: START
			if(document.getElementById('cmbPaymentType').value==LEGDBT){
				document.getElementById('navigationFieldset').style.display = '';
				document.getElementById("navigationTable").style.display = '';
				document.getElementById('LiablibilityTbl').style.display = '';
			}
			//Added by Mingu for Legacy Debt Payment :: END
		}
	}
	else
	{
		document.getElementById('txtTotalAmountPaidOblig').readOnly=false;
		document.getElementById("txtTotalAmountPaidOblig").className='form101_textfcurr form101_textfcurr_width textonlyRight';
	}
}
function fetchTaxPeriod()
{
	var obligationId=document.getElementById('cmbTaxSubHead').value;
	var paymentType=document.getElementById('cmbPaymentType').value;
	var accMonth=document.getElementById('hidAccMonth').value;
	document.getElementById('hidObligationId').value = obligationId;
	if(obligationId==selectOblCode)
	{
		alert(validObligation);
		var taxTypeOpt = document.getElementById("cmbTaxPeriod");
		taxTypeOpt.options.length = 0;
		var option = document.createElement("option");    
		option.text = '--Select--';
		option.value = '-1';
		try 		 
		{  
			taxTypeOpt.add(option, null); 
		}

		catch(error) 
		{  
			taxTypeOpt.add(option);   
		}

		return false;
	}

	var refType="RTN";
	var obligationId=document.getElementById('cmbTaxSubHead').value;
	var taxPayerId=document.getElementById('hidTaxPayerId').value;
	if(obligationId!=selectOblCode && obligationId!=VAT && obligationId!=IT && obligationId!=VATCode && obligationId!=payeeCode && obligationId!=exciseTaxOblCode && obligationId!=NSSF && obligationId!=CGT && obligationId!=rentIncomeCode && obligationId!=TOTFP)
	{
		FetchTaxPeriod.fetchTaxPeriod(obligationId,taxPayerId,refType,accMonth,paymentType,{async:false,callback: function(data) {
			if(data != null && data.length>1 )
			{
				//if(paymentType == SAT || paymentType == VTDP)
				if(paymentType == SAT || paymentType == VTDP || paymentType == LEGDBT)
				{
					dwr.util.removeAllOptions('cmbTaxPeriod'); 
					var oOption=document.createElement("option");
					optionId=data[0].fromDate;
					optionValue=data[0].toDate;
					oOption.text=optionValue;
					oOption.value=optionId;
					oOption.title=optionValue;
					document.getElementById("cmbTaxPeriod").add(oOption);
					for(var i=1; i<data.length;i++)
					{
						var oOption=document.createElement("option");
						optionId=data[i].fromDate;
						optionValue=data[i].toDate;
						oOption.text=optionValue;
						oOption.value=optionId;
						oOption.title=optionValue;
						document.getElementById("cmbTaxPeriod").add(oOption);
					}

					return true;
				}
				if(paymentType == TIP )
				{
					dwr.util.removeAllOptions('cmbTaxPeriod');

					var oOption=document.createElement("option");
					optionId=data[0].fromDate;
					optionValue=data[0].toDate;
					oOption.text=optionValue;
					oOption.value=optionId;
					oOption.title=optionValue;
					document.getElementById("cmbTaxPeriod").add(oOption);

					var oOption=document.createElement("option");
					var firstValue=data[1].fromDate;
					var lastValue=data[(data.length-1)].fromDate;
					var firstValueArr=firstValue.split('-');
					var fromDateFirst= firstValueArr[0];
					var lastValueArr=lastValue.split('-');
					var fromDateLast= lastValueArr[0];
					var yearFirstArr=fromDateFirst.split('/');
					var yearFisrt=yearFirstArr[2];

					var yearLastArr=fromDateLast.split('/');
					var yearLast=yearLastArr[2];

					if(yearLast>yearFisrt){
						optionId=data[(data.length-1)].fromDate;
						optionValue=data[(data.length-1)].toDate;
					}
					else{
						optionId=data[1].fromDate;
						optionValue=data[1].toDate;
					}

					oOption.text=optionValue;
					oOption.value=optionId;
					oOption.title=optionValue;
					document.getElementById("cmbTaxPeriod").add(oOption);

					/*for(var i=0; i<2;i++)
					{
						var oOption=document.createElement("option");
						optionId=data[i].fromDate;
						optionValue=data[i].toDate;
						oOption.text=optionValue;
						oOption.value=optionId;
						oOption.title=optionValue;
						document.getElementById("cmbTaxPeriod").add(oOption);
					}*/
					if(modifyFlagInstallment!=1)
					{
						dwr.util.removeAllOptions('in_installmentTable_13');
						if(data.length==2)
						{
							var oOption=document.createElement("option");
							optionId=data[0].fromDate;
							optionValue=data[0].toDate;
							oOption.text=optionValue;
							oOption.value=optionId;
							oOption.title=optionValue;
							document.getElementById("in_installmentTable_13").add(oOption);

							var oOption=document.createElement("option");

							if(yearLast>yearFisrt){
								optionId='C'+data[(data.length-1)].fromDate;
								optionValue=data[(data.length-1)].toDate;
							}
							else{
								optionId='C'+data[1].fromDate;
								optionValue=data[1].toDate;
							}


							/*optionId='C'+data[1].fromDate;
							optionValue=data[1].toDate;*/
							oOption.text=optionValue + " (Current Year)";
							oOption.value=optionId;
							oOption.title=optionValue + " (Current Year)";
							document.getElementById("in_installmentTable_13").add(oOption);


						}
						else
						{
							var oOption=document.createElement("option");
							optionId=data[0].fromDate;
							optionValue=data[0].toDate;
							oOption.text=optionValue;
							oOption.value=optionId;
							oOption.title=optionValue;
							document.getElementById("in_installmentTable_13").add(oOption);

							if(yearLast>yearFisrt){

								var oOption=document.createElement("option");
								optionId='C'+data[(data.length-1)].fromDate;
								optionValue=data[(data.length-1)].toDate;
								oOption.text=optionValue + " (Current Year)";
								oOption.value=optionId;
								oOption.title=optionValue + " (Current Year)";
								document.getElementById("in_installmentTable_13").add(oOption);

								var oOption=document.createElement("option");
								optionId='P'+data[(data.length-2)].fromDate;
								optionValue=data[(data.length-2)].toDate;
								oOption.text=optionValue + " (Previous Year)";
								oOption.value=optionId;
								oOption.title=optionValue + " (Previous Year)";
								document.getElementById("in_installmentTable_13").add(oOption);


							}
							else{
								var oOption=document.createElement("option");
								optionId='C'+data[1].fromDate;
								optionValue=data[1].toDate;
								oOption.text=optionValue + " (Current Year)";
								oOption.value=optionId;
								oOption.title=optionValue + " (Current Year)";
								document.getElementById("in_installmentTable_13").add(oOption);

								var oOption=document.createElement("option");
								optionId='P'+data[2].fromDate;
								optionValue=data[2].toDate;
								oOption.text=optionValue + " (Previous Year)";
								oOption.value=optionId;
								oOption.title=optionValue + " (Previous Year)";
								document.getElementById("in_installmentTable_13").add(oOption);
							}

						}
					}

					return true;
				}
				
				// sdded for minimum tax 23/02/2021 by Chang', Ben and Raphael
				if (paymentType === TMT){

					dwr.util.removeAllOptions('cmbTaxPeriod');

					var oOption=document.createElement("option");
					optionId=data[0].fromDate;
					optionValue=data[0].toDate;
					oOption.text=optionValue;
					oOption.value=optionId;
					oOption.title=optionValue;
					document.getElementById("cmbTaxPeriod").add(oOption);

					var oOption=document.createElement("option");
					var firstValue=data[1].fromDate;
					var lastValue=data[(data.length-1)].fromDate;
					var firstValueArr=firstValue.split('-');
					var fromDateFirst= firstValueArr[0];
					var lastValueArr=lastValue.split('-');
					var fromDateLast= lastValueArr[0];
					var yearFirstArr=fromDateFirst.split('/');
					var yearFisrt=yearFirstArr[2];

					var yearLastArr=fromDateLast.split('/');
					var yearLast=yearLastArr[2];

					if(yearLast>yearFisrt){
						optionId=data[(data.length-1)].fromDate;
						optionValue=data[(data.length-1)].toDate;
					}
					else{
						optionId=data[1].fromDate;
						optionValue=data[1].toDate;
					}

					oOption.text=optionValue;
					oOption.value=optionId;
					oOption.title=optionValue;
					document.getElementById("cmbTaxPeriod").add(oOption);					
					return true;
				
				} 
				// END: sdded for minimum tax 23/02/2021 by Chang', Ben and Raphael
			}
			else if(data.length<=1)
			{
				if(paymentType == SAT 
						&& obligationId != turnOver) /* Added by Mingu,Vincent and Kirui*/
				{
					alert(noDuePayment);
					return false;
				}
			}
			else
			{
				alert(errFetchingData);	
				return false;
			}
		}});

	}
	else if(obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode||obligationId==NSSF||obligationId==CGT||obligationId==rentIncomeCode || obligationId==housingLevy||obligationId==TOTFP)
	{
		dwr.util.removeAllOptions('cmbTaxPeriodYear');
		GetYearFromEffetciveYear('cmbTaxPeriodYear');
		document.getElementById("cmbTaxPeriodMonth").selectedIndex=0; 
	}
	if(paymentType == SAT && obligationId!=NSSF && obligationId!=advanceObligationId &&  obligationId!=TOTFP && modifyFlagTaxOblig != 1 && (isWithoutLogin == "N" || isWithoutLogin == "n") && (taxHeadFromRturn==""|| taxHeadFromRturn==null ||taxHeadFromRturn==undefined))
	{
		
		fetchTotalLiabilityDetailsWeb(false);
	}
}

function onChangeAmtToBePaid()
{
	if(modifyFlagTaxOblig==1)
	{
		objValue=0;
	}
	var val=document.getElementById('actualLiabilityAmount_'+objValue).value;
	//Added by Hinga, Sam and Brian for Amnesty :: START
	var newRowValue = parseInt(objValue) + 1;
	var actualPrincipalAmount = document.getElementById('LiablibilityTbl').rows[newRowValue].cells[2].innerHTML;
	const actualPrincipalAmountArray = actualPrincipalAmount.split("<");
	var principalAmountStr = actualPrincipalAmountArray[0].replace(",","");
	var taxPeriod = document.getElementById('LiablibilityTbl').rows[newRowValue].cells[1].innerHTML;
	var hidObligationId = document.getElementById('hidObligationId').value;
	var year = "";
	if(hidObligationId == '2' || hidObligationId == '3' ||
			hidObligationId == '4' || hidObligationId == '22'){
		const taxPeriodArray = taxPeriod.split("-");
		const periodArray = taxPeriodArray[1].split(" ");
		year = periodArray[1];
	}
	else{
		const periodArray = taxPeriod.split(" ");
		year = periodArray[1];
	}
	/*if(parseInt(year)<=2023){
		var formatedVal = parseFloat(val.replaceAll(",",""));
		//if(parseFloat(val)>parseFloat(principalAmountStr)){
		//if(formatedVal>parseFloat(principalAmountStr)){
		if((formatedVal-parseFloat(principalAmountStr.replaceAll(",","")))>1){
			document.getElementById('actualLiabilityAmount_'+objValue).value="0";
			alert("Please pay the Principal Tax First(where Principal tax has decimal values, round off amount to the " +
					"nearest 1 shilling)");
			return false;
		}
	} *///commented for Ticket 78692 to allow payment for Principal,Penalty Fines and Interest
	//Added by Hinga, Sam and Brian for Amnesty :: END
	var str = "0123456789,";
	for(var j = 0; j < val.length; j++)
	{
		if(str.indexOf(val.charAt(j)) == -1)
		{
			val = "";
			document.getElementById('actualLiabilityAmount_'+objValue).value="0";
			alert(enterNumeric);
			return false;
		}
	}
	document.getElementById('actualLiabilityAmount_'+objValue).value=convertToKenyanShillingFormatVal(removeCommaFrmInput(val), true);

	document.getElementById('in_taxObligationTable_6').value =convertToKenyanShillingFormatVal(removeCommaFrmInput(val), true);
	if(modifyFlagTaxOblig!=1)
	{
		document.getElementById('hid_taxObligationTable_6').value=document.getElementById('in_taxObligationTable_6').value;
	}
	return true;
}

function addvalidation(row)
{  
	var checkDuplicateFlag = true; //checkDuplicateForObligation(row,'taxObligationTable');
	if(document.getElementById('cmbTaxHead').value==AGENCY_NOTICE){
		if(document.getElementById("cmbTaxTypeAgency").selectedIndex!=0)
		{
			if(checkDuplicateFlag==false)
			{
				return false;
			}
			if( document.getElementById("LiablibilityTbl").rows.length==2)
			{
				objValue=0;
			}
			if(document.getElementById('liabilityRadio_'+objValue).checked==false)
			{
				alert(atleastOneTaxPeriod);
				return false;
			}

			if (document.getElementById('actualLiabilityAmount_'+objValue).value<='0')
			{
				alert(amtGreaterThanZero);
				return false;
			}
			else
			{
				checkNssfAmount();
				onChangeAmtToBePaid();
				if(addConfirm('a_taxObligationTable'))
				{
					if(document.getElementById('a_taxObligationTable').innerHTML!="Modify")
					{
						addrow('taxObligationTable', '4', '9','3','validateDeleteRowIntotaxObligationTable','validateModifyRowIntotaxObligationTable','N','N');
					}
					else
					{
						return true;
					}
				}

			}
		}
		else
		{
			alert(validObligation);
			return false;
		}

	}else if (document.getElementById('cmbTaxHead').value==IT){ // Added by Sanidhya for payee duplicate check
		/*if (document.getElementById('cmbTaxSubHead').value==payeeCode){*/
			var check=checkDuplicateForObligation(row,'taxObligationTable');
			if(check==true){

					if(checkDuplicateFlag==false)
					{
						return false;
					}
					if( document.getElementById("LiablibilityTbl").rows.length==2)
					{
						objValue=0;
					}
					if(document.getElementById('liabilityRadio_'+objValue).checked==false)
					{
						alert(atleastOneTaxPeriod);
						return false;
					}

					if (document.getElementById('actualLiabilityAmount_'+objValue).value<='0')
					{
						alert(amtGreaterThanZero);
						return false;
					}
					else
					{
						checkNssfAmount();
						//Added by Mingu for Amnesty Payment Registration :: START
						var isCheckAmountToBePaid = onChangeAmtToBePaid();
						//onChangeAmtToBePaid();
						if(isCheckAmountToBePaid){
							if(addConfirm('a_taxObligationTable'))
							{
								if(document.getElementById('a_taxObligationTable').innerHTML!="Modify")
								{
									addrow('taxObligationTable', '4', '9','3','validateDeleteRowIntotaxObligationTable','validateModifyRowIntotaxObligationTable','N','N');
								}
								else
								{
									return true;
								}
							}
						}
							
	}
			}
	}
	else{
		if(document.getElementById("cmbTaxSubHead").selectedIndex!=0)
		{
			checkDuplicateFlag=	checkDuplicateForObligation(row,'taxObligationTable');
			if(document.getElementById("cmbTaxSubHead").value== housingLevy || document.getElementById("cmbTaxSubHead").value== 42){
				
				checkDuplicateFlag=	checkDuplicateForObligation(row,'taxObligationTable');
			}
			if(checkDuplicateFlag==false)
			{
				return false;
			}
			if( document.getElementById("LiablibilityTbl").rows.length==2)
			{
				objValue=0;
			}
			if(document.getElementById('liabilityRadio_'+objValue).checked==false)
			{
				alert(atleastOneTaxPeriod);
				return false;
			}

			if (document.getElementById('actualLiabilityAmount_'+objValue).value<='0')
			{
				alert(amtGreaterThanZero);
				return false;
			}
			else
			{
				checkNssfAmount();
				//Added by Mingu for Amnesty Payment Registration :: START
				var isCheckAmountToBePaid = onChangeAmtToBePaid();
				if(isCheckAmountToBePaid){
					if(addConfirm('a_taxObligationTable'))
					{
						if(document.getElementById('a_taxObligationTable').innerHTML!="Modify")
						{
							if(document.getElementById('cmbTaxSubHead').value!=NSSF){
								addrow('taxObligationTable', '4', '9','3','validateDeleteRowIntotaxObligationTable','validateModifyRowIntotaxObligationTable','N','N');
							}
							else{
								addrow('taxObligationTable', '4', '9','3','validateDeleteRowIntotaxObligationTable','validateModifyRowIntotaxObligationTable','N','N');
							}
						}
						else
						{
							return true;
						}
					}
				}
				

			}
		}
		else
		{
			alert(validObligation);
			return false;
		}
	}
}
function beforeAddIntotaxObligationTable(row)
{
	var checkDuplicateFlag = true; //checkDuplicateForObligation(row,'taxObligationTable');

	startIndexValue=document.getElementById('startIndex').value;
	startIndexValue=startIndexValue-5;
	if(startIndexValue<0)
	{
		startIndexValue='0';
	}
	if(document.getElementById('cmbTaxHead').value==AGENCY_NOTICE){


		if(checkDuplicateFlag==false)
		{
			return false;
		}
		else
		{
			//checkNssfAmount();
			document.getElementById('taxObligationTable').style.display = "";
//			var taxPeriodDisp =document.getElementById("hidTaxPeriod").value;
//			var selectobject=document.getElementById("cmbTaxPeriodAgency");
			var cmbTaxTypeIndex = document.getElementById('cmbTaxTypeAgency').selectedIndex;
			var taxTypeName =  document.getElementById('cmbTaxTypeAgency')[cmbTaxTypeIndex].text;
			document.getElementById('in_taxObligationTable_3').value = taxTypeName;	
			var obligationId=document.getElementById('cmbTaxTypeAgency').value;
			document.getElementById('in_taxObligationTable_11').value=document.getElementById('cmbTaxHead').value;
			if(obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode /* || obligationId==NSSF */ ||obligationId==rentIncomeCode || obligationId==housingLevy || obligationId==42)
			{
//				var taxPeriodMonth = document.getElementById('cmbTaxPeriodMonth').selectedIndex;
//				var taxPeriodMonthValue =document.getElementById('cmbTaxPeriodMonth')[taxPeriodMonth].text;
//				var taxPeriodYear = document.getElementById('cmbTaxPeriodYear').selectedIndex;
//				var taxPeriodYearValue =document.getElementById('cmbTaxPeriodYear')[taxPeriodYear].text;
//				var taxPeriodValue=taxPeriodMonthValue+" "+taxPeriodYearValue;

				var taxPeriod = document.getElementById('cmbTaxPeriodAgency').selectedIndex;		
				var taxPeriodValue =document.getElementById('cmbTaxPeriodAgency')[taxPeriod].text;

				document.getElementById('in_taxObligationTable_4').value = taxPeriodValue;	
				
			}else{
				var taxPeriod = document.getElementById('cmbTaxPeriodAgency').selectedIndex;
				var taxPeriodValue =document.getElementById('cmbTaxPeriodAgency')[taxPeriod].text;
				document.getElementById('in_taxObligationTable_4').value = taxPeriodValue;
			}
			return true;
		}


	}	
	else	{
		if(checkDuplicateFlag==false)
		{
			return false;
		}
		else
		{
			checkNssfAmount();
			document.getElementById('taxObligationTable').style.display = "";
			var taxPeriodDisp =document.getElementById("hidTaxPeriod").value;
			var selectobject=document.getElementById("cmbTaxPeriod");
			var cmbTaxTypeIndex = document.getElementById('cmbTaxSubHead').selectedIndex;
			var taxTypeName =  document.getElementById('cmbTaxSubHead')[cmbTaxTypeIndex].text;
			document.getElementById('in_taxObligationTable_3').value = taxTypeName;	
			var obligationId=document.getElementById('cmbTaxSubHead').value;
			document.getElementById('in_taxObligationTable_11').value=document.getElementById('cmbTaxHead').value;
			if(obligationId == WithHoldee ||obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode || obligationId==NSSF ||obligationId==CGT ||obligationId==rentIncomeCode || obligationId==housingLevy || obligationId==42 || obligationId==TOTFP 
					|| obligationId == VatWithholding || obligationId == TransmissionOblCode || obligationId == shippingOblCode || obligationId == VisOblCode || obligationId == turnOver)
			{
				var taxPeriodMonth = document.getElementById('cmbTaxPeriodMonth').selectedIndex;
				var taxPeriodMonthValue =document.getElementById('cmbTaxPeriodMonth')[taxPeriodMonth].text;
				var taxPeriodYear = document.getElementById('cmbTaxPeriodYear').selectedIndex;
				var taxPeriodYearValue =document.getElementById('cmbTaxPeriodYear')[taxPeriodYear].text;
				var taxPeriodValue=taxPeriodMonthValue+" "+taxPeriodYearValue;
				document.getElementById('in_taxObligationTable_4').value = taxPeriodValue;	
				/*65215 NITA arrears payments :: START*/
				if(obligationId == 42){
				/*65216 NITA SAT without PAYE :: START*/
				var hid_is_Payer_Registered = document.getElementById('hidIsPayeRegistered').value; 
				/*65216 NITA SAT without PAYE :: END*/
				if(document.getElementById('cmbPaymentType').value==NITAR 
				/*65216 NITA SAT without PAYE :: END*/|| (document.getElementById('hidIsPayeRegistered').value == 'N' )){
					document.getElementById('in_taxObligationTable_5').value = document.getElementById('actualLiabilityAmount_0').value;
					
					
					document.getElementById("in_taxObligationTable_7").value=obligationId;

					var fromDate = document.getElementById("frm_date_nitar").value;
					document.getElementById("in_taxObligationTable_9").value=fromDate;

					var toDate = document.getElementById("to_date_nitar").value;
					document.getElementById("in_taxObligationTable_10").value=toDate;

					var hdrId =document.getElementById("hdr_id_nitar").value ;
					document.getElementById("in_taxObligationTable_8").value=hdrId;

					

				
				}
				}
				/*65215 NITA arrears payments :: END*/
			}else{
				var taxPeriod = document.getElementById('cmbTaxPeriod').selectedIndex;
				var taxPeriodValue =document.getElementById('cmbTaxPeriod')[taxPeriod].text;
				document.getElementById('in_taxObligationTable_4').value = taxPeriodValue;	
			}
			return true;
		}
	}
}

function afterAddIntotaxObligationTable()
{	
	if(document.getElementById('cmbTaxHead').value==AGENCY_NOTICE){

		var totalAmountPaid =removeCommaFrmInput( document.getElementById('txtTotalAmountPaidOblig').value);
		var amountPaid =removeCommaFrmInput( document.getElementById('hid_taxObligationTable_6').value);
		totalAmountPaid = parseInt(totalAmountPaid,10) + parseInt(amountPaid,10);
		document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(Math.ceil(totalAmountPaid), true);
		document.getElementById('liabilityRadio_'+objValue).checked=false;
		document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).value = document.getElementById('hidActualLiabilityAmount').value;
		document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).readOnly = true;
		document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).className='readonlyInput form101_textfcurr_width textonlyRight';
		document.getElementById('imgShowIntrest_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
		document.getElementById('imgShowPenalty_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
		document.getElementById('imgShowFine_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
		document.getElementById('imgShowPayment_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
//		document.getElementById('cmbTaxPeriodAgency').selectedIndex=0;
//		document.getElementById("cmbTaxPeriodAgency").disabled=true;
		document.getElementById('startIndex').value=startIndexValue;
		document.getElementById('showTaxObligationTable').style.display='none';
		document.getElementById('in_taxObligationTable_11').value=Obligation_Type_Tax;
		if(isWithoutLogin == "N" || isWithoutLogin == "n"){
			fetchTotalLiabilityDetailsWeb(true);
		}

		if(document.getElementById('cmbTaxTypeAgency').value==NSSF){
			selectedFlagNSSF=selectedFlagNSSF+1;
		}else{
			selectedFlagTaxOblig=selectedFlagTaxOblig+1;
		}

		selectedLiablity=0;
		if(document.getElementById("tblFineList").style.display=="")
		{
			document.getElementById("tblFineList").style.display="none";
			changeImgNew(document.getElementById("imgShowFine_"+cntrForHide),3);
		}
		if(document.getElementById("tblIntrestList").style.display=="")
		{
			document.getElementById("tblIntrestList").style.display="none";
			changeImgNew(document.getElementById("imgShowIntrest_"+cntrForHide),1);
		}
		if(document.getElementById("tblPaymentList").style.display=="")
		{
			document.getElementById("tblPaymentList").style.display="none";
			changeImgNew(document.getElementById("imgShowPayment_"+cntrForHide),4);
		}
		if(document.getElementById("tblPenaltyList").style.display=="")
		{
			document.getElementById("tblPenaltyList").style.display="none";
			changeImgNew(document.getElementById("imgShowPenalty_"+cntrForHide),2);
		}

        }	
else{
	
	var totalAmountPaid =removeCommaFrmInput( document.getElementById('txtTotalAmountPaidOblig').value);
	var amountPaid =removeCommaFrmInput( document.getElementById('hid_taxObligationTable_6').value);
	 totalAmountPaid = parseInt(totalAmountPaid,10) + parseInt(amountPaid,10);
	 if(document.getElementById('cmbTaxSubHead').value==housingLevy || document.getElementById('cmbTaxSubHead').value==42){
			/*65215 NITA arrears payment :: START*/
		 if(document.getElementById('cmbPaymentType').value==NITAR 
				 || (document.getElementById('hidIsPayeRegistered').value == 'N')){
				document.getElementById('hid_taxObligationTable_6').value = convertToKenyanShillingFormatVal(parseInt(totalAmountPaid,10).toFixed(2),false);
				
				
		 
		 }
		 /*65215 NITA arrears payment :: END*/
		 var amountPaid1 =document.getElementById('hid_taxObligationTable_6').value;
			document.getElementById('txtTotalAmountPayableOTR').value= document.getElementById('hid_taxObligationTable_6').value;
			document.getElementById('txtTotalAmountPaidOTR').value= document.getElementById('hid_taxObligationTable_6').value;
		
		 
	 }
	 if(document.getElementById('cmbTaxSubHead').value==42)
	 {
		var i=0;
		
		newTextVal = " ";
		/*65215 NITA arrears payment :: START*/
		var max=10;
		if(document.getElementById('cmbPaymentType').value==NITAR){
			var rowcount =	document.getElementById('taxObligationTable').rows.length;
			if(rowcount > 2){
			max = rowcount + 1;
			}
		}
		/*65215 NITA arrears payment :: END*/
		for(i;i<max;i++)
		{
		
			var tabledel = document.getElementById('id_taxObligationTable_'+i+'_2');
			if(tabledel!=null)
			{
				tabledel.name=" ";
				tabledel.innerHTML = newTextVal;
		 	}
			
		}
		
	
	 }
		
	document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(Math.ceil(totalAmountPaid), true);
	document.getElementById('liabilityRadio_'+objValue).checked=false;
	document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).value = document.getElementById('hidActualLiabilityAmount').value;
	document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).readOnly = true;
	document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).className='readonlyInput form101_textfcurr_width textonlyRight';
	document.getElementById('imgShowIntrest_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
	document.getElementById('imgShowPenalty_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
	document.getElementById('imgShowFine_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
	document.getElementById('imgShowPayment_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
	document.getElementById('cmbTaxPeriod').selectedIndex=0;
	document.getElementById('cmbTaxPeriodMonth').selectedIndex='0';
	document.getElementById('cmbTaxPeriodYear').selectedIndex='0';
	document.getElementById("cmbTaxPeriodMonth").disabled=true;
	document.getElementById('startIndex').value=startIndexValue;
	document.getElementById('showTaxObligationTable').style.display='none';
	document.getElementById('in_taxObligationTable_11').value=Obligation_Type_Tax;
	if(isWithoutLogin == "N" || isWithoutLogin == "n"){
		//fetchTotalLiabilityDetailsWeb(true);
	}

		/*var totalAmountPaid =removeCommaFrmInput( document.getElementById('txtTotalAmountPaidOblig').value);
		var amountPaid =removeCommaFrmInput( document.getElementById('hid_taxObligationTable_6').value);
		totalAmountPaid = parseInt(totalAmountPaid,10) + parseInt(amountPaid,10);
		document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(Math.ceil(totalAmountPaid), true);
		document.getElementById('liabilityRadio_'+objValue).checked=false;
		document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).value = document.getElementById('hidActualLiabilityAmount').value;
		document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).readOnly = true;
		document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).className='readonlyInput form101_textfcurr_width textonlyRight';
		document.getElementById('imgShowIntrest_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
		document.getElementById('imgShowPenalty_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
		document.getElementById('imgShowFine_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
		document.getElementById('imgShowPayment_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
		document.getElementById('cmbTaxPeriod').selectedIndex=0;
		document.getElementById('cmbTaxPeriodMonth').selectedIndex='0';
		document.getElementById('cmbTaxPeriodYear').selectedIndex='0';
		document.getElementById("cmbTaxPeriodMonth").disabled=true;
		document.getElementById('startIndex').value=startIndexValue;
		document.getElementById('showTaxObligationTable').style.display='none';
		document.getElementById('in_taxObligationTable_11').value=Obligation_Type_Tax;
		if(isWithoutLogin == "N" || isWithoutLogin == "n"){
			fetchTotalLiabilityDetailsWeb(true);
		}*/

		if(document.getElementById('cmbTaxSubHead').value==NSSF){
			selectedFlagNSSF=selectedFlagNSSF+1;
		}else{
			selectedFlagTaxOblig=selectedFlagTaxOblig+1;
		}

		selectedLiablity=0;
		if(document.getElementById("tblFineList").style.display=="")
		{
			document.getElementById("tblFineList").style.display="none";
			changeImgNew(document.getElementById("imgShowFine_"+cntrForHide),3);
		}
		if(document.getElementById("tblIntrestList").style.display=="")
		{
			document.getElementById("tblIntrestList").style.display="none";
			changeImgNew(document.getElementById("imgShowIntrest_"+cntrForHide),1);
		}
		if(document.getElementById("tblPaymentList").style.display=="")
		{
			document.getElementById("tblPaymentList").style.display="none";
			changeImgNew(document.getElementById("imgShowPayment_"+cntrForHide),4);
		}
		if(document.getElementById("tblPenaltyList").style.display=="")
		{
			document.getElementById("tblPenaltyList").style.display="none";
			changeImgNew(document.getElementById("imgShowPenalty_"+cntrForHide),2);
		}
	}
}

function checkDuplicateForObligation(r,id)
{
	rows=r;
	if(document.getElementById('cmbTaxHead').value==AGENCY_NOTICE){

		var obligationId=document.getElementById('cmbTaxTypeAgency').value;
		tabObj1 = document.getElementById(id);
		var taxObligation = document.getElementById('cmbTaxTypeAgency').selectedIndex;
		var taxObligationValue =  trim(document.getElementById('cmbTaxTypeAgency')[taxObligation].text);
		if(obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode||obligationId==CGT||obligationId==rentIncomeCode)
		{
			var taxPeriod = document.getElementById('cmbTaxPeriodAgency').selectedIndex;		
			var taxPeriodValue =document.getElementById('cmbTaxPeriodAgency')[taxPeriod].text;

			if(tabObj1.rows.length==1)
			{
			}
			else
			{ 	
				for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
				{  
					var modify;
					if(document.all)
					{
						modify=trim(tabObj1.rows[i].cells[2].innerText);
					}
					else
					{
						modify=trim(tabObj1.rows[i].cells[2].textContent,"");
					}
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (trim(tabObj1.rows[i].cells[4].innerHTML)==taxPeriodValue))
					{
						alert(detailsAlreadyAdded);
						return false;
					}
				}
			}

			return true;
		}
		else
		{

			var taxPeriod = document.getElementById('cmbTaxPeriodAgency').selectedIndex;

			var taxPeriodValue =document.getElementById('cmbTaxPeriodAgency')[taxPeriod].value.split('-');

			if(taxPeriodValue[1]==null || taxPeriodValue[1]=="" ||taxPeriodValue[1]==undefined )
			{	
				taxPeriodValue=trim(taxPeriodValue[0]);	
			}
			else
			{
				taxPeriodValue=trim(taxPeriodValue[0])+'-'+trim(taxPeriodValue[1]);
			}

			if(tabObj1.rows.length==1)
			{
			}
			else
			{ 	
				for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
				{  
					var taxPeriodValueTabl=tabObj1.rows[i].cells[4].innerHTML.split('-');
					if(taxPeriodValueTabl[1]==null || taxPeriodValueTabl[1]=="" ||taxPeriodValueTabl[1]==undefined )
					{	
						taxPeriodValueTabl=trim(taxPeriodValueTabl[0]);	
					}
					else
					{
						taxPeriodValueTabl=trim(taxPeriodValueTabl[0])+'-'+trim(taxPeriodValueTabl[1]);
					}
					var modify;
					if(document.all)
					{
						modify=trim(tabObj1.rows[i].cells[2].innerText);
					}
					else
					{
						modify=trim(tabObj1.rows[i].cells[2].textContent,"");
					}
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (trim(modify))=="Modify" &&  (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (trim(taxPeriodValueTabl)==taxPeriodValue))
					{
						alert(detailsAlreadyAdded);
						return false;
					}
				}
			}

			return true;
		}

	}

	else if(document.getElementById('cmbTaxHead').value==AUCTION_NOTICE){

		var obligationId=document.getElementById('cmbTaxTypeAuction').value;
		tabObj1 = document.getElementById(id);
		var taxObligation = document.getElementById('cmbTaxTypeAuction').selectedIndex;
		var taxObligationValue =  trim(document.getElementById('cmbTaxTypeAuction')[taxObligation].text);
		if(obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode||obligationId==rentIncomeCode)
		{
			var taxPeriod = document.getElementById('cmbTaxPeriodAuction').selectedIndex;		
			var taxPeriodValue =document.getElementById('cmbTaxPeriodAuction')[taxPeriod].text;

			if(tabObj1.rows.length==1)
			{
			}
			else
			{ 	
				for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
				{  
					var modify;
					if(document.all)
					{
						modify=trim(tabObj1.rows[i].cells[2].innerText);
					}
					else
					{
						modify=trim(tabObj1.rows[i].cells[2].textContent,"");
					}
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (trim(tabObj1.rows[i].cells[4].innerHTML)==taxPeriodValue))
					{
						alert(detailsAlreadyAdded);
						return false;
					}
				}
			}

			return true;
		}
		else
		{

			var taxPeriod = document.getElementById('cmbTaxPeriodAuction').selectedIndex;

			var taxPeriodValue =document.getElementById('cmbTaxPeriodAuction')[taxPeriod].value.split('-');

			if(taxPeriodValue[1]==null || taxPeriodValue[1]=="" ||taxPeriodValue[1]==undefined )
			{	
				taxPeriodValue=trim(taxPeriodValue[0]);	
			}
			else
			{
				taxPeriodValue=trim(taxPeriodValue[0])+'-'+trim(taxPeriodValue[1]);
			}

			if(tabObj1.rows.length==1)
			{
			}
			else
			{ 	
				for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
				{  
					var taxPeriodValueTabl=tabObj1.rows[i].cells[4].innerHTML.split('-');
					if(taxPeriodValueTabl[1]==null || taxPeriodValueTabl[1]=="" ||taxPeriodValueTabl[1]==undefined )
					{	
						taxPeriodValueTabl=trim(taxPeriodValueTabl[0]);	
					}
					else
					{
						taxPeriodValueTabl=trim(taxPeriodValueTabl[0])+'-'+trim(taxPeriodValueTabl[1]);
					}
					var modify;
					if(document.all)
					{
						modify=trim(tabObj1.rows[i].cells[2].innerText);
					}
					else
					{
						modify=trim(tabObj1.rows[i].cells[2].textContent,"");
					}
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (trim(modify))=="Modify" &&  (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (trim(taxPeriodValueTabl)==taxPeriodValue))
					{
						alert(detailsAlreadyAdded);
						return false;
					}
				}
			}

			return true;
		}

	}

	else {

		var obligationId=document.getElementById('cmbTaxSubHead').value;
		tabObj1 = document.getElementById(id);
		var taxObligation = document.getElementById('cmbTaxSubHead').selectedIndex;
		var taxObligationValue =  trim(document.getElementById('cmbTaxSubHead')[taxObligation].text);
		var incomeType;
		if(obligationId== housingLevy )
		{
			if(tabObj1.rows.length==2)
			{
				var selectedMonth=document.getElementById('taxObligationTable').rows[1].cells[4].innerText;
				var taxPeriodMonth = document.getElementById('cmbTaxPeriodMonth').selectedIndex;
				var taxPeriodMonthValue =document.getElementById('cmbTaxPeriodMonth')[taxPeriodMonth].text;
				var taxPeriodYear = document.getElementById('cmbTaxPeriodYear').selectedIndex;
				var taxPeriodYearValue =document.getElementById('cmbTaxPeriodYear')[taxPeriodYear].text;
				if(selectedMonth.includes(taxPeriodMonthValue))
				{
					alert (detailsAlreadyAdded);
				}
				else
				{
					if(obligationId== housingLevy)
					{
						alert ("You cannot register Housing Levy payment for more than one Tax Period.");
					}
					else
					{
						alert ("You cannot register NITA Levy payment for multiple periods.");
					}
				}

				return false;
			
			}
		}
		if(obligationId==42)
		{
			var i =1;
			//var allowAdd = 
			if(tabObj1.rows.length==1)
			{
				
			}
			/*Added for 65215 NITA arrears :: START*/
			else if(document.getElementById('cmbPaymentType').value == NITAR ){
					//|| document.getElementById('hidIsPayeRegistered').value == 'N'){
				var selectedMonth=document.getElementById('taxObligationTable').rows[1].cells[4].innerText;
				var taxPeriodMonth = document.getElementById('cmbTaxPeriodMonth').selectedIndex;
				var taxPeriodMonthValue =document.getElementById('cmbTaxPeriodMonth')[taxPeriodMonth].text;
				var taxPeriodYear = document.getElementById('cmbTaxPeriodYear').selectedIndex;
				var taxPeriodYearValue =document.getElementById('cmbTaxPeriodYear')[taxPeriodYear].text;
				var taxPeriodValue1=taxPeriodMonthValue+" "+taxPeriodYearValue;
				if(taxPeriodMonth==0 || taxPeriodYear == 0 )
				{
					alert (detailsAlreadyAdded);
					return false;
				}else{
					for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
					{ 
						var taxPeriodValueOfTable =tabObj1.rows[i].cells[4].innerHTML.split('-');

						if(taxPeriodValueOfTable[1]==null || taxPeriodValueOfTable[1]=="" ||taxPeriodValueOfTable[1]==undefined )
						{	
							taxPeriodValueOfTable=trim(taxPeriodValueOfTable[0]);	
						}
						else
						{
							taxPeriodValueOfTable=trim(taxPeriodValueOfTable[0])+'-'+trim(taxPeriodValueOfTable[1]);
						}
						if(document.all){
							modify=trim(tabObj1.rows[i].cells[2].innerText);
						}
						else{
							modify=trim(tabObj1.rows[i].cells[2].textContent);
						}

						if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (taxPeriodValueOfTable==taxPeriodValue1))
						{
							alert(alreadyAddedDetials);
							return false;
						}
					}
					
				}
			}
			/*Added for 65215 NITA arrears :: END*/
			else
			{
				for(i;i<tabObj1.rows.length;i++)
				{
					if(document.getElementById('taxObligationTable').rows[i].cells[1].innerText != null)
					{
						if(document.getElementById('taxObligationTable').rows[i].cells[1].innerText == "deleted" )
						{
						
						}
						else
						{
							alert ("You cannot register NITA Levy payment for multiple periods.");
							return false;
						}
					
					}
				}
			}
			
		}
		if(obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode
				||obligationId==CGT||obligationId==rentIncomeCode || obligationId==NSSF || 
				obligationId==housingLevy || obligationId==42 
				|| obligationId == TransmissionOblCode || obligationId == shippingOblCode 
				|| obligationId == VatWithholding || obligationId == VisOblCode || obligationId == turnOver)
		{
			var taxPeriodMonth = document.getElementById('cmbTaxPeriodMonth').selectedIndex;
			var taxPeriodMonthValue =document.getElementById('cmbTaxPeriodMonth')[taxPeriodMonth].text;
			var taxPeriodYear = document.getElementById('cmbTaxPeriodYear').selectedIndex;
			var taxPeriodYearValue =document.getElementById('cmbTaxPeriodYear')[taxPeriodYear].text;
			var taxPeriodValue=taxPeriodMonthValue+" "+taxPeriodYearValue;
			if(obligationId==NSSF)
			{
				incomeType = document.getElementById('cmbIncomeType').selectedIndex;
			}
			else
			{
				incomeType = 0;
				incomeTypeOne = 0;
			}
			if(tabObj1.rows.length==1)
			{
				if(obligationId==NSSF)
				{
					incomeTypeOne = 0;
					incomeTypeOne = document.getElementById('cmbIncomeType').selectedIndex;
				}	
				else
				{
					incomeTypeOne = 0;
					incomeType = 0;
				}
			}
			else
			{ 	
				if((tabObj1.rows.length == 3) && (obligationId==NSSF))
				{
					alert(detailsAlreadyAdded);
					return false;
				}
				else
				{  
					if(incomeTypeOne == incomeType)
					{
						for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
						{  
							var modify;
							if(document.all)
							{
								modify=trim(tabObj1.rows[i].cells[2].innerText);
							}
							else
							{
								modify=trim(tabObj1.rows[i].cells[2].textContent,"");
							}
							if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (trim(tabObj1.rows[i].cells[4].innerHTML)==taxPeriodValue))
							{
								alert(detailsAlreadyAdded);
								return false;
							}
						}
					}
					else
					{
						for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
						{  
							var modify;
							if(document.all)
							{
								modify=trim(tabObj1.rows[i].cells[2].innerText);

							}
							else
							{
								modify=trim(tabObj1.rows[i].cells[2].textContent,"");
							}
							if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (trim(tabObj1.rows[i].cells[4].innerHTML)==taxPeriodValue))
							{
								alert(alreadyAddedDetials);
								return false;
							}
						}
					}
				} 
			}

			return true;
		}
		else
		{

			var taxPeriod = document.getElementById('cmbTaxPeriod').selectedIndex;

			var taxPeriodValue =document.getElementById('cmbTaxPeriod')[taxPeriod].text.split('-');

			if(taxPeriodValue[1]==null || taxPeriodValue[1]=="" ||taxPeriodValue[1]==undefined )
			{	
				taxPeriodValue=trim(taxPeriodValue[0]);	
			}
			else
			{
				taxPeriodValue=trim(taxPeriodValue[0])+'-'+trim(taxPeriodValue[1]);
			}
			if(tabObj1.rows.length==1)
			{
			}
			else
			{ 	
				for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
				{ 
					var taxPeriodValueOfTable =tabObj1.rows[i].cells[4].innerHTML.split('-');

					if(taxPeriodValueOfTable[1]==null || taxPeriodValueOfTable[1]=="" ||taxPeriodValueOfTable[1]==undefined )
					{	
						taxPeriodValueOfTable=trim(taxPeriodValueOfTable[0]);	
					}
					else
					{
						taxPeriodValueOfTable=trim(taxPeriodValueOfTable[0])+'-'+trim(taxPeriodValueOfTable[1]);
					}
					if(document.all){
						modify=trim(tabObj1.rows[i].cells[2].innerText);
					}
					else{
						modify=trim(tabObj1.rows[i].cells[2].textContent);
					}

					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && ((modify))=="Modify" &&  (trim(tabObj1.rows[i].cells[3].innerHTML)==taxObligationValue) && (taxPeriodValueOfTable==taxPeriodValue))
					{
						alert(alreadyAddedDetials);
						return false;
					}
				}
			}

			return true;
		}
	}
}
function validateDeleteRowIntotaxObligationTable(tab_str, rowno, cols) 
{
	if(deleteFlagTaxOblig==1 && modifyFlagTaxOblig==0)
	{
		var table = document.getElementById('taxObligationTable');  
		var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
		var tempAmt = table.rows[rowno].cells[6].innerHTML;
		totalAmt = totalAmt - parseInt(removeCommaFrmInput(tempAmt),"10");
		document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
		document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
		
		/*Added for 65215 NITA arrears :: START*/
		if(document.getElementById('cmbPaymentType').value ==NITAR ){
			document.getElementById('txtTotalAmountPayableOTR').value= convertToKenyanShillingFormatVal(totalAmt);
			document.getElementById('txtTotalAmountPaidOTR').value= convertToKenyanShillingFormatVal(totalAmt);
		}
		/*Added for 65215 NITA arrears :: END*/

		if(document.getElementById('cmbTaxSubHead').value==NSSF){
			selectedFlagNSSF=selectedFlagNSSF-1;
		}else{
			selectedFlagTaxOblig=selectedFlagTaxOblig-1;
		}
		deleteFlagTaxOblig = 0;
	}
	else
	{
		deleteFlagTaxOblig = 0;
	}
}
function validateModifyRowIntotaxObligationTable(tab_str, rowno, cols) 
{
	modifyFlagTaxOblig = 1;
	commonModifyFlag=1;
	if(document.getElementById('cmbTaxSubHead').value!=NSSF){
		document.getElementById('cmbTaxHead').value=document.getElementById('in_taxObligationTable_11').value;
		commonModifyFlag=0;
		onChangeCmbTaxHead(document.getElementById('cmbTaxHead'));
		commonModifyFlag=1;
		document.getElementById('cmbTaxSubHead').value=document.getElementById('in_taxObligationTable_7').value;
		onChangeCmbSubTaxHead(document.getElementById('cmbTaxSubHead'));
		document.getElementById('cmbPaymentType').value=SAT;
		onChngCmbPmtType(document.getElementById('cmbPaymentType'));
	}
	fetchTaxPeriod();
	var obligationId=document.getElementById('cmbTaxSubHead').value;
	if((obligationId==payeeCode || obligationId==VATCode) &&  (document.getElementById('cmbTaxPeriodYear').selectedIndex==-1 || document.getElementById('cmbTaxPeriodYear').selectedIndex==0)){
		var option = document.createElement("OPTION"); 
			
		
		option.text=year; 
		option.value=year; 
		document.getElementById('cmbTaxPeriodYear').add(option);
		document.getElementById('cmbTaxPeriodYear').value=year;
							
		}
	if(obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode||obligationId==NSSF||obligationId==CGT||obligationId==rentIncomeCode ||obligationId==TOTFP)
	{
		year=parseInt(document.getElementById('in_taxObligationTable_9').value.substr(6, document.getElementById('in_taxObligationTable_9').value.length),10);
		document.getElementById('cmbTaxPeriodYear').value=year;
		getSelectedMonthOfSelectedYearWeb('cmbTaxPeriodYear','cmbTaxPeriodMonth','false');
		document.getElementById('cmbTaxPeriodMonth').value=document.getElementById('in_taxObligationTable_9').value+"-"+document.getElementById('in_taxObligationTable_10').value;
		if((obligationId==payeeCode || obligationId==VATCode) &&  (document.getElementById('cmbTaxPeriodMonth').selectedIndex==-1 || document.getElementById('cmbTaxPeriodMonth').selectedIndex==0)){
			var fromDate=document.getElementById('in_taxObligationTable_9').value;
			var month1=fromDate.split('/');
			var month=month1[1];
			var oOption = document.createElement("OPTION"); 
			
			oOption.text=monthNamesPayee[parseInt(month)-1]; 
			oOption.value=document.getElementById('in_taxObligationTable_9').value+"-"+document.getElementById('in_taxObligationTable_10').value; 
			document.getElementById('cmbTaxPeriodMonth').add(oOption);
			document.getElementById('cmbTaxPeriodMonth').value=document.getElementById('in_taxObligationTable_9').value+"-"+document.getElementById('in_taxObligationTable_10').value;
								
			}
		taxPeriodMonth=document.getElementById('cmbTaxPeriodMonth').value;
		fetchObligationDTL(document.getElementById('cmbTaxPeriodMonth').value);
	}
	else if(obligationId==NSSF)
	{
		year=parseInt(document.getElementById('in_taxObligationTable_9').value.substr(6, document.getElementById('in_taxObligationTable_9').value.length),10);
		document.getElementById('cmbTaxPeriodYear').value=year;
		getSelectedMonthOfSelectedYearWeb('cmbTaxPeriodYear','cmbTaxPeriodMonth','false');
		document.getElementById('cmbTaxPeriodMonth').value=document.getElementById('in_taxObligationTable_9').value+"-"+document.getElementById('in_taxObligationTable_10').value;
		taxPeriodMonth=document.getElementById('cmbTaxPeriodMonth').value;
		fetchObligationDTL(document.getElementById('cmbTaxPeriodMonth').value);
		document.getElementById('actualLiabilityAmount_'+0).readOnly=true;
		document.getElementById('actualLiabilityAmount_'+0).className='readonlyInput form101_textfcurr_width textonlyRight';
	}
	else
	{
		document.getElementById('cmbTaxPeriod').value=document.getElementById('in_taxObligationTable_9').value+"-"+document.getElementById('in_taxObligationTable_10').value;
		taxPeriodMonth=document.getElementById('cmbTaxPeriod').value;
		fetchObligationDTL(document.getElementById('cmbTaxPeriod').value);
	}

}
function afterModifyIntotaxObligationTable() 
{
	modifyFlagTaxOblig = 0;
	commonModifyFlag=0;

	var table = document.getElementById('taxObligationTable');
	document.getElementById('in_taxObligationTable_3').value = document.getElementById('hidObligationId').value; 
	document.getElementById('cmbTaxSubHead').value = document.getElementById('hidObligationId').value;
	document.getElementById('liabilityRadio_'+0).checked=false;	
	document.getElementById('actualLiabilityAmount_'+0).value=document.getElementById('hidActualLiabilityAmount').value;
	document.getElementById('actualLiabilityAmount_'+0).readOnly=true;
	document.getElementById('actualLiabilityAmount_'+0).className='readonlyInput form101_textfcurr_width textonlyRight';
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	document.getElementById('txtTotalAmountPaidOblig').readOnly=false;
	document.getElementById('txtTotalAmountPaidOblig').className='form101_textfcurr form101_textfcurr_width textonlyRight';
	if(document.all)
	{
		document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(table.rows[rowno].cells[6].innerText),"10")-parseInt(removeCommaFrmInput(document.getElementById('hid_taxObligationTable_6').value),10),true); 
	}
	else
	{
		document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(table.rows[rowno].cells[6].textContent),"10")-parseInt(removeCommaFrmInput(document.getElementById('hid_taxObligationTable_6').value),10),true);
	}
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true; 
	document.getElementById('txtTotalAmountPaidOblig').className='readonlyInput form101_textfcurr_width textonlyRight';
	document.getElementById('imgShowFine_'+0).style.visibility = 'hidden';
	document.getElementById('imgShowPenalty_'+0).style.visibility = 'hidden';
	document.getElementById('imgShowIntrest_'+0).style.visibility = 'hidden';
	document.getElementById('imgShowPayment_'+0).style.visibility = 'hidden';  
	document.getElementById('tblPenaltyList').style.display = 'none'; 
	document.getElementById('tblFineList').style.display = 'none';
	document.getElementById('tblIntrestList').style.display = 'none';
	document.getElementById('tblPaymentList').style.display = 'none';
	document.getElementById('cmbTaxPeriod').selectedIndex='0';
	document.getElementById('cmbTaxPeriodMonth').selectedIndex='0';
	document.getElementById('cmbTaxPeriodYear').selectedIndex='0';
	document.getElementById("cmbTaxPeriodMonth").disabled=true;
	document.getElementById('showTaxObligationTable').style.display='none';
	if(document.getElementById('hidObligationId').value!=TOTFP && (isWithoutLogin == "N" || isWithoutLogin == "n" )){
		fetchTotalLiabilityDetailsWeb(true);
	}

}
function afterDeleteIntotaxObligationTable()
{
	deleteFlagTaxOblig = 1;
}
function clearObligDeials()
{
	if(clear_table('taxObligationTable', '9'))
	{
		modifyFlagTaxOblig=0;
		commonModifyFlag=0;
		clear_table_data("LiablibilityTbl");
		document.getElementById('navigationFieldset').style.display = 'none';
		document.getElementById('LiablibilityTbl').style.display = 'none';
		document.getElementById('navigationTable').style.display = 'none';
		document.getElementById('cmbTaxPeriod').selectedIndex='0';
		document.getElementById('cmbTaxPeriodMonth').selectedIndex='0';
		document.getElementById('cmbTaxPeriodYear').selectedIndex='0';
		document.getElementById("cmbTaxPeriodMonth").disabled=true;
		document.getElementById('showTaxObligationTable').style.display = 'none';
		document.getElementById('incomeTypeTd').style.display='none';
		document.getElementById('incomeType').style.display='none';
		//document.getElementById('incomeType').selectedIndex='0';
	}
}

function getSelectedMonthOfSelectedYearWeb(yearValue,month,AdvOrCurMonthReq)
{
	if(document.getElementById(yearValue).selectedIndex!= 0)
	{
		selectedyear=document.getElementById(yearValue).value;
		document.getElementById(month).disabled=false;

		var regDate = null;
		var taxHeadValue=document.getElementById("cmbTaxHead").value;
		var paymentTypeValue=document.getElementById("cmbPaymentType").value;
		var taxSubHeadValue=document.getElementById("cmbTaxSubHead").value;

		if(taxHeadValue==IT  && taxSubHeadValue==CGT && paymentTypeValue != VTDP)
		{
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			var obligationID=CGT;
			GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationID,taxPayerID,{async:false,callback: function(data){
				if(data != 'null' &&  data != null){
					var serverDateArray = data.effectiveDate.split("/");
					var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
					curdate.setMonth(curdate.getMonth() - 1);
					var dd = curdate.getDate();
					if (dd<10) dd= '0'+dd;
					var mm = curdate.getMonth() + 1; // now moths are 1-12
					if (mm<10) mm= '0'+mm;
					regDate=dd+"/"+mm+"/"+curdate.getFullYear();
					document.getElementById('hidEffectiveDt').value=regDate;
				}
			}});
		}
		else if(paymentTypeValue == VTDP){
			/*var year=parseInt(document.getElementById('in_taxObligationTable_9').value.substr(6, document.getElementById('in_taxObligationTable_9').value.length),10);
			var month = document.getElementById('in_taxObligationTable_9').value+"-"+document.getElementById('in_taxObligationTable_10').value;
			*///alert("yaer is::"+year+"::month IS::"+month)
			//regDate="01/"+month+"/"+year;
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			var obligationID=rentIncomeCode;
			regDate=document.getElementById('in_taxObligationTable_9').value;
			document.getElementById('hidEffectiveDt').value=regDate;
		}
		//changes done for CR Monthly Rental Income
		else if(taxHeadValue==IT  && taxSubHeadValue==rentIncomeCode)
		{
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			var obligationID=rentIncomeCode;
			GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationID,taxPayerID,{async:false,callback: function(data){
				if(data != 'null' &&  data != null){
					var serverDateArray = data.effectiveDate.split("/");
					var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
					curdate.setMonth(curdate.getMonth() - 1);
					var dd = curdate.getDate();
					if (dd<10) dd= '0'+dd;
					var mm = curdate.getMonth() + 1; // now moths are 1-12
					if (mm<10) mm= '0'+mm;
					regDate=dd+"/"+mm+"/"+curdate.getFullYear();
					document.getElementById('hidEffectiveDt').value=regDate;
				}
			}});
		}
		//end
		else if(document.getElementById('cmbTaxHead').value==IT && document.getElementById('cmbTaxSubHead').value== 44 )
		{
			if(document.getElementById("cmbTaxPeriodYear").value==-1 || document.getElementById("cmbTaxPeriodYear").value==0)
			{
				document.getElementById(month).disabled=true;
				alert("Please Select valid year for tax period");
				return false;
			}
			var obligationId=document.getElementById('cmbTaxSubHead').value;
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationId,taxPayerID,{async:false,callback: function(data){
				if(data != 'null' &&  data != null){
					regDate=data.effectiveDate;
					var serverDateArray = data.effectiveDate.split("/");
					var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
					curdate.setMonth(curdate.getMonth() - 1);
					var dd = curdate.getDate();
					if (dd<10) dd= '0'+dd;
					var mm = curdate.getMonth() + 1; // now moths are 1-12
					if (mm<10) mm= '0'+mm;
					regDate=dd+"/"+mm+"/"+curdate.getFullYear();
					document.getElementById('hidEffectiveDt').value=regDate;
				}
			}});
			
				
			
		}
		/*Added for SEP #81171 ::START*/
		else if(document.getElementById('cmbTaxHead').value==IT &&  document.getElementById('cmbTaxSubHead').value== 47)
		{
			if(document.getElementById("cmbTaxPeriodYear").value==-1 || document.getElementById("cmbTaxPeriodYear").value==0)
			{
				document.getElementById(month).disabled=true;
				alert("Please Select valid year for tax period");
				return false;
			}
			var obligationId=document.getElementById('cmbTaxSubHead').value;
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationId,taxPayerID,{async:false,callback: function(data){
				if(data != 'null' &&  data != null){
					regDate=data.effectiveDate;
					var serverDateArray = data.effectiveDate.split("/");
					var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
					curdate.setMonth(curdate.getMonth() - 1);
					var dd = curdate.getDate();
					if (dd<10) dd= '0'+dd;
					var mm = curdate.getMonth() + 1; // now moths are 1-12
					if (mm<10) mm= '0'+mm;
					regDate=dd+"/"+mm+"/"+curdate.getFullYear();
					document.getElementById('hidEffectiveDt').value=regDate;
				}
			}});
			
				
			
		}
		/*Added for SEP #81171 ::END*/
		
		//START::::Added for DAT 11/2023
		else if(document.getElementById('cmbTaxHead').value==IT && document.getElementById('cmbTaxSubHead').value== 45)
		{
			 
			if(document.getElementById("cmbTaxPeriodYear").value==-1 || document.getElementById("cmbTaxPeriodYear").value==0)
			{
				document.getElementById(month).disabled=true;
				alert("Please Select valid year for tax period");
				return false;
			}
			var obligationId=document.getElementById('cmbTaxSubHead').value;
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationId,taxPayerID,{async:false,callback: function(data){
				if(data != 'null' &&  data != null){
					regDate=data.effectiveDate;
					var serverDateArray = data.effectiveDate.split("/");
					var curdate = new Date(serverDateArray[2],serverDateArray[1],serverDateArray[0]);
					curdate.setMonth(curdate.getMonth() - 1);
					var dd = curdate.getDate();
					if (dd<10) dd= '0'+dd;
					var mm = curdate.getMonth() + 1; // now moths are 1-12
					if (mm<10) mm= '0'+mm;
					regDate=dd+"/"+mm+"/"+curdate.getFullYear();
					document.getElementById('hidEffectiveDt').value=regDate;
				}
			}});
			
			//regDate=parseInt(regDate.substr(6, regDate.length),10);
			
			
		}	
		//END::::Added for DAT 11/2023
		
		//else if((taxHeadValue==IT ||taxHeadValue==VAT ||taxHeadValue==EXCISE) && taxSubHeadValue!=advanceObligationId && paymentTypeValue==SAT)
		else if((taxHeadValue==IT ||taxHeadValue==VAT ||taxHeadValue==EXCISE) && taxSubHeadValue!=advanceObligationId && (paymentTypeValue==SAT ||
				paymentTypeValue==LEGDBT))
		{
			var obligationId=document.getElementById('cmbTaxSubHead').value;
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			if(document.getElementById('isMigrated').value=='Y')
			{
				GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationId,taxPayerID,{async:false,callback: function(data){
					if(data != 'null' &&  data != null){
						var serverDateArray = data.effectiveDate.split("/");
						var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
						
						curdate.setMonth(curdate.getMonth() - 1);
						
						var dd = curdate.getDate();
						if (dd<10) dd= '0'+dd;
						var mm = curdate.getMonth() + 1; // now moths are 1-12
						if (mm<10) mm= '0'+mm;
						regDate=dd+"/"+mm+"/"+curdate.getFullYear();
					}
				}});
			}
			else
			{
				for (var key in obligMap) 
				{
					if(obligationId == key)
					{
						/*var serverDateArray = obligMap[key].split("/");
						var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
						curdate.setMonth(curdate.getMonth() - 1);
						var dd = curdate.getDate();
						if (dd<10) dd= '0'+dd;
						var mm = curdate.getMonth() + 1; // now moths are 1-12
						if (mm<10) mm= '0'+mm;
						regDate=dd+"/"+mm+"/"+curdate.getFullYear();*/
						regDate=obligMap[key];
					}
				}
			}
		}
		if(taxHeadValue==AGENCY_REVENUE)
		{
			if(document.getElementById('cmbTaxSubHead').value==NSSF){
				regDate=document.getElementById('nssfEffDate').value;
				//hard code to be reomoved;
				//regDate="01/01/2013";
			}else if (document.getElementById('cmbTaxSubHead').value==GPBTobligationId)
			{
				var taxPayerID=document.getElementById('hidTaxPayerId').value;
				var obligationID=GPBTobligationId;
				GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationID,taxPayerID,{async:false,callback: function(data){
					if(data != 'null' &&  data != null){
						var serverDateArray = data.effectiveDate.split("/");
						var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
						curdate.setMonth(curdate.getMonth() - 1);
						var dd = curdate.getDate();
						if (dd<10) dd= '0'+dd;
						var mm = curdate.getMonth() + 1; // now moths are 1-12
						if (mm<10) mm= '0'+mm;
						regDate=dd+"/"+mm+"/"+curdate.getFullYear();
						document.getElementById('hidEffectiveDt').value=regDate;
					}
				}});
			}
			 else if (document.getElementById('cmbTaxSubHead').value==housingLevy){
				var taxPayerID=document.getElementById('hidTaxPayerId').value;
				var obligationID=housingLevy;
				GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationID,taxPayerID,{async:false,callback: function(data){
					if(data != 'null' &&  data != null){
						var serverDateArray = data.effectiveDate.split("/");
						var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
						curdate.setMonth(curdate.getMonth());
						var dd = curdate.getDate();
						if (dd<10) dd= '0'+dd;
						var mm = curdate.getMonth() + 1; // now moths are 1-12
						if (mm<10) mm= '0'+mm;
						regDate=dd+"/"+mm+"/"+curdate.getFullYear();
						document.getElementById('hidEffectiveDt').value=regDate;
					}
				}});
			}
			 else if (document.getElementById('cmbTaxSubHead').value==42)
			 {
				var taxPayerID=document.getElementById('hidTaxPayerId').value;
				var obligationID=42;
				GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationID,taxPayerID,{async:false,callback: function(data){
					if(data != 'null' &&  data != null)
					{
						var serverDateArray = data.effectiveDate.split("/");
						var curdate = new Date(serverDateArray[2],serverDateArray[1]-1,serverDateArray[0]);
						curdate.setMonth(curdate.getMonth());
						var dd = curdate.getDate();
						if (dd<10) dd= '0'+dd;
						var mm = curdate.getMonth() + 1; // now moths are 1-12
						if (mm<10) mm= '0'+mm;
						regDate=dd+"/"+mm+"/"+curdate.getFullYear();
						document.getElementById('hidEffectiveDt').value=regDate;
					}
				}});
			}
			//Added for AWWDA :: START
			else if(document.getElementById('cmbTaxSubHead').value==49){
				regDate="01/01/2025";
			}
			//Added for AWWDA :: end
			else
			{
				regDate=document.getElementById('hidEffectiveDt').value;
			}
		}
		if(taxSubHeadValue=='VAT-Withholding')
		{
			var taxPayerID=document.getElementById('hidTaxPayerId').value;
			var obligationID="29";
			GetObligationRollOutDateDtls.getObligationRollOutDateDtls(obligationID,taxPayerID,{async:false,callback: function(data){
				if(data != 'null' &&  data != null){
					regDate=data.effectiveDate;
				}
			}});
		}
		if(taxSubHeadValue==NSSF)
		{
			regDate=obligationRollOutDate;
			//regDate="01/01/2015";

		}
		dwr.util.removeAllOptions(month);
		var oOption = document.createElement("OPTION"); 
		var obligId=document.getElementById("cmbTaxSubHead").value;
		oOption.text="--Month--"; 
		oOption.value="-1"; 
		document.getElementById(month).add(oOption);

		GetSelectedMonthOfSelectedYearWeb.getSelectedMonthOfSelectedYearWeb(regDate,selectedyear,AdvOrCurMonthReq,obligId,{async:false,callback:function(data) {
			if(data!=null){
				if(data.length>=1)
				{
					dwr.util.removeAllOptions(month);
					var oOption = document.createElement("OPTION"); 
					oOption.text="--Month--"; 
					oOption.value="-1"; 
					document.getElementById(month).add(oOption); 
					dwr.util.addOptions(month,data,'fromDate','toDate');
					return true;
				}
			}
		}});

	}
	else
	{
		document.getElementById(month).disabled=true;
		return true;
	}
	document.getElementById('startIndex').value='0';
	var isIntPayReg= document.getElementById("specOblCGTPmtTypeRadio3").value;
	if(modifyFlagTaxOblig != 1 && selectedLiablity!=1 )
	{
		if((document.getElementById('cmbPaymentType').value ==SAT || document.getElementById('cmbPaymentType').value ==VTDP) && document.getElementById("cmbTaxSubHead").value!=TOTFP && (isWithoutLogin == "N" ||isWithoutLogin =="n") && document.getElementById('cmbTaxHead').value ==IT && isIntPayReg!="IPREG" && document.getElementById("cmbTaxSubHead").value!=44 && document.getElementById("cmbTaxSubHead").value!=47)
		{
			fetchTotalLiabilityDetailsWeb(true);
		}
	}
	else
	{
		if(document.getElementById('cmbTaxPeriodMonth').selectedIndex=="-1")
		{
			alert(wrongLiability);
			document.getElementById('cmbTaxPeriodYear').selectedIndex=0;
			document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
			document.getElementById('cmbTaxPeriodMonth').disables=true;
			document.getElementById("liabilityRadio_"+document.getElementById('hidRadioValue').value).checked=false; 
			document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).value = document.getElementById('hidActualLiabilityAmount').value;
			document.getElementById('actualLiabilityAmount_'+ document.getElementById('hidRadioValue').value).readOnly = true;
			document.getElementById('actualLiabilityAmount_'+document.getElementById('hidRadioValue').value).className='readonlyInput form101_textfcurr_width textonlyRight';
			document.getElementById('imgShowIntrest_'+ document.getElementById('hidRadioValue').value).src = "${pageContext.request.contextPath}/themes/kraitms/images/plus-sign.jpg";
			document.getElementById('imgShowIntrest_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
			document.getElementById('imgShowPenalty_'+ document.getElementById('hidRadioValue').value).src = "${pageContext.request.contextPath}/themes/kraitms/images/plus-sign.jpg";
			document.getElementById('imgShowPenalty_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
			document.getElementById('imgShowFine_'+ document.getElementById('hidRadioValue').value).src = "${pageContext.request.contextPath}/themes/kraitms/images/plus-sign.jpg";
			document.getElementById('imgShowFine_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
			document.getElementById('imgShowPayment_'+ document.getElementById('hidRadioValue').value).src = "${pageContext.request.contextPath}/themes/kraitms/images/plus-sign.jpg";
			document.getElementById('imgShowPayment_'+ document.getElementById('hidRadioValue').value).style.visibility = 'hidden';
			selectedLiablity=0;
			return false;
		}
	}
}

function onChangeYearValidation()
{
	
	if(modifyFlagTaxOblig==1)
	{
		alert(canNotChangeTaxPeriod);
		document.getElementById('cmbTaxPeriodYear').value=selectedyear;
		return false;
	}
	else
	{
		return true;
	}
}

function onChangeTaxPeriodValidation(row)
{
	if(modifyFlagTaxOblig==1 &&  (document.getElementById('cmbTaxPeriodMonth').value!=taxPeriodMonth))
	{
		alert(canNotChangeTaxPeriod);
		var obligationId=document.getElementById('cmbTaxSubHead').value;
		if(obligationId==VATCode||obligationId==payeeCode||obligationId==exciseTaxOblCode||obligationId==CGT||obligationId==rentIncomeCode/*||obligationId==amnestyCode*/)
		{
			document.getElementById('cmbTaxPeriodMonth').value=taxPeriodMonth;
			return false;
		}
		else
		{
			document.getElementById('cmbTaxPeriod').value=taxPeriodMonth;
			return false;
		}
	}	
	else
	{
		var checkDuplicateFlag=true;
		if(document.getElementById('cmbPaymentType').value==SAT)
		{
			checkDuplicateFlag = checkDuplicateForObligation(row,'taxObligationTable');
		}
		else if(document.getElementById('cmbPaymentType').value==TAP)
		{
			checkDuplicateFlag = checkDuplicateForObligation(row,'advanceTaxTable');
		}
		if(checkDuplicateFlag==false)
		{
			return false;
		}
		else
		{
			return true;
		}

	}
}
function futureTaxPeriod(row)
{
	var curdate = new Date();
	var curyear = parseInt(curdate.getFullYear(),10);
	var curmonth = parseInt(curdate.getMonth() + 1);
	var selectedMonth=0;
	var idYear=0;
	var idMonth=0;
	if(document.getElementById('cmbPaymentType').value==SAT  || document.getElementById('cmbPaymentType').value==VTDP)
	{
		if(document.getElementById('cmbTaxHead').value==TAX)
		{
			idYear='cmbTaxPeriodYear';
			idMonth='cmbTaxPeriodMonth';
			var checkDuplicateFlag = checkDuplicateForObligation(row,'taxObligationTable');
			if(checkDuplicateFlag==false)
			{
				return false;
			}
		}
		if(document.getElementById('cmbTaxHead').value==OTR)
		{
			idYear='cmbTaxPeriodYearOtr';
			idMonth='cmbOtrPeriod';
			var specObligValue=document.getElementById('cmbSpecOblig').value;
			if(specObligValue==advanceObligationId )
			{
				return false;
			}
		}
		selectedMonth=document.getElementById(idMonth).value.substr(3,2);
		if(document.getElementById(idYear).value==curyear)
		{
			if(selectedMonth>=curmonth)
			{
				alert(advMonth);
				document.getElementById(idMonth).selectedIndex=0;
				if(document.getElementById('cmbTaxHead').value==TAX)
				{ 
					document.getElementById('startIndex').value='0';
					if(isWithoutLogin == "N" || isWithoutLogin == "n")
					{
						fetchTotalLiabilityDetailsWeb(true);
					}
				}
				return false;
			}
			else
			{
				return true;
			}
		}
		else
		{
			return true;
		}
	}
	else if(document.getElementById('cmbPaymentType').value==TAP)
	{
		var checkDuplicateFlag = checkDuplicateForObligation(row,'advanceTaxTable');
		if(checkDuplicateFlag==false)
		{
			return false;
		}
		if(document.getElementById('cmbTaxPeriodYear').value==curyear)
		{
			if(selectedMonth<curmonth)
			{
				alert(invalidMonthYear);
				document.getElementById('txtTotalAmountPaidOblig').readOnly=true;
				document.getElementById('txtTotalAmountPaidOblig').className='readonlyInput form101_textfcurr_width textonlyRight';
				document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
				return false;
			}
			return true;
		}
		else if(document.getElementById('cmbTaxPeriodYear').value==(curyear+1))
		{
			if(selectedMonth>=(curmonth))
			{
				alert(invalidMonthYear);
				document.getElementById('txtTotalAmountPaidOblig').readOnly=true;
				document.getElementById('txtTotalAmountPaidOblig').className='readonlyInput form101_textfcurr_width textonlyRight';
				document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
				return false;
			}
		}
		return true;
	}

}

function clearSpecObligationData()
{
	selectedFlagPartial=0;
	document.getElementById('hidIsPartial').value='N';
	clear_Page_data('withholdeeFormTable','10');
	document.getElementById('hidTaxRateVIS').value=document.getElementById('in_vatOnImpTable_11').value;
	clear_Page_data('vatOnImpTable','10');
	document.getElementById('in_vatOnImpTable_11').value=document.getElementById('hidTaxRateVIS').value;
	document.getElementById('hidTaxRateShipping').value=document.getElementById('in_shippingTaxTable_11').value;
	clear_Page_data('shippingTaxTable','14');
	document.getElementById('in_shippingTaxTable_11').value=document.getElementById('hidTaxRateShipping').value;
	document.getElementById('hidTaxRateCable').value=document.getElementById('in_transmissionTaxTable_9').value;
	clear_Page_data('transmissionTaxTable','7');
	document.getElementById('in_transmissionTaxTable_9').value=document.getElementById('hidTaxRateCable').value;
	document.getElementById('txtWithholdeePinTransmissionTax').value="";
	document.getElementById('txtwithholdeeNameTransmissionTax').value="";
	document.getElementById('taxwithholdeeAddressTransmissionTax').value="";
	document.getElementById('txtTelephoneNoTransmissionTax').value="";
	document.getElementById('in_transmissionTaxTable_3').selectedIndex=0; 
	document.getElementById('in_withholdeeFormTable_8').value="0";
	document.getElementById('in_vatOnImpTable_8').value =0; 
	document.getElementById('in_withholdeeFormTable_9').value =0;
	document.getElementById('in_shippingTaxTable_12').value=0;
	document.getElementById('in_shippingTaxTable_13').value=0;
	clear_table_data("transmissionTaxTable");
	clear_table_data("withholdeeFormTable");
	clear_table_data("shippingTaxTable");
	clear_table_data("vatOnImpTable");
	document.getElementById('in_withholdeeFormTable_6').selectedIndex=0; 
	document.getElementById("checkDisclaimer").checked=false;
	document.getElementById('txtAgencyNo').value="";
	/*document.getElementById('txtTaxPayerPinAgency').value="";
	document.getElementById('txtTaxPayerFirstNameAgency').value="";
	document.getElementById('txtTaxPayerFullAddrAgency').value="";*/
	document.getElementById('withholdeeFormRow1').style.display="";
	document.getElementById('withholdeeFormRow2').style.display="";
	currentPaymentShipping();
//	currentPaymentWithHoldee();
	currentPaymentTransmission();
	currentPaymentVatWithholding();
	//currentPaymentVis();
	hideTab('TabView',5);
	resetErrorList();
	incError=0;
}

function currentPaymentVatWithholding()
{
	if((document.getElementById('hidIsPartial').value != "Y" || document.getElementById('hidIsPartial').value != "y" )&&(selectedFlagPartial==0))
	{
		resetVATWithholdeeInfo();
		clear_table_data("VATWithholdeeFormTable");
		document.getElementById('file').value='';
		document.getElementById('paymentVATWithExcelUploadForm').style.display='none';
		document.getElementById('paymentVATWitholdingWebForm').style.display='none';
		document.getElementById('specOblVATWithPmtTypeRadio1').checked=false;
		document.getElementById('specOblVATWithPmtTypeRadio2').checked=false;
		document.getElementById("paymentSpecVatWithRadio").style.display= 'none';
	}

}
function showTaxObligationSplPartial(data,obligationId)
{
	var pmtSplDetailVOListForPartialTax =  data;
	clearPartialTableForTax();
	if(pmtSplDetailVOListForPartialTax!= null && pmtSplDetailVOListForPartialTax[0].isDataAvailable=="Y"){

		document.getElementById('totalRecordsTdTaxSpl').innerHTML = "Total No. of Records " ;
		document.getElementById('totalRecordsTdTaxSpl').style.textAlign="center";
		document.getElementById('totalRecordsTdTaxSpl').style.fontWeight="bold";
		document.getElementById('totalRecordsTdTaxSpl').innerHTML+=document.getElementById('totalRecords').value;

		document.getElementById('recordsFromToTdTaxSpl').innerHTML = "Records From ";
		document.getElementById('recordsFromToTdTaxSpl').style.textAlign="center";
		document.getElementById('recordsFromToTdTaxSpl').style.fontWeight="bold";
		document.getElementById('recordsFromToTdTaxSpl').innerHTML+=document.getElementById('oldStartIndex').value+"";
		document.getElementById('recordsFromToTdTaxSpl').innerHTML+=" to ";
		document.getElementById('recordsFromToTdTaxSpl').innerHTML+=document.getElementById('endIndex').value;

		document.getElementById('pageNoTdTaxSpl').innerHTML = "Page No. ";
		document.getElementById('pageNoTdTaxSpl').style.textAlign="center";
		document.getElementById('pageNoTdTaxSpl').style.fontWeight="bold";
		document.getElementById('pageNoTdTaxSpl').innerHTML+=document.getElementById('pageNo').value+"";
		document.getElementById('pageNoTdTaxSpl').innerHTML+=" of ";
		document.getElementById('pageNoTdTaxSpl').innerHTML+=document.getElementById('totalPagesId').value;


		if(partialDetailArray.length>0)
		{
			partialDetailArray.length=0;
		}
		for(var i = 0; i< pmtSplDetailVOListForPartialTax.length ; i++){
			var pmtSplDetailVO = pmtSplDetailVOListForPartialTax[i];
			partialDetailArray[i] = pmtSplDetailVO;
		}

		if(obligationId == shippingOblCode)
		{
			showShippingPartialTable(partialDetailArray);
		}
		else if(obligationId == TransmissionOblCode)
		{
			showTransmissionPartialTable(partialDetailArray);
		}
		else if(obligationId == VisOblCode)
		{
			showVisPartialTable(partialDetailArray);
		}
		else  if(obligationId == WithHoldee)
		{
			showWithHoldeePartialTable(partialDetailArray);
		}
		//chnages done for CR Rent Income Witholding
		else  if(obligationId == rentIncomeWith)
		{
			showRentIncomeWithHoldeePartialTable(partialDetailArray);
		}
		//end
		else  if(obligationId == VatWithholding)
		{
			showVatWithHoldeePartialTable(partialDetailArray);
			
		}
		//end
		
		//START:::::Added for DAT - 12/2023
		else  if(obligationId == 45)
		{
			showDATPartialTable(partialDetailArray);
			
		}
		//END:::::Added for DAT - 12/2023
		//START:::::Added for DST - 09/2024
		else  if(obligationId == 44)
		{
			showDSTPartialTable(partialDetailArray);
			
		}
		//END:::::Added for DST - 09/2024
		//START::Added for SEP - #81171
		else  if(obligationId == 47)
		{
			showSEPPartialTable(partialDetailArray);
			
		}
		//END:::Added for SEP - #81171
		else
		{
			alert(validObligation);
			return false;
		}
	}

	document.getElementById('txtAgencyNo').value="";
	/*document.getElementById('txtTaxPayerPinAgency').value="";
	document.getElementById('txtTaxPayerFirstNameAgency').value="";
	document.getElementById('txtTaxPayerFullAddrAgency').value="";*/
	hideTab('TabView',5);
	resetErrorList();
	incError=0;

}
function showDSTPartialTable(partialDetailArray){
	if(partialDetailArray.length>=1){
		//document.getElementById('paymentRentIncomeWithWebForm').style.display="";
		
		document.getElementById('navigationLegend').innerHTML = PreviousLiabilityDetails ;
		/*document.getElementById("rentIncomeWithWebFormLiablibilityTbl").style.display = "";*/
		document.getElementById("taxDSTLiablibilityTbl").style.display = "";
		var cntr = 0;
		/*var tabObj = document.getElementById("rentIncomeWithWebFormLiablibilityTbl");*/
		var tabObj = document.getElementById("taxDSTLiablibilityTbl");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		for(var i=0;i<partialDetailArray.length;i++){
			cntr = parseInt(cntr);
			var tabRow = tabObj.insertRow(tabObj.rows.length);
//			tabRow.id="rentIncomeWithHoldeeWebHdrRow_"+cntr;
			tabRow.id="taxDSTLiablibilityTblWebHdrRow_"+cntr;
			var tabCell = new Array();
			for (var j=0;j<8;j++){
				tabCell[j] = tabRow.insertCell(j);
			}
			var pmtSplDetailVO = partialDetailArray[i];
		
			var element = document.createElement('input');       
			element.type ='radio';
			//added for allowing partial payment
			element.onclick = function () {onSelectTaxDSTLiablibilityHdrRadio(this);};
			element.value = cntr;
//			element.id = 'rentIncomeWithHoldeeWebFormRadio_'+cntr;
//			element.name = "rentIncomeWithHoldeeWebFormRadio";
//			element.className='bordercl rentincomewhtradio';
			
			element.id = 'taxDSTLiablibilityTblWebFormRadio_'+cntr;
			element.name = "taxDSTLiablibilityTblWebFormRadio";
			element.className='bordercl rentincomewhtradio';
			
			tabCell[0].appendChild(element); 


			tabCell[1].innerHTML = pmtSplDetailVO.taxPeriod;
			tabCell[1].style.textAlign="center";
			tabCell[1].style.fontSize="11";

			tabCell[2].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualFineAmount).toFixed(2),true);
			tabCell[2].style.textAlign="right";
			tabCell[2].style.fontSize="11";


			tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPenaltyAmount).toFixed(2),true);
			tabCell[3].style.textAlign="right";
			tabCell[3].style.fontSize="11";

			tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualInterestAmount).toFixed(2),true);
			tabCell[4].style.textAlign="right";
			tabCell[4].style.fontSize="11";

			tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			tabCell[5].style.textAlign="right";
			tabCell[5].style.fontSize="11";
			//added for suggestion for allowing partial payment
			var elementtext = document.createElement("input");
			elementtext.type="text";
			elementtext.name="actualLiabilityamount_"+cntr;
			elementtext.id="actualLiabilityamount_"+cntr;
			elementtext.onchange=function() {onChangeAmtToBePaidDAT(this);};
			elementtext.setAttribute("value", convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true));
			elementtext.setAttribute("readOnly", "readOnly");
			
			//tabCell[6].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			elementtext.setAttribute("readOnly", "readOnly");
			elementtext.className='readonlyInput form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
			elementtext.setAttribute('maxlength', 15);
			elementtext.style.textAlign = 'right'; 
			tabCell[6].appendChild(elementtext);
			tabCell[6].style.textAlign="right";
			tabCell[6].style.fontSize="11";
			//end
			var element = document.createElement('input');
     		element.type = 'hidden';
   			element.value =  convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPrincipalAmount).toFixed(2),true);
   			element.width = "0%";
   			tabCell[7].appendChild(element);
   			tabCell[7].style.display = "none";
   			
			cntr = cntr+1;
		}
		document.getElementById("navigationFieldset").style.display = "";
		document.getElementById("navigationTableTaxSpl").style.display = "";
		document.getElementById('taxDSTLiablibilityWebFormTable').style.display = 'none';
		document.getElementById("taxDSTLiablibilityWebFormAddRowTable").style.display = "none";
		//document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
		document.getElementById('paymentRegDTSTaxFieldSet').style.display="";
		document.getElementById('hidNavigationFlag').value = "6";
		validatePaginationLastTaxSpl();
		validatePaginationFirstTaxSpl();
		
	}
}
function clearNevigationData()
{
	document.getElementById('startIndex').value 		= "";
	document.getElementById('endIndex').value 			= "";
	document.getElementById('pageNo').value 			= "";
	document.getElementById('totalRecords').value 		= "";
	document.getElementById('totalPagesId').value 		= "";
	document.getElementById('recordsPerPage').value 	= "";
	document.getElementById('startIndexUpdate').value 	= "";
	document.getElementById('oldStartIndex').value 		= "";
	document.getElementById('lastStartIndex').value 	= "";
	document.getElementById('maxResult').value 			= "";

}
function validatePaginationLastTaxSpl()
{
	if(document.getElementById('pageNo').value==document.getElementById('totalPagesId').value)
	{
		document.getElementById('nextLinkTaxSpl').style.display = 'none';
		document.getElementById('lastLinkTaxSpl').style.display = 'none';

		document.getElementById('nextLinkTdTaxSpl').style.display = 'none';
		document.getElementById('lastLinkTdTaxSpl').style.display = 'none';

	}
	else
	{
		document.getElementById('nextLinkTaxSpl').style.display = '';
		document.getElementById('lastLinkTaxSpl').style.display = '';

		document.getElementById('nextLinkTdTaxSpl').style.display = '';
		document.getElementById('lastLinkTdTaxSpl').style.display = '';
	}
	
}
function validatePaginationFirstTaxSpl()
{
	if(document.getElementById('pageNo').value=="1")
	{
		document.getElementById('firstLinkTaxSpl').style.display = 'none';
		document.getElementById('previousLinkTaxSpl').style.display = 'none';

		document.getElementById('firstLinkTdTaxSpl').style.display = 'none';
		document.getElementById('previousLinkTdTaxSpl').style.display = 'none';
	}
	else
	{
		document.getElementById('firstLinkTaxSpl').style.display = '';
		document.getElementById('previousLinkTaxSpl').style.display = '';

		document.getElementById('firstLinkTdTaxSpl').style.display = '';
		document.getElementById('previousLinkTdTaxSpl').style.display = '';
	}

}

function validateTaxTypeDtls(id)
{
	if(document.getElementById('cmbTaxSubHead').value == selectOblCode || document.getElementById('cmbTaxSubHead').value == "")
	{
		alert(validObligation);
		document.getElementById('cmbTaxSubHead').selectedIndex=taxObligation;
	}
	var rtnFlag = validateFormFieldOnEvent(id, paymentRegTaxDetailsJson);
	getErrTabToggle('TabView','2');
	if(!rtnFlag)
	{
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}
	return rtnFlag;
}
function validateTaxPayDtls(id)
{
	var rtnFlag = validateFormFieldOnEvent(id, paymentRegTaxObligPaymentDetailsJson);
	getErrTabToggle('TabView','2');
	if(!rtnFlag)
	{
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}
	return rtnFlag;

}
function validateTaxPeriodYearlyDtls(id)
{
	var rtnFlag = validateFormFieldOnEvent(id, paymentRegTaxPeriodDetailsJson);
	getErrTabToggle('TabView','2');
	if(!rtnFlag)
	{
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}
	return rtnFlag;
}
function validateTaxPeriodMonthlyDtls(id)
{
	var rtnFlag = validateFormFieldOnEvent(id, paymentRegTaxPeriodMonthlyDetailsJson);
	getErrTabToggle('TabView','2');
	if(!rtnFlag)
	{
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}
	return rtnFlag;
}
function clearTaxObligForm(flag)
{

	{
		var x;
		if(flag=='y')
		{
			x = confirm ("Do You want to Clear the Data?");
		}
		else
		{
			x=true;
		}
		if(x)
		{
			requiredFieldsAfterCleaer();
			clear_table_data("taxObligationTable");
			clear_table_data("advanceTaxTable");
			document.getElementById("cmbTaxHead").selectedIndex=0;
			document.getElementById('ObligationDetailFieldSet').style.display = 'none'; 
			document.getElementById('paymentRTGSFieldSet').style.display = 'none'; 
			document.getElementById('navigationTable').style.display = 'none';
			document.getElementById('LiablibilityTbl').style.display = 'none';
			document.getElementById('cmbTaxPeriod').options.length = 1;
			document.getElementById('paymentRegTransmissionTaxFieldSet').style.display ='none';
			document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
			//Added for DAT - 11/2023
			document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
			document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
			document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
			document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
			document.getElementById('paymentRegAgencyNoticeSet').style.display ='none';
			document.getElementById('TotalTaxFieldSet').style.display = 'none';
			document.getElementById('disclaimerFieldSet').style.display = 'none';
			clear_table_data("transmissionTaxTable");
			clear_table_data("withholdeeFormTable");
			clear_table_data("shippingTaxTable");
			clear_table_data("vatOnImpTable");
			clear_table_data("rentIncomeWithTable");
			clear_table_data("rentIncomeWithholdeeWebFormTable");
			document.getElementById("checkDisclaimer").checked=false;
			rowNumbmerPartial=0;
			selectedFlagPartial=0;
			resetErrorList();
			selectedFlagTaxOblig=0;
			selectedFlagShipping =0;
			selectedFlagCable=0;
			selectedFlagVis =0;
			selectedFlagWithHoldee=0;
			modifyFlagWithHoldee=0;
			modifyFlagTaxOblig=0;
			commonModifyFlag=0;
			modifyFlagVis=0;
			modifyFlagCable=0;
			modifyFlagShipping=0;
			selectedFlagInstallment=0;
			modifyFlagInstallment=0;
			selectedFlagAdvanceTax=0;
			modifyFlagAdvanceTax=0;
			selectedFlagNSSF=0;
			modifyFlagNSSF=0;
			deleteFlagNSSF=0;
			incError=0;
			selectedFlagRentIncomeWithHoldee=0;
			modifyFlagRentIncomeWithHoldee=0;
			document.getElementById('paymentTaxObligForm').style.display='none';
			document.getElementById('paymentRegSpecObligationForm').style.display='none';
			document.getElementById('paymentRegNTRForm').style.display='none';
			document.getElementById('totalAmountPaidFieldSet').style.display='none';
			//changes done for CR Rent Income Withholding
			/*document.getElementById("rentIncomeWithRadio1").checked=false;
			document.getElementById("rentIncomeWithRadio2").checked=false;*/
			document.getElementById("paymentRentIncomeWithRadioForm").style.display="none";
			document.getElementById("paymentRentIncomeWithWebForm").style.display="none";
			document.getElementById("paymentRentIncomeWithRegForm").style.display="none";
			document.getElementById("paymentRentIncomeWithExcelUploadForm").style.display="none";
			
			
				
			//end
			return true;
		}
		else
		{
			return false;
		}	
	}
}
function checkNssfAmount()
{
	if(document.getElementById('cmbTaxSubHead').value==NSSF)	
	{
		var i=document.getElementById('hidRadioValue').value;
		var principaltAmt=0;
		i=parseInt(i,10)+parseInt(1,10);
		principaltAmt =removeCommaFrmInput(document.getElementById('hidActualLiabilityAmount').value);
		var amt=removeCommaFrmInput(document.getElementById('actualLiabilityAmount_'+document.getElementById('hidRadioValue').value).value );
		if(principaltAmt==0){
			return true;
		}
		else if(parseFloat(amt)>parseFloat(principaltAmt))
		{
			alert(amtPayee);
			document.getElementById('actualLiabilityAmount_'+document.getElementById('hidRadioValue').value).value=document.getElementById('hidActualLiabilityAmount').value;
			return true;
		}
		else
		{
			return true;
		}

	}
	else if(document.getElementById('cmbTaxSubHead').value==exciseTaxOblCode)	
	{			
		if(document.getElementById("taxPayerRegWith").value==both)
		{
			var i=document.getElementById('hidRadioValue').value;
			var tabObj1=document.getElementById("LiablibilityTbl");
			i=parseInt(i,10)+parseInt(1,10);
			var principaltAmt=Math.ceil(parseFloat(removeCommaFrmInput(tabObj1.rows[i].cells[2].innerText)),10);
			var amt=removeCommaFrmInput(document.getElementById('actualLiabilityAmount_'+document.getElementById('hidRadioValue').value).value );
			if(amt<principaltAmt)
			{
				alert("Amount to be paid should be equal or greater than Principal Tax.");
				document.getElementById('actualLiabilityAmount_'+document.getElementById('hidRadioValue').value).value=principaltAmt;
				return true;
			}
			else
			{
				return true;
			}
		}
		else
		{
			return true ;
		}
	}

	else{
		return true;
	}
}


function paymentRegFormSubmitForm(actionCode)
{
	document.getElementById('cmdSaveOblig').disabled=true;
	document.getElementById('cmdClearOblig').disabled=true;
	document.getElementById('back').disabled=true;
	document.paymentRegForm.action="paymentRegistration.htm?actionCode="+actionCode;
	document.paymentRegForm.submit();
}


function errorPage()
{

	getErrTabToggle('TabView','2');	
	tabview_switch('TabView', '2');
	hideAndShowTable("errorDiv");
	document.getElementById('btnTbl').style.display="none";

	}
//Added By miral for CGT int pay reg :: START
function showInterestForm(){
	document.getElementById('paymentRegAcknowledgmentForm').style.display ='none';
	document.getElementById("cgtTabViewSet").style.display="none";
	document.getElementById("penaltyPaymentCgt").style.display="none";
	document.getElementById("interestPaymentCgt").style.display="block";
	document.getElementById("specOblCGTPmtTypeRadio3").value="IPREG";
	document.getElementById("specOblCGTPmtTypeRadio2").value=null;
	document.getElementById("specOblCGTPmtTypeRadio1").value=null;
	document.getElementById("specOblCGTPmtTypeRadio4").value=null;
	dwr.util.removeAllOptions('periodYear'); 
	GetYearFromEffetciveYear('periodYear');
	
}
//Added for Penalty payment registration
function showPenaltyForm(){
	document.getElementById('paymentRegAcknowledgmentForm').style.display ='none';
	document.getElementById("cgtTabViewSet").style.display="none";
	document.getElementById("penaltyPaymentCgt").style.display="block";
	document.getElementById("interestPaymentCgt").style.display="none";

	document.getElementById("specOblCGTPmtTypeRadio3").value=null;
	document.getElementById("specOblCGTPmtTypeRadio2").value=null;
	document.getElementById("specOblCGTPmtTypeRadio1").value=null;
	document.getElementById("specOblCGTPmtTypeRadio4").value="PPREG";
	dwr.util.removeAllOptions('periodYearPenaltyCGT'); 
	GetYearFromEffetciveYear('periodYearPenaltyCGT');
	
}

function onChangeCmbYearIntPayReg()
{

	
	if(onChangeYearValidation())
	{
		var isIntPayReg= document.getElementById("specOblCGTPmtTypeRadio3").value;
		var taxHeadValue=document.getElementById("cmbTaxHead").value;
		var paymentTypeValue=document.getElementById("cmbPaymentType").value;
		var taxSubHeadValue=document.getElementById("cmbTaxSubHead").value;
		var year =document.getElementById("periodYear").value;
		var taxPayerPin=document.getElementById('initialLoginPin').value;
		
		if(taxHeadValue==IT && taxSubHeadValue==CGT && paymentTypeValue==SAT && isIntPayReg=="IPREG")
			{
		    	GetMonthsForVatWithholding.getMonthsForVatWithholding(year,
		    			taxPayerPin,taxSubHeadValue, {async:false,callback:function(data){
						if(data!=null){
							if(data.length>=1)
							{
								dwr.util.removeAllOptions(document.getElementById("periodMonth"));
								var oOption = document.createElement("OPTION"); 
								oOption.text="--Month--"; 
								oOption.value="-1"; 
								document.getElementById("periodMonth").add(oOption); 
								dwr.util.addOptions(document.getElementById("periodMonth"),data,'fromDate','toDate');
								return true;
							}
						}
						else{
							alert("error fetching data.");
						}
				}});
			}
	}
}

//Added By miral for CGT int pay reg :: END

//Added for penalty payment registration for CGT:: Start
function onChangeCmbYearPenaltyPayReg()
{

	
	if(onChangeYearValidation())
	{
		var isIntPayReg= document.getElementById("specOblCGTPmtTypeRadio4").value;
		var taxHeadValue=document.getElementById("cmbTaxHead").value;
		var paymentTypeValue=document.getElementById("cmbPaymentType").value;
		var taxSubHeadValue=document.getElementById("cmbTaxSubHead").value;
		var year =document.getElementById("periodYearPenaltyCGT").value;
		var taxPayerPin=document.getElementById('initialLoginPin').value;
		
		if(taxHeadValue==IT && taxSubHeadValue==CGT && paymentTypeValue==SAT && isIntPayReg=="PPREG")
			{
		    	GetMonthsForVatWithholding.getMonthsForVatWithholding(year,
		    			taxPayerPin,taxSubHeadValue, {async:false,callback:function(data){
						if(data!=null){
							if(data.length>=1)
							{
								dwr.util.removeAllOptions(document.getElementById("periodMonthPenaltyCGT"));
								var oOption = document.createElement("OPTION"); 
								oOption.text="--Month--"; 
								oOption.value="-1"; 
								document.getElementById("periodMonthPenaltyCGT").add(oOption); 
								dwr.util.addOptions(document.getElementById("periodMonthPenaltyCGT"),data,'fromDate','toDate');
								return true;
							}
						}
						else{
							alert("error fetching data.");
						}
				}});
			}
	}
}
//Added for penalty payment registration for CGT:: End
function showVatWithHoldeePartialTable(partialDetailArray){
	if(partialDetailArray.length>=1){
		document.getElementById('paymentVatWithWebForm').style.display="";
		
		document.getElementById('navigationLegend').innerHTML = PreviousLiabilityDetails ;
		document.getElementById("vatWithWebFormLiablibilityTbl").style.display = "";
		var cntr = 0;
		var tabObj = document.getElementById("vatWithWebFormLiablibilityTbl");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		for(var i=0;i<partialDetailArray.length;i++){
			cntr = parseInt(cntr);
			var tabRow = tabObj.insertRow(tabObj.rows.length);
			tabRow.id="vatWithHoldeeWebHdrRow_"+cntr;
			var tabCell = new Array();
			for (var j=0;j<8;j++){
				tabCell[j] = tabRow.insertCell(j);
			}
			var pmtSplDetailVO = partialDetailArray[i];
		
			var element = document.createElement('input');       
			element.type ='radio';
			//added for allowing partial payment
			element.onclick = function () {onSelectVatWithHoldeeHdrRadio(this);};
			element.value = cntr;
			element.id = 'vatWithHoldeeWebFormRadio_'+cntr;
			element.name = "vatWithHoldeeWebFormRadio";
			element.className='bordercl rentincomewhtradio';
			
			tabCell[0].appendChild(element); 


			tabCell[1].innerHTML = pmtSplDetailVO.taxPeriod;
			tabCell[1].style.textAlign="center";
			tabCell[1].style.fontSize="11";

			tabCell[2].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualFineAmount).toFixed(2),true);
			tabCell[2].style.textAlign="right";
			tabCell[2].style.fontSize="11";


			tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPenaltyAmount).toFixed(2),true);
			tabCell[3].style.textAlign="right";
			tabCell[3].style.fontSize="11";

			tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualInterestAmount).toFixed(2),true);
			tabCell[4].style.textAlign="right";
			tabCell[4].style.fontSize="11";

			tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			tabCell[5].style.textAlign="right";
			tabCell[5].style.fontSize="11";
			//added for suggestion for allowing partial payment
			var elementtext = document.createElement("input");
			elementtext.type="text";
			elementtext.name="actualLiabilityamount_"+cntr;
			elementtext.id="actualLiabilityamount_"+cntr;
			elementtext.onchange=function() {onChangeAmtToBePaidVATWht(this);};
			elementtext.setAttribute("value", convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true));
			
			//tabCell[6].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			elementtext.setAttribute("readOnly", "readOnly");
			elementtext.className='readonlyInput form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
			elementtext.setAttribute('maxlength', 15);
			elementtext.style.textAlign = 'right'; 
			tabCell[6].appendChild(elementtext);
			tabCell[6].style.textAlign="right";
			tabCell[6].style.fontSize="11";
			//end
			var element = document.createElement('input');
     		element.type = 'hidden';
   			element.value =  convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPrincipalAmount).toFixed(2),true);
   			element.width = "0%";
   			tabCell[7].appendChild(element);
   			tabCell[7].style.display = "none";
   			
			cntr = cntr+1;
		}
		document.getElementById("navigationFieldset").style.display = "";
		document.getElementById("vatWithWebFormLiablibilityTbl").style.display = "";
		document.getElementById("navigationTableTaxSpl").style.display = "";
		document.getElementById('vatWithholdeeWebFormTable').style.display = 'none';
		document.getElementById("vatWithholdeeWebFormAddRowTable").style.display = "none";
		document.getElementById('hidNavigationFlag').value = "6";
		validatePaginationLastTaxSpl();
		validatePaginationFirstTaxSpl();
	}
}
function beforeAddWebVatWithHoldeeTable()
{
	ItAmnt=removeCommaFrmInput(document.getElementById('in_vatWithholdeeWebFormTable_5').value);
	TotalAmnt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
}
function afterAddWebVatWithHoldeeTable()
{
	TotalAmnt=convertToKenyanShillingFormatVal(parseInt(ItAmnt,10)+parseInt(TotalAmnt,10),true);
	document.getElementById('txtTotalAmountPaidOblig').value=TotalAmnt;
	//added for suggestion for allowing partial payment
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	
}
function afterDeleteWebVatWithHoldeeTable(rowno)
{var table = document.getElementById('vatWithholdeeWebFormTable');  
var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
var tempAmt = table.rows[rowno].cells[5].innerHTML;
totalAmt = totalAmt - parseFloat(removeCommaFrmInput(tempAmt),"10");
document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
	
}
function beforeDeleteWebVatWithHoldeeTable()
{
	
}
function afterModifyWebVatWithHoldeeTable()
{
	var table = document.getElementById('vatWithholdeeWebFormTable');
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var newAmt=table.rows[rowno].cells[5].innerHTML;
	var newAmountArray=newAmt.split('<');
	newAmt=newAmountArray[0];
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(newAmt),"10")-parseInt(removeCommaFrmInput(ItAmnt),10),true); 
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true;
	//added for suggestion for allowing partial payment
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
}
function beforeModifyWebRentIncomeWithHoldeeTable(row)
{	isModifyActive=false;
	if(checkDuplicateRowsForWebVatWithholdee()){
		rowno=row;
		var table = document.getElementById('vatWithholdeeWebFormTable');
		ItAmnt=table.rows[rowno].cells[5].innerHTML;
		var amtToPaidWithHoldeeArray=ItAmnt.split('<');
		ItAmnt=amtToPaidWithHoldeeArray[0];
	}
	else {
		return false;
	}
	
}
function checkDuplicateRowsForWebVatWithholdee()
{
	var table = document.getElementById('vatWithholdeeWebFormTable');
	var amt = document.getElementById('in_vatWithholdeeWebFormTable_4').value;
	var taxPeriod= document.getElementById('in_vatWithholdeeWebFormTable_3').value;
	if(amt =="" || amt==null|| taxPeriod=="" || taxPeriod==null){
		alert("Please select a row to be added first.");
		return false;
	}
		if(!(table.rows.length==1))
		{ 	
			for (var i = 1, n = table.rows.length; i <n; i++) 
			{ 
				modify=trim(table.rows[i].cells[2].getElementsByTagName('A')[0].innerHTML);
				if((trim(document.getElementById('id_temp_'+'vatWithholdeeWebFormTable'+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&
					(table.rows[i].cells[3].innerHTML==taxPeriod))
				{
					alert("You already added this details.");
					return false;
				}
			}
		}
		return true;
}
function onSelectVatWithHoldeeHdrRadio(obj)
{	//added for allowing partial payment
	
	var rowNum = obj.value;
	var currentId=document.getElementById('vatWithHoldeeWebFormRadio_'+rowNum);
	if(!(currentId == modifyId)){
	if(isModifyActive==true){
		alert("Please complete modify action.");
		document.getElementById('vatWithHoldeeWebFormRadio_'+rowNum).checked=false;
		modifyId.checked=true;
		return false;
	}
	}
	
	document.getElementById('vatWithholdeeWebFormTable').style.display = '';
	document.getElementById("vatWithholdeeWebFormAddRowTable").style.display = "";
	document.getElementById("vatWithWebFormLiablibilityTbl").style.display = "";
	
	document.getElementById('paymentVATWitholdingWebForm').style.display = 'none';
	
	
	var rowNum = obj.value;
	objValue=obj.value;		
	
	rowNumbmerPartial=obj.value;
	//added for suggestion for allowing partial payment
	//document.getElementsByName('actualLiabilityamount').readOnly = true;
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	if(document.getElementById('cmbTaxSubHead').value!=NSSF && document.getElementById('cmbTaxSubHead').value!=amnestyCode)
	{
		document.getElementById('actualLiabilityamount_'+objValue).readOnly = false;
		document.getElementById('actualLiabilityamount_'+objValue).className='form101_textfcurr form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
	}
	
	//end
	
	if(selectedFlagRentIncomeWithHoldee>0 && document.getElementById('hidIsPartial').value != "Y")
	{
		alert(cntAddPrevLiab);
		document.getElementById('vatWithHoldeeWebHdrRow_'+rowNumbmerPartial).checked=false;
	}
	else
	{
		var taxPayerId=document.getElementById('hidTaxPayerId').value;
		var rowNum = obj.value;
		objValue=obj.value;
		var rowRef = document.getElementById("vatWithHoldeeWebHdrRow_" + rowNum);
				
		startIndexStr=parseInt(document.getElementById('startIndexUpdate').value);
		
		var principalAmount = rowRef.getElementsByTagName("input")[2].value;
		
		if (removeCommaFrmInput(principalAmount) > 0){
			
			alert ("Principal amount is pending for this period . Please make Payment of the Principal amount first.");
			if(document.getElementById('vatWithholdeeWebFormTable').rows.length>1)
			{
				document.getElementById('paymentVATWitholdingWebForm').style.display = 'none';
			}
			else
			{
				document.getElementById('paymentVATWitholdingWebForm').style.display = '';
				document.getElementById('paymentVatWithWebForm').style.display = 'none';
				clear_table_data('VATWithholdeeFormTable');
			}
			rowRef.getElementsByTagName("input")[0].checked= false ;
			return false ;
		}
		else {
			var taxPeriodDisp = rowRef.getElementsByTagName("TD")[1].textContent;
			//Added by Mingu for Amnesty Enhancement :: START
			var taxPeriodDispArray = taxPeriodDisp.split(" ");
			var yearStr = taxPeriodDispArray[1];
			var yearInt = parseInt(yearStr);
			//13/08/2024commented to open after amnesty period ended::START
			/*if(yearInt<=2022){
				alert("You cannot pay the Penalty and Interest for periods before January 2023.");
				rowRef.getElementsByTagName("input")[0].checked= false ;
				return false;
			}*/
			//13/08/2024commented to open after amnesty period ended ::END
			//Added by Mingu for Amnesty Enhancement :: END
			document.getElementById("hidTaxPeriod").value=taxPeriodDisp;
			document.getElementById("in_vatWithholdeeWebFormTable_3").value=taxPeriodDisp;

			var obligationId=document.getElementById('cmbTaxSubHead').value;
		
			var taxPayable = rowRef.getElementsByTagName("TD")[5].textContent;			
			taxPayable=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(taxPayable),10).toFixed(2),true);				
			document.getElementById("in_vatWithholdeeWebFormTable_4").value=taxPayable;

			var amountPaid = (rowRef.getElementsByTagName("input")[1].value);
			amountPaid=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(amountPaid),10).toFixed(2),true);
			document.getElementById("in_vatWithholdeeWebFormTable_5").value=amountPaid;
		}
	

	}

}

function onChangeAmtToBePaidVATWht(obj){
	
	var arr=obj.id.split("_");
	var row=arr[1];
	var rowRef = document.getElementById("vatWithHoldeeWebHdrRow_" + row);
	var amtPayable = rowRef.getElementsByTagName("TD")[5].textContent;
	amtPayable=parseInt(removeCommaFrmInput(amtPayable),10).toFixed(2);
	if(parseInt(obj.value)<0 || parseInt(obj.value)>parseInt(amtPayable)){
		alert("Amount to be paid should be greater than 0 and less than amount payable");
		obj.value=amtPayable;
		return false;
	}
	document.getElementById("in_vatWithholdeeWebFormTable_5").value=obj.value;
	return true;
	
}

function addWebVatWithHoldeeData(){
	resetErrorList();	
	if(addConfirm('a_vatWithholdeeWebFormTable'))
	{
		if(checkDuplicateRowsForWebVatWithholdee())
		{
			if(document.getElementById('a_vatWithholdeeWebFormTable').innerHTML!="Modify")
			{			
				addrow('vatWithholdeeWebFormTable', '3', '3','5','','','N','N');
				document.getElementById('totalAmountPaidFieldSet').style.display='';
				

			}
			else
			{
				return true;
			}
		}
		
	}
	else{
		isFalse=1;
	}

}



function showDATPartialTable(partialDetailArray){
	if(partialDetailArray.length>=1){
		//document.getElementById('paymentRentIncomeWithWebForm').style.display="";
		
		document.getElementById('navigationLegend').innerHTML = PreviousLiabilityDetails ;
		/*document.getElementById("rentIncomeWithWebFormLiablibilityTbl").style.display = "";*/
		document.getElementById("taxDATLiablibilityTbl").style.display = "";
		var cntr = 0;
		/*var tabObj = document.getElementById("rentIncomeWithWebFormLiablibilityTbl");*/
		var tabObj = document.getElementById("taxDATLiablibilityTbl");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		for(var i=0;i<partialDetailArray.length;i++){
			cntr = parseInt(cntr);
			var tabRow = tabObj.insertRow(tabObj.rows.length);
//			tabRow.id="rentIncomeWithHoldeeWebHdrRow_"+cntr;
			tabRow.id="taxDATLiablibilityTblWebHdrRow_"+cntr;
			var tabCell = new Array();
			for (var j=0;j<8;j++){
				tabCell[j] = tabRow.insertCell(j);
			}
			var pmtSplDetailVO = partialDetailArray[i];
		
			var element = document.createElement('input');       
			element.type ='radio';
			//added for allowing partial payment
			element.onclick = function () {onSelectTaxDATLiablibilityHdrRadio(this);};
			element.value = cntr;
//			element.id = 'rentIncomeWithHoldeeWebFormRadio_'+cntr;
//			element.name = "rentIncomeWithHoldeeWebFormRadio";
//			element.className='bordercl rentincomewhtradio';
			
			element.id = 'taxDATLiablibilityTblWebFormRadio_'+cntr;
			element.name = "taxDATLiablibilityTblWebFormRadio";
			element.className='bordercl rentincomewhtradio';
			
			tabCell[0].appendChild(element); 


			tabCell[1].innerHTML = pmtSplDetailVO.taxPeriod;
			tabCell[1].style.textAlign="center";
			tabCell[1].style.fontSize="11";

			tabCell[2].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualFineAmount).toFixed(2),true);
			tabCell[2].style.textAlign="right";
			tabCell[2].style.fontSize="11";


			tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPenaltyAmount).toFixed(2),true);
			tabCell[3].style.textAlign="right";
			tabCell[3].style.fontSize="11";

			tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualInterestAmount).toFixed(2),true);
			tabCell[4].style.textAlign="right";
			tabCell[4].style.fontSize="11";

			tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			tabCell[5].style.textAlign="right";
			tabCell[5].style.fontSize="11";
			//added for suggestion for allowing partial payment
			var elementtext = document.createElement("input");
			elementtext.type="text";
			elementtext.name="actualLiabilityamount_"+cntr;
			elementtext.id="actualLiabilityamount_"+cntr;
			elementtext.onchange=function() {onChangeAmtToBePaidDAT(this);};
			elementtext.setAttribute("value", convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true));
			elementtext.setAttribute("readOnly", "readOnly");
			
			//tabCell[6].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			elementtext.setAttribute("readOnly", "readOnly");
			elementtext.className='readonlyInput form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
			elementtext.setAttribute('maxlength', 15);
			elementtext.style.textAlign = 'right'; 
			tabCell[6].appendChild(elementtext);
			tabCell[6].style.textAlign="right";
			tabCell[6].style.fontSize="11";
			//end
			var element = document.createElement('input');
     		element.type = 'hidden';
   			element.value =  convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPrincipalAmount).toFixed(2),true);
   			element.width = "0%";
   			tabCell[7].appendChild(element);
   			tabCell[7].style.display = "none";
   			
			cntr = cntr+1;
		}
		document.getElementById("navigationFieldset").style.display = "";
		document.getElementById("taxDATLiablibilityTbl").style.display = "";
		document.getElementById("navigationTableTaxSpl").style.display = "";
		document.getElementById('taxDATLiablibilityWebFormTable').style.display = 'none';
		document.getElementById("taxDATLiablibilityWebFormAddRowTable").style.display = "none";
		//document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
		document.getElementById('paymentRegDATTaxFieldSet').style.display="";
		document.getElementById('hidNavigationFlag').value = "6";
		validatePaginationLastTaxSpl();
		validatePaginationFirstTaxSpl();
		
	}
}


function onSelectTaxDATLiablibilityHdrRadio(obj)
{	//added for allowing partial payment
	
	var rowNum = obj.value;
	var currentId=document.getElementById('taxDATLiablibilityTblWebHdrRow_'+rowNum);
	if(!(currentId == modifyId)){
	if(isModifyActive==true){
		alert("Please complete modify action.");
		document.getElementById('taxDATLiablibilityTblWebHdrRow_'+rowNum).checked=false;
		modifyId.checked=true;
		return false;
	}
	}
	
//	document.getElementById('rentIncomeWithholdeeWebFormTable').style.display = '';
//	document.getElementById("rentIncomeWithholdeeWebFormAddRowTable").style.display = "";
//	document.getElementById("rentIncomeWithWebFormLiablibilityTbl").style.display = "";
	//document.getElementById('paymentRentIncomeWithRegForm').style.display = 'none';
	
	document.getElementById("taxDATLiablibilityTbl").style.display = "";
	document.getElementById("taxDATLiablibilityWebFormTable").style.display = "";
	document.getElementById("taxDATLiablibilityWebFormAddRowTable").style.display = "";
	
	document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
	document.getElementById("txtTotalAmountPaidOblig").value = "0";

	
	
	
	var rowNum = obj.value;
	objValue=obj.value;		
	
	rowNumbmerPartial=obj.value;
	//added for suggestion for allowing partial payment
	//document.getElementsByName('actualLiabilityamount').readOnly = true;
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	if(document.getElementById('cmbTaxSubHead').value!=NSSF && document.getElementById('cmbTaxSubHead').value!=amnestyCode)
	{
		document.getElementById('actualLiabilityamount_'+objValue).readOnly = false;
		document.getElementById('actualLiabilityamount_'+objValue).className='form101_textfcurr form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
	}
	
	//end
	
	if(selectedFlagRentIncomeWithHoldee>0 && document.getElementById('hidIsPartial').value != "Y")
	{
		alert(cntAddPrevLiab);
		document.getElementById('taxDATLiablibilityTblWebHdrRow_'+rowNumbmerPartial).checked=false;
	}
	else
	{
		var taxPayerId=document.getElementById('hidTaxPayerId').value;
		var rowNum = obj.value;
		objValue=obj.value;
		//var rowRef = document.getElementById("rentIncomeWithHoldeeWebHdrRow_" + rowNum);
		var rowRef = document.getElementById("taxDATLiablibilityTblWebHdrRow_" + rowNum);
				
		startIndexStr=parseInt(document.getElementById('startIndexUpdate').value);
		
		var principalAmount = rowRef.getElementsByTagName("input")[2].value;
		
		if (removeCommaFrmInput(principalAmount) > 0){
			
			alert ("Principal amount is pending for this period . Please make Payment of the Principal amount first.");
			if(document.getElementById('taxDATLiablibilityWebFormTable').rows.length>1)
			{
				//document.getElementById('paymentRentIncomeWithRegForm').style.display = 'none';
				document.getElementById('paymentRegDATTaxFieldSet').style.display = 'none';
			}
			else
			{
				document.getElementById('paymentRegDATTaxFieldSet').style.display = '';
				//clear_table_data('rentIncomeWithTable');
			}
			rowRef.getElementsByTagName("input")[0].checked= false ;
			return false ;
		}
		else {
			var taxPeriodDisp = rowRef.getElementsByTagName("TD")[1].textContent;
			
			var taxPeriodDispArray = taxPeriodDisp.split(" ");
			var yearStr = taxPeriodDispArray[1];
			var yearInt = parseInt(yearStr);
			//13/08/2024commented to open after amnesty period ended::START
			/*if(yearInt<=2022){
				alert("You cannot pay the Penalty and Interest for periods before January 2023.");
				rowRef.getElementsByTagName("input")[0].checked= false ;
				return false;
			}*/
			//13/08/2024commented to open after amnesty period ended::END
			document.getElementById("hidTaxPeriod").value=taxPeriodDisp;
			//document.getElementById("in_rentIncomeWithholdeeWebFormTable_3").value=taxPeriodDisp;
			document.getElementById("in_taxDATLiablibilityWebFormTable_3").value=taxPeriodDisp;

			var obligationId=document.getElementById('cmbTaxSubHead').value;
		
			var taxPayable = rowRef.getElementsByTagName("TD")[5].textContent;			
			taxPayable=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(taxPayable),10).toFixed(2),true);				
			//document.getElementById("in_rentIncomeWithholdeeWebFormTable_4").value=taxPayable;
			document.getElementById("in_taxDATLiablibilityWebFormTable_4").value=taxPayable;

			var amountPaid = (rowRef.getElementsByTagName("input")[1].value);
			amountPaid=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(amountPaid),10).toFixed(2),true);
			//document.getElementById("in_rentIncomeWithholdeeWebFormTable_5").value=amountPaid;
			document.getElementById("in_taxDATLiablibilityWebFormTable_5").value=amountPaid;
		}
	

	}

}


function addDATLiablibilityWebFormTable(){
	resetErrorList();	
	if(addConfirm('a_taxDATLiablibilityWebFormTable'))
	{
		if(checkDuplicateRowsForDATWebFormTable())
		{
			if(document.getElementById('a_taxDATLiablibilityWebFormTable').innerHTML!="Modify")
			{			
				addrow('taxDATLiablibilityWebFormTable', '3', '3','5','','','N','N');

			}
			else
			{
				return true;
			}
		}
		
	}
	else{
		isFalse=1;
	}

}


function checkDuplicateRowsForDATWebFormTable()
{
	var table = document.getElementById('taxDATLiablibilityWebFormTable');
	var amt = document.getElementById('in_taxDATLiablibilityWebFormTable_4').value;
	var taxPeriod= document.getElementById('in_taxDATLiablibilityWebFormTable_3').value;
	if(amt =="" || amt==null|| taxPeriod=="" || taxPeriod==null){
		alert("Please select a row to be added first.");
		return false;
	}
		if(!(table.rows.length==1))
		{ 	
			for (var i = 1, n = table.rows.length; i <n; i++) 
			{ 
				modify=trim(table.rows[i].cells[2].getElementsByTagName('A')[0].innerHTML);
				if((trim(document.getElementById('id_temp_'+'taxDATLiablibilityWebFormTable'+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&
					(table.rows[i].cells[3].innerHTML==taxPeriod))
				{
					alert("You already added this details.");
					return false;
				}
			}
		}
		return true;
}

function validateDeleteRowRentIncomeWithWebTable(tab_str, rowno, cols)
{
	var table = document.getElementById('taxDATLiablibilityWebFormTable');  
	var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var tempAmt = table.rows[rowno].cells[5].innerHTML;
	totalAmt = totalAmt - parseFloat(removeCommaFrmInput(tempAmt),"10");
	document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
	document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);

}


function beforeAddWebDATTable()
{
	ItAmnt=removeCommaFrmInput(document.getElementById('in_taxDATLiablibilityWebFormTable_5').value);
	TotalAmnt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
}
function afterAddWebDATTable()
{
	TotalAmnt=convertToKenyanShillingFormatVal(parseInt(ItAmnt,10)+parseInt(TotalAmnt,10),true);
	document.getElementById('txtTotalAmountPaidOblig').value=TotalAmnt;
	//added for suggestion for allowing partial payment
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	
}

function afterDeleteWebDATTable(rowno)
{var table = document.getElementById('taxDATLiablibilityWebFormTable');  
var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
var tempAmt = table.rows[rowno].cells[5].innerHTML;
totalAmt = totalAmt - parseFloat(removeCommaFrmInput(tempAmt),"10");
document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
	
}
function beforeDeleteWebDATTable()
{
	
}

function afterModifyWebDATTable()
{
	var table = document.getElementById('taxDATLiablibilityWebFormTable');
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var newAmt=table.rows[rowno].cells[5].innerHTML;
	var newAmountArray=newAmt.split('<');
	newAmt=newAmountArray[0];
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(newAmt),"10")-parseInt(removeCommaFrmInput(ItAmnt),10),true); 
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true;
	//added for suggestion for allowing partial payment
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
}
function beforeModifyWebDATTable(row)
{	isModifyActive=false;
	if(checkDuplicateRowsForWebDAT()){
		rowno=row;
		var table = document.getElementById('taxDATLiablibilityWebFormTable');
		ItAmnt=table.rows[rowno].cells[5].innerHTML;
		var amtToPaidWithHoldeeArray=ItAmnt.split('<');
		ItAmnt=amtToPaidWithHoldeeArray[0];
	}
	else {
		return false;
	}
	
}

function beforeModifyDATTable(row){
	isModifyActive=true;
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	var table = document.getElementById('taxDATLiablibilityWebFormTable');
	taxperiod=table.rows[row].cells[3].innerHTML;
	var tableId = document.getElementById('taxDATLiablibilityTbl');
	for (var i = 0, n = tableId.rows.length; i <n-1; i++) {
	var rowref=document.getElementById('taxDATLiablibilityTblWebHdrRow_'+i);
	var taxperiodtable=rowref.getElementsByTagName("TD")[1].textContent;
	if(taxperiod==taxperiodtable){
		document.getElementById('taxDATLiablibilityTblWebFormRadio_'+i).checked=true;
		document.getElementById('actualLiabilityamount_'+i).readOnly = false;
		document.getElementById('actualLiabilityamount_'+i).className='form101_textfcurr form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
		modifyId=document.getElementById('taxDATLiablibilityTblWebFormRadio_'+i);
	}
}
}


//added for allowing partial payment
function afterModifyDATTable(){
	
}


//added for suggestion for allowing partial payment
function onChangeAmtToBePaidDAT(obj){
	
	var arr=obj.id.split("_");
	var row=arr[1];
	var rowRef = document.getElementById("taxDATLiablibilityTblWebHdrRow_" + row);
	var amtPayable = rowRef.getElementsByTagName("TD")[5].textContent;
	amtPayable=parseInt(removeCommaFrmInput(amtPayable),10).toFixed(2);
	if(parseInt(obj.value)<0 || parseInt(obj.value)>parseInt(amtPayable)){
		alert("Amount to be paid should be greater than 0 and less than amount payable");
		obj.value=amtPayable;
		return false;
	}
	document.getElementById("in_taxDATLiablibilityWebFormTable_5").value=obj.value;
	return true;
	
}

function checkDuplicateRowsForWebDAT()
{
	//var table = document.getElementById('rentIncomeWithholdeeWebFormTable');
	var table = document.getElementById('taxDATLiablibilityWebFormTable');
	var amt = document.getElementById('in_taxDATLiablibilityWebFormTable_4').value;
	var taxPeriod= document.getElementById('in_taxDATLiablibilityWebFormTable_3').value;
	if(amt =="" || amt==null|| taxPeriod=="" || taxPeriod==null){
		alert("Please select a row to be added first.");
		return false;
	}
		if(!(table.rows.length==1))
		{ 	
			for (var i = 1, n = table.rows.length; i <n; i++) 
			{ 
				modify=trim(table.rows[i].cells[2].getElementsByTagName('A')[0].innerHTML);
				if((trim(document.getElementById('id_temp_'+'taxDATLiablibilityWebFormTable'+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&
					(table.rows[i].cells[3].innerHTML==taxPeriod))
				{
					alert("You already added this details.");
					return false;
				}
			}
		}
		return true;
}

//END:::::Added for DAT - 12/2023
function onSelectTaxDSTLiablibilityHdrRadio(obj)
{	//added for allowing partial payment
	
	var rowNum = obj.value;
	var currentId=document.getElementById('taxDSTLiablibilityTblWebHdrRow_'+rowNum);
	if(!(currentId == modifyId)){
	if(isModifyActive==true){
		alert("Please complete modify action.");
		document.getElementById('taxDSTLiablibilityTblWebHdrRow_'+rowNum).checked=false;
		modifyId.checked=true;
		return false;
	}
	}
	
//	document.getElementById('rentIncomeWithholdeeWebFormTable').style.display = '';
//	document.getElementById("rentIncomeWithholdeeWebFormAddRowTable").style.display = "";
//	document.getElementById("rentIncomeWithWebFormLiablibilityTbl").style.display = "";
	//document.getElementById('paymentRentIncomeWithRegForm').style.display = 'none';
	
	document.getElementById("taxDSTLiablibilityTbl").style.display = "";
	document.getElementById("taxDSTLiablibilityWebFormTable").style.display = "";
	document.getElementById("taxDSTLiablibilityWebFormAddRowTable").style.display = "";
	
	document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
	document.getElementById('cmbTaxPeriodYear').disabled = true;
	//document.getElementById("txtTotalAmountPaidOblig").value = "0";
	document.getElementById('monthlyTurnover').value = "0";

	
	
	
	var rowNum = obj.value;
	objValue=obj.value;		
	
	rowNumbmerPartial=obj.value;
	//added for suggestion for allowing partial payment
	//document.getElementsByName('actualLiabilityamount').readOnly = true;
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	if(document.getElementById('cmbTaxSubHead').value!=NSSF && document.getElementById('cmbTaxSubHead').value!=amnestyCode)
	{
		document.getElementById('actualLiabilityamount_'+objValue).readOnly = false;
		document.getElementById('actualLiabilityamount_'+objValue).className='form101_textfcurr form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
	}
	
	//end
	
	if(selectedFlagRentIncomeWithHoldee>0 && document.getElementById('hidIsPartial').value != "Y")
	{
		alert(cntAddPrevLiab);
		document.getElementById('taxDSTLiablibilityTblWebHdrRow_'+rowNumbmerPartial).checked=false;
	}
	else
	{
		var taxPayerId=document.getElementById('hidTaxPayerId').value;
		var rowNum = obj.value;
		objValue=obj.value;
		//var rowRef = document.getElementById("rentIncomeWithHoldeeWebHdrRow_" + rowNum);
		var rowRef = document.getElementById("taxDSTLiablibilityTblWebHdrRow_" + rowNum);
				
		startIndexStr=parseInt(document.getElementById('startIndexUpdate').value);
		
		var principalAmount = rowRef.getElementsByTagName("input")[2].value;
		
		if (removeCommaFrmInput(principalAmount) > 0){
			
			alert ("Principal amount is pending for this period . Please make Payment of the Principal amount first.");
			if(document.getElementById('taxDSTLiablibilityWebFormTable').rows.length>1)
			{
				//document.getElementById('paymentRentIncomeWithRegForm').style.display = 'none';
				document.getElementById('paymentRegDTSTaxFieldSet').style.display = 'none';
			}
			else
			{
				document.getElementById('paymentRegDTSTaxFieldSet').style.display = '';
				//clear_table_data('rentIncomeWithTable');
			}
			rowRef.getElementsByTagName("input")[0].checked= false ;
			return false ;
		}
		else {
			var taxPeriodDisp = rowRef.getElementsByTagName("TD")[1].textContent;
			
			var taxPeriodDispArray = taxPeriodDisp.split(" ");
			var yearStr = taxPeriodDispArray[1];
			var yearInt = parseInt(yearStr);
			//13/08/2024commented to open after amnesty period ended::START
			/*if(yearInt<=2022){
				alert("You cannot pay the Penalty and Interest for periods before January 2023.");
				rowRef.getElementsByTagName("input")[0].checked= false ;
				return false;
			}*/
			//13/08/2024commented to open after amnesty period ended::END
			document.getElementById("hidTaxPeriod").value=taxPeriodDisp;
			//document.getElementById("in_rentIncomeWithholdeeWebFormTable_3").value=taxPeriodDisp;
			document.getElementById("in_taxDSTLiablibilityWebFormTable_3").value=taxPeriodDisp;

			var obligationId=document.getElementById('cmbTaxSubHead').value;
		
			var taxPayable = rowRef.getElementsByTagName("TD")[5].textContent;			
			taxPayable=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(taxPayable),10).toFixed(2),true);				
			//document.getElementById("in_rentIncomeWithholdeeWebFormTable_4").value=taxPayable;
			document.getElementById("in_taxDSTLiablibilityWebFormTable_4").value=taxPayable;

			var amountPaid = (rowRef.getElementsByTagName("input")[1].value);
			amountPaid=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(amountPaid),10).toFixed(2),true);
			//document.getElementById("in_rentIncomeWithholdeeWebFormTable_5").value=amountPaid;
			document.getElementById("in_taxDSTLiablibilityWebFormTable_5").value=amountPaid;
		}
	

	}

}
function addDSTLiablibilityWebFormTable(){
	resetErrorList();	
	if(addConfirm('a_taxDSTLiablibilityWebFormTable'))
	{
		if(checkDuplicateRowsForDSTWebFormTable())
		{
			if(document.getElementById('a_taxDSTLiablibilityWebFormTable').innerHTML!="Modify")
			{			
				addrow('taxDSTLiablibilityWebFormTable', '3', '3','5','','','N','N');

			}
			else
			{
				return true;
			}
		}
		
	}
	else{
		isFalse=1;
	}

}
function checkDuplicateRowsForDSTWebFormTable()
{
	var table = document.getElementById('taxDSTLiablibilityWebFormTable');
	var amt = document.getElementById('in_taxDSTLiablibilityWebFormTable_4').value;
	var taxPeriod= document.getElementById('in_taxDSTLiablibilityWebFormTable_3').value;
	if(amt =="" || amt==null|| taxPeriod=="" || taxPeriod==null){
		alert("Please select a row to be added first.");
		return false;
	}
		if(!(table.rows.length==1))
		{ 	
			for (var i = 1, n = table.rows.length; i <n; i++) 
			{ 
				modify=trim(table.rows[i].cells[2].getElementsByTagName('A')[0].innerHTML);
				if((trim(document.getElementById('id_temp_'+'taxDSTLiablibilityWebFormTable'+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&
					(table.rows[i].cells[3].innerHTML==taxPeriod))
				{
					alert("You already added this details.");
					return false;
				}
			}
		}
		return true;
}
TotalDstAmnt=0;
DstAmnt=0;
function beforeAddTaxDSTLiablibilityWebFormTable()
{
	DstAmnt=removeCommaFrmInput(document.getElementById('in_taxDSTLiablibilityWebFormTable_5').value);
	TotalDstAmnt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
}
function afterAddTaxDSTLiablibilityWebFormTable()
{
	TotalDstAmnt=convertToKenyanShillingFormatVal(parseInt(DstAmnt,10)+parseInt(TotalDstAmnt,10),true);
	document.getElementById('txtTotalAmountPaidOblig').value=TotalDstAmnt;
	$(".rentincomewhtradio").attr('checked',false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	
}
function afterDeleteTaxDSTLiablibilityWebFormTable(rowno)
{
	var table = document.getElementById('taxDSTLiablibilityWebFormTable');  
	var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var tempAmt = table.rows[rowno].cells[5].innerHTML;
	totalAmt = totalAmt - parseInt(removeCommaFrmInput(tempAmt),"10");
	document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
	document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
}
function beforeDeleteTaxDSTLiablibilityWebFormTable()
{
	
}
function afterModifyTaxDSTLiablibilityWebFormTable()
{
	var table = document.getElementById('taxDSTLiablibilityWebFormTable');
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var newAmt=table.rows[rowno].cells[5].innerHTML;
	var newAmountArray=newAmt.split('<');
	newAmt=newAmountArray[0];
	$(".rentincomewhtradio").attr('checked',false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(newAmt),"10")-parseInt(removeCommaFrmInput(DstAmnt),10),true); 
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true; 
}
//added for allowing partial payment
function beforeModifyTaxDSTLiablibilityWebFormTable(row)
{	isModifyActive=false;
	if(checkDuplicateRowsForDSTWebFormTable()){
		rowno=row;
		var table = document.getElementById('taxDSTLiablibilityWebFormTable');
		ItAmnt=table.rows[rowno].cells[5].innerHTML;
		var amtToPaidWithHoldeeArray=ItAmnt.split('<');
		ItAmnt=amtToPaidWithHoldeeArray[0];
	}
	else {
		return false;
	}
}
function saveDSTPaymentOblig()
{
	if (document.getElementById('monthlyTurnover').value==0 && document.getElementById("txtTotalAmountPaidOblig").value==0)
	{
		alert('"Monthly Turnover Value\Total Amount to be paid" cannot be zero');
		return false;
	}
	if(saveConfirm())
	{
		if(document.getElementById('monthlyTurnover').value!=0){
			document.getElementById('DST_Monthly_Turnover').value=document.getElementById('monthlyTurnover').value;
			document.getElementById('isPrevLiabilityChosenForITWht').value='N';
		}
		if(document.getElementById('txtTotalAmountPaidOblig').value!=0 && document.getElementById('monthlyTurnover').value==0){
			//document.getElementById('DST_Monthly_Turnover').value=document.getElementById('txtTotalAmountPaidOblig').value;
			document.getElementById('txtTotalAmountPaidOblig').value = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
			document.getElementById('isPrevLiabilityChosenForITWht').value='Y';
		}
		document.paymentRegForm.action="paymentRegistration.htm?actionCode=saveObligationDetail";
		document.paymentRegForm.submit();
	}
}
//START:: ticket #81171
function saveSEPPaymentOblig()
{
	if (document.getElementById('monthlyTurnoverSEP').value==0 && document.getElementById("txtTotalAmountPaidOblig").value==0)
	{
		alert('"Monthly Turnover Value\Total Amount to be paid" cannot be zero');
		return false;
	}
	if(document.getElementById('SEPToDate').value== '' || document.getElementById('SEPFromDate').value== ''){
		alert('Please select the Tax period to continue ');
		return false;
	}
	if(saveConfirm())
	{
		if(document.getElementById('monthlyTurnoverSEP').value!=0){
			var MonthlySEP= parseInt(document.getElementById('monthlyTurnoverSEP').value);
			document.getElementById('SEP_Monthly_Turnover').value=MonthlySEP;
			document.getElementById('isPrevLiabilityChosenForITWht').value='N';
		}
		if(document.getElementById('txtTotalAmountPaidOblig').value!=0 && document.getElementById('monthlyTurnoverSEP').value==0){
			//document.getElementById('DST_Monthly_Turnover').value=document.getElementById('txtTotalAmountPaidOblig').value;
			document.getElementById('txtTotalAmountPaidOblig').value = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
			document.getElementById('isPrevLiabilityChosenForITWht').value='Y';
		}
		document.paymentRegForm.action="paymentRegistration.htm?actionCode=saveObligationDetail";
		document.paymentRegForm.submit();
	}
}

function showSEPPartialTable(partialDetailArray){
	if(partialDetailArray.length>=1){
		
		document.getElementById('navigationLegend').innerHTML = PreviousLiabilityDetails ;
		document.getElementById("taxSEPLiablibilityTbl").style.display = "";
		var cntr = 0;
		var tabObj = document.getElementById("taxSEPLiablibilityTbl");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		for(var i=0;i<partialDetailArray.length;i++){
			cntr = parseInt(cntr);
			var tabRow = tabObj.insertRow(tabObj.rows.length);
			tabRow.id="taxSEPLiablibilityTblWebHdrRow_"+cntr;
			var tabCell = new Array();
			for (var j=0;j<8;j++){
				tabCell[j] = tabRow.insertCell(j);
			}
			var pmtSplDetailVO = partialDetailArray[i];
		
			var element = document.createElement('input');       
			element.type ='radio';
			//added for allowing partial payment
			element.onclick = function () {onSelectTaxSEPLiablibilityHdrRadio(this);};
			element.value = cntr;
			
			element.id = 'taxSEPLiablibilityTblWebFormRadio_'+cntr;
			element.name = "taxSEPLiablibilityTblWebFormRadio";
			element.className='bordercl rentincomewhtradio';
			
			tabCell[0].appendChild(element); 


			tabCell[1].innerHTML = pmtSplDetailVO.taxPeriod;
			tabCell[1].style.textAlign="center";
			tabCell[1].style.fontSize="11";

			tabCell[2].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualFineAmount).toFixed(2),true);
			tabCell[2].style.textAlign="right";
			tabCell[2].style.fontSize="11";


			tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPenaltyAmount).toFixed(2),true);
			tabCell[3].style.textAlign="right";
			tabCell[3].style.fontSize="11";

			tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualInterestAmount).toFixed(2),true);
			tabCell[4].style.textAlign="right";
			tabCell[4].style.fontSize="11";

			tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			tabCell[5].style.textAlign="right";
			tabCell[5].style.fontSize="11";
			//added for suggestion for allowing partial payment
			var elementtext = document.createElement("input");
			elementtext.type="text";
			elementtext.name="actualLiabilityamount_"+cntr;
			elementtext.id="actualLiabilityamount_"+cntr;
			elementtext.onchange=function() {onChangeAmtToBePaidDAT(this);};
			elementtext.setAttribute("value", convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true));
			elementtext.setAttribute("readOnly", "readOnly");
			
			//tabCell[6].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			elementtext.setAttribute("readOnly", "readOnly");
			elementtext.className='readonlyInput form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
			elementtext.setAttribute('maxlength', 15);
			elementtext.style.textAlign = 'right'; 
			tabCell[6].appendChild(elementtext);
			tabCell[6].style.textAlign="right";
			tabCell[6].style.fontSize="11";
			//end
			var element = document.createElement('input');
     		element.type = 'hidden';
   			element.value =  convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPrincipalAmount).toFixed(2),true);
   			element.width = "0%";
   			tabCell[7].appendChild(element);
   			tabCell[7].style.display = "none";
   			
			cntr = cntr+1;
		}
		document.getElementById("navigationFieldset").style.display = "";
		document.getElementById("navigationTableTaxSpl").style.display = "";
		document.getElementById('taxSEPLiablibilityWebFormTable').style.display = 'none';
		document.getElementById("taxSEPLiablibilityWebFormAddRowTable").style.display = "none";
		document.getElementById('paymentRegDTSTaxFieldSet').style.display="";
		document.getElementById('hidNavigationFlag').value = "6";
		validatePaginationLastTaxSpl();
		validatePaginationFirstTaxSpl();
		
	}
}
function onSelectTaxSEPLiablibilityHdrRadio(obj)
{	//added for allowing partial payment
	
	var rowNum = obj.value;
	var currentId=document.getElementById('taxSEPLiablibilityTblWebHdrRow_'+rowNum);
	if(!(currentId == modifyId)){
	if(isModifyActive==true){
		alert("Please complete modify action.");
		document.getElementById('taxSEPLiablibilityTblWebHdrRow_'+rowNum).checked=false;
		modifyId.checked=true;
		return false;
	}
	}
	
	
	document.getElementById("taxSEPLiablibilityTbl").style.display = "";
	document.getElementById("taxSEPLiablibilityWebFormTable").style.display = "";
	document.getElementById("taxSEPLiablibilityWebFormAddRowTable").style.display = "";
	
	document.getElementById('paymentRegSEPTaxFieldSet').style.display='none';
	document.getElementById('cmbTaxPeriodYear').disabled = true;
	document.getElementById('monthlyTurnover').value = "0";

	
	
	
	var rowNum = obj.value;
	objValue=obj.value;		
	
	rowNumbmerPartial=obj.value;
	//added for suggestion for allowing partial payment
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	if(document.getElementById('cmbTaxSubHead').value!=NSSF && document.getElementById('cmbTaxSubHead').value!=amnestyCode)
	{
		document.getElementById('actualLiabilityamount_'+objValue).readOnly = false;
		document.getElementById('actualLiabilityamount_'+objValue).className='form101_textfcurr form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
	}
	
	//end
	
	if(selectedFlagRentIncomeWithHoldee>0 && document.getElementById('hidIsPartial').value != "Y")
	{
		alert(cntAddPrevLiab);
		document.getElementById('taxSEPLiablibilityTblWebHdrRow_'+rowNumbmerPartial).checked=false;
	}
	else
	{
		var taxPayerId=document.getElementById('hidTaxPayerId').value;
		var rowNum = obj.value;
		objValue=obj.value;
		var rowRef = document.getElementById("taxSEPLiablibilityTblWebHdrRow_" + rowNum);
				
		startIndexStr=parseInt(document.getElementById('startIndexUpdate').value);
		
		var principalAmount = rowRef.getElementsByTagName("input")[2].value;
		
		if (removeCommaFrmInput(principalAmount) > 0){
			
			alert ("Principal amount is pending for this period . Please make Payment of the Principal amount first.");
			if(document.getElementById('taxSEPLiablibilityWebFormTable').rows.length>1)
			{
				document.getElementById('paymentRegSEPTaxFieldSet').style.display = 'none';
			}
			else
			{
				document.getElementById('paymentRegSEPTaxFieldSet').style.display = '';
			}
			rowRef.getElementsByTagName("input")[0].checked= false ;
			return false ;
		}
		else {
			var taxPeriodDisp = rowRef.getElementsByTagName("TD")[1].textContent;
			
			var taxPeriodDispArray = taxPeriodDisp.split(" ");
			var yearStr = taxPeriodDispArray[1];
			var yearInt = parseInt(yearStr);
			//13/08/2024commented to open after amnesty period ended::START
			/*if(yearInt<=2022){
				alert("You cannot pay the Penalty and Interest for periods before January 2023.");
				rowRef.getElementsByTagName("input")[0].checked= false ;
				return false;
			}*/
			//13/08/2024commented to open after amnesty period ended::END
			document.getElementById("hidTaxPeriod").value=taxPeriodDisp;
			document.getElementById("in_taxSEPLiablibilityWebFormTable_3").value=taxPeriodDisp;

			var obligationId=document.getElementById('cmbTaxSubHead').value;
		
			var taxPayable = rowRef.getElementsByTagName("TD")[5].textContent;			
			taxPayable=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(taxPayable),10).toFixed(2),true);				
			document.getElementById("in_taxSEPLiablibilityWebFormTable_4").value=taxPayable;

			var amountPaid = (rowRef.getElementsByTagName("input")[1].value);
			amountPaid=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(amountPaid),10).toFixed(2),true);
			document.getElementById("in_taxSEPLiablibilityWebFormTable_5").value=amountPaid;
		}
	

	}

}

function addSEPLiablibilityWebFormTable(){
	resetErrorList();	
	if(addConfirm('a_taxSEPLiablibilityWebFormTable'))
	{
		if(checkDuplicateRowsForSEPWebFormTable())
		{
			if(document.getElementById('a_taxSEPLiablibilityWebFormTable').innerHTML!="Modify")
			{			
				addrow('taxSEPLiablibilityWebFormTable', '3', '3','5','','','N','N');

			}
			else
			{
				return true;
			}
		}
		
	}
	else{
		isFalse=1;
	}

}

function checkDuplicateRowsForSEPWebFormTable()
{
	var table = document.getElementById('taxSEPLiablibilityWebFormTable');
	var amt = document.getElementById('in_taxSEPLiablibilityWebFormTable_4').value;
	var taxPeriod= document.getElementById('in_taxSEPLiablibilityWebFormTable_3').value;
	if(amt =="" || amt==null|| taxPeriod=="" || taxPeriod==null){
		alert("Please select a row to be added first.");
		return false;
	}
		if(!(table.rows.length==1))
		{ 	
			for (var i = 1, n = table.rows.length; i <n; i++) 
			{ 
				modify=trim(table.rows[i].cells[2].getElementsByTagName('A')[0].innerHTML);
				if((trim(document.getElementById('id_temp_'+'taxSEPLiablibilityWebFormTable'+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&
					(table.rows[i].cells[3].innerHTML==taxPeriod))
				{
					alert("You already added this details.");
					return false;
				}
			}
		}
		return true;
}
TotalSEPAmnt=0;
SEPAmnt=0;
function beforeAddTaxSEPLiablibilityWebFormTable()
{
	SEPAmnt=removeCommaFrmInput(document.getElementById('in_taxSEPLiablibilityWebFormTable_5').value);
	TotalSEPAmnt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
}
function afterAddTaxSEPLiablibilityWebFormTable()
{
	TotalSEPAmnt=convertToKenyanShillingFormatVal(parseInt(SEPAmnt,10)+parseInt(TotalSEPAmnt,10),true);
	document.getElementById('txtTotalAmountPaidOblig').value=TotalSEPAmnt;
	$(".rentincomewhtradio").attr('checked',false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	
}
function afterDeleteTaxSEPLiablibilityWebFormTable(rowno)
{
	var table = document.getElementById('taxSEPLiablibilityWebFormTable');  
	var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var tempAmt = table.rows[rowno].cells[5].innerHTML;
	totalAmt = totalAmt - parseInt(removeCommaFrmInput(tempAmt),"10");
	document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
	document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
}
function beforeDeleteTaxSEPLiablibilityWebFormTable()
{
	
}
function afterModifyTaxSEPLiablibilityWebFormTable()
{
	var table = document.getElementById('taxSEPLiablibilityWebFormTable');
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var newAmt=table.rows[rowno].cells[5].innerHTML;
	var newAmountArray=newAmt.split('<');
	newAmt=newAmountArray[0];
	$(".rentincomewhtradio").attr('checked',false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(newAmt),"10")-parseInt(removeCommaFrmInput(SEPAmnt),10),true); 
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true; 
}
//added for allowing partial payment
function beforeModifyTaxSEPLiablibilityWebFormTable(row)
{	isModifyActive=false;
	if(checkDuplicateRowsForSEPWebFormTable()){
		rowno=row;
		var table = document.getElementById('taxSEPLiablibilityWebFormTable');
		ItAmnt=table.rows[rowno].cells[5].innerHTML;
		var amtToPaidWithHoldeeArray=ItAmnt.split('<');
		ItAmnt=amtToPaidWithHoldeeArray[0];
	}
	else {
		return false;
	}
}


//END:: ticket #81171
