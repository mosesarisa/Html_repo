function onChangeGBPTType(obj){

	$("#gbptTaxRate").val("0.00");
	$('#gpbtFieldSet').show();
	$('#cmbTaxPeriodYearGPBT').show();
	$("#gpbtTurnOverAmount").val("0");
	$("#gbptPayOutWinning").val("0");
	$("#gbptRevenueAmount").val("0");
	$("#gbptTaxAmount").val("0");
	$("#gbptTaxAmount").val("0");
	$("#cmbTaxPeriodYearGPBT").val("-1");
	$("#cmbTaxPeriodMonthGPBT").val("-1");
	var gpbtType=$("#cmbGPBTType").val();
	if (gpbtType==-1){
		$("#gbptTaxRate").val("0");
		$('#gpbtFieldSet').hide();
	}

	var value=obj.value;
	var obligationId=$("#cmbTaxSubHead").val();
	//document.getElementById('lblTotalAmountPaid').style.display='none';	
	$('#hide1').hide();

	$("#gPBTTypeHidField").val(value);
	if (value == bettingTax || value == gamingTax || value == prizeCompetitionTax)
	{

		$('#lblGrossTurnOver').show();
		$('#lblLotteryTurnOver').hide();
		if (value==gamingTax || value== bettingTax)
		{
			$('#gbptPayOutWinning').show();
			$('#lblGamingRevenueAmount').show();
			$('#gpbtOptional').show();
			$('#gpbtOptional1').show();
		}else 
		{
			$('#gpbtOptional').hide();
			$('#gpbtOptional1').hide();
		}
	}
	else if(value == lotteryTax)
	{

		$('#lblLotteryTurnOver').show();
		$('#lblGrossTurnOver').hide();
		$('#gpbtOptional').hide();
		$('#gpbtOptional1').hide();
	}

	//fetchTaxRateValueFromCategoryWeb(obligationId,value,null,null);	
	//$("#gbptTaxRate").val(taxRate);
	$("#gbptTaxRate").prop("readonly", true);
}





function onChangeTaxPeriodGPBT(obj){
	
	var value=$("#cmbGPBTType").val();
	var dummydata;
	if (value == bettingTax || value == gamingTax || value == prizeCompetitionTax)
	{

		$('#lblGrossTurnOver').show();
		$('#lblLotteryTurnOver').hide();
		if (value==gamingTax || value== bettingTax)
		{
			$('#gbptPayOutWinning').show();
			$('#lblGamingRevenueAmount').show();
		}else 
		{
			$('#gbptPayOutWinning').hide();
			$('#lblGamingRevenueAmount').hide();
		}
	}
	else if(value == lotteryTax)
	{

		$('#lblLotteryTurnOver').show();
		$('#lblGrossTurnOver').hide();
		$('#gbptPayOutWinning').hide();
		$('#lblGamingRevenueAmount').hide();
	}

	$('#gpbtTurnOverAmount').show();
	document.getElementById('gpbtTurnOverAmount').style.display="";
	/*$("#gbptTaxRate").val(taxRate);*/
	$('#lblPayOutWinCustomer').show();
	$('#gbptRevenueAmount').show();
	$('#lblTaxRate').show();
	$('#gbptTaxRate').show();
	$('#lblTaxAmount').show();
	$('#gbptTaxAmount').show();
	//added for tax rate change
	var taxPeriod=obj.value;
	var arr=taxPeriod.split("-");
	var periodfrm=arr[0];
	var periodto=arr[1];
//	var periodFrom=periodfrm.replace("/","-");
//	var periodTo=formatDate(periodto);
	var value=document.getElementById('cmbGPBTType').value;
	
	var obligationId=$("#cmbTaxSubHead").val();
	
	fetchTaxRateValueFromCategoryWeb(obligationId,value,periodfrm,periodto);	
	
	
	$("#gpbtTurnOverAmount").val("0");
	$("#gbptTaxAmount").val("0");
	$("#gbptPayOutWinning").val("0");
	$("#gbptRevenueAmount").val("0");
	
	//$("#gbptTaxRate").val(taxRate);
	//var year =$("#cmbTaxPeriodYearGPBT").val();
 //	$("#cmbTaxPeriodYearGPBT").val("-1");
//	if (year<2018)
//	{
//		if (value == bettingTax)
//		{
//			$("#gbptTaxRate").val("7.50");
//		}
//		else if (value == lotteryTax)
//		{
//			$("#gbptTaxRate").val("5.00");
//		}
//		else if (value == gamingTax)
//		{
//			$("#gbptTaxRate").val("12.00");
//		}
//		else if (value == prizeCompetitionTax)
//		{
//			$("#gbptTaxRate").val("15.00");
//		}
//	}
//	else 
//		{
//		$("#gbptTaxRate").val("35.00");
//		}
	
}


function calculateRevenueAmount()
{
	var gpbtType=$("#cmbGPBTType").val();
	
		
		var turnOverAmount=removeCommaFrmInput($('#gpbtTurnOverAmount').val());
		var payOutAmount=removeCommaFrmInput($('#gbptPayOutWinning').val());
		if (turnOverAmount>0)
			$('#gpbtTurnOverAmount').val(convertToKenyanShillingFormatVal($('#gpbtTurnOverAmount').val()));;
		
		if (payOutAmount>0)
			$('#gbptPayOutWinning').val(convertToKenyanShillingFormatVal($('#gbptPayOutWinning').val()));;
		var amount=0;
		amount=Math.ceil(turnOverAmount-payOutAmount);
		if (gpbtType == bettingTax || gpbtType == gamingTax) 
		{
			if (turnOverAmount>0 && payOutAmount>=0)
			{
				if (amount>0)
				{
					$("#gbptRevenueAmount").val(amount);
					$('#gbptRevenueAmount').val(convertToKenyanShillingFormatVal($('#gbptRevenueAmount').val()));;
					return true;
				}
				else
				{
					$("#gbptPayOutWinning").val("0");
					alert("Pay out in Winning to Customer(B) must be less than the Gross TurnOver(A)");

				}
			}

		}
}

function calculateTax()
{
	var gpbtType=$("#cmbGPBTType").val();
	var turnOverAmount=removeCommaFrmInput($('#gpbtTurnOverAmount').val());
	var gamingRevenueAmount=removeCommaFrmInput($('#gbptRevenueAmount').val());
		$('#gpbtTurnOverAmount').val(convertToKenyanShillingFormatVal($('#gpbtTurnOverAmount').val()));;
	
		var taxRate=$('#gbptTaxRate').val();
		var amount=0;

		if(gpbtType == lotteryTax ||gpbtType ==  prizeCompetitionTax)
		{
			amount=Math.ceil((turnOverAmount*taxRate)/100);
			$("#gbptTaxAmount").val(amount);
			$('#gbptTaxAmount').val(convertToKenyanShillingFormatVal($('#gbptTaxAmount').val()));;

		} else if (gpbtType == bettingTax || gpbtType == gamingTax ) 
		{
			amount=Math.ceil((gamingRevenueAmount*taxRate)/100);
			$("#gbptTaxAmount").val(amount);
			$('#gbptTaxAmount').val(convertToKenyanShillingFormatVal($('#gbptTaxAmount').val()));;

		}

}

function checkGPBTDetails()
{
	var year=($('#cmbTaxPeriodYearGPBT').val());
	var month=($('#cmbTaxPeriodMonthGPBT').val());
	if (year==("-1")|| month==("-1"))
	{		
		alert("Please enter Tax Period");
		return false;
	}
	else
		{
		return true;
		}
	
}
