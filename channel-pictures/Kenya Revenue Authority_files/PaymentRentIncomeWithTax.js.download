//changes done for CR Rent Income Withholding

var isCountyDisabled=false;
var isDistrictDisabled=false;
var isLocalityDisabled=false;
var isPostOfcDisabled=false;
var isPostCodeDisabled=false;
//added for allowing partial payment
var isModifyActive=false;
var modifyId;

function onSelectionOfRadioForRentIncomeWith(radioValue)
{
	  if(radioValue=='e')
	  {
		  resetRentIncomeWithholdeeInfoInWith();
		  document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
		  document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
		  document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
		  document.getElementById('paymentWithWebForm').style.display = 'none';
		  document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
		  document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
		  //Added for DAT - 11/2023
		  document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
		  document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
		  document.getElementById('paymentRentIncomeWithExcelUploadForm').style.display ='';
		  document.getElementById('paymentRentIncomeWithWebForm').style.display='none'; 
		  document.getElementById('RentIncomeWithPaymentFieldlset').style.display='none';
		  document.getElementById('paymentTaxObligForm').style.display=''; 
		  document.getElementById('paymentRentIncomeWithWebForm').style.display='none'; 
		  document.getElementById('paymentRentIncomeWithRegForm').style.display='none'; 
		  document.getElementById('RentIncomeWithPaymentType').value='e';
		  document.getElementById('disclaimerFieldSet').style.display='none';
		  document.getElementById('RentIncomeWithPaymentFieldlset').style.display='none';
		  document.getElementById('totalAmountPaidFieldSet').style.display='none';
		  document.getElementById('rentIncomeWithWebFormLiablibilityTbl').style.display='none';
		  document.getElementById('navigationFieldset').style.display='none'; 
		  clear_table_data('rentIncomeWithTable');
		  selectedFlagPartial=0;
		  setOtrParamForCSV();
		  clearNevigationData();
		  selectedFlagRentIncomeWithHoldee=0;
		  document.getElementById('excelRentIncomeWithPmtTypeRadio2').checked=true;
		  amendmentOrNormalRentIncomeWHT(document.getElementById('excelRentIncomeWithPmtTypeRadio2'));

		  // document.getElementById('liabilityBtn').disabled=false;
	  }
	  else
	  {
		// Added on 12/09/2024 to sort withholding Issue.
		// Allow generation of interest or penalty only or principal only not
		// both
		if (document.getElementById('cmbTaxSubHead').value == '35') {
			clear_table_data("withWebFormLiablibilityTbl");
			clear_table_data("withholdeeWebFormTable");
			clear_table_data("vatWithWebFormLiablibilityTbl");
			clear_table_data("vatWithholdeeWebFormTable");
			clear_table_data("vatWithholdeeWebFormAddRowTable");
			document.getElementById('withholdeeWebFormTable').style.display = 'none';
			document.getElementById('withWebFormLiablibilityTbl').style.display = 'none';
			document.getElementById('vatWithWebFormLiablibilityTbl').style.display = 'none';
			document.getElementById('vatWithholdeeWebFormTable').style.display = 'none';
			document.getElementById('vatWithholdeeWebFormAddRowTable').style.display = 'none';
		}
		// clear_table_data("withWebFormLiablibilityTbl");
		// clear_table_data("vatWithWebFormLiablibilityTbl");
		document.getElementById('paymentTaxObligForm').style.display = '';
		document.getElementById('txtTotalAmountPaidOblig').value = "0";
		// End 12/09/2024
			  
		  document.getElementById('RentIncomeWithPaymentType').value='n';
		  document.getElementById('disclaimerFieldSet').style.display='none';
		 // onChngCmbPmtType(document.getElementById('cmbPaymentType'));
		  document.getElementById('paymentTaxObligForm').style.display=''; 
		  document.getElementById('paymentRentIncomeWithExcelUploadForm').style.display ='none';
		  document.getElementById('paymentRegShippingTaxFieldSet').style.display = 'none';
		  document.getElementById('paymentRegVISFieldSet').style.display = 'none';
			//Added for VIS payment cancelletion :: 66743
			document.getElementById('pmtCanclVIS').style.display="none";
			document.getElementById('chooseExcelPaymentMethod1').style.display="none";
			//END
		  document.getElementById('paymentRegWithholdeeSet').style.display = 'none';
		  document.getElementById('paymentWithWebForm').style.display = 'none';
		  document.getElementById('paymentRegTransmissionTaxFieldSet').style.display = 'none';
		  document.getElementById('paymentRegDTSTaxFieldSet').style.display='none';
		  //Added for DAT - 11/2023
		  document.getElementById('paymentRegDATTaxFieldSet').style.display='none';
		  document.getElementById('paymentRegAgencyNoticeSet').style.display = 'none';
		  document.getElementById('paymentRentIncomeWithWebForm').style.display='none'; 
		  document.getElementById('paymentRentIncomeWithRegForm').style.display='';
		  document.getElementById('RentIncomeWithPaymentFieldlset').style.display='';
		  document.getElementById('totalAmountPaidFieldSet').style.display='';
		  document.getElementById('TotalTaxFieldSet').style.display = 'none';
		  document.getElementById('navigationFieldset').style.display = 'none';
		  document.getElementById("txtTotalAmountPaidOblig").value=0;  
		  document.getElementById('disclaimerFieldSet').style.display='none';
		  document.getElementById("txtTotalAmountPaidOblig").readOnly=true;
		  document.getElementById("txtTotalAmountPaidOblig").className='readonlyInput form101_textfcurr_width textonlyRight';
		  document.getElementById('ObligationDetailFieldSet').style.display = 'none';
		  taxObligation=document.getElementById('cmbTaxSubHead').selectedIndex;
		  document.getElementById('LiablibilityTbl').style.display = 'none';
		  document.getElementById('navigationTable').style.display = 'none';
		  document.getElementById("tblFineList").style.display="none";
		  document.getElementById("tblIntrestList").style.display="none";
		  document.getElementById("tblPaymentList").style.display="none";
		  document.getElementById("tblPenaltyList").style.display="none";
		  document.getElementById('btnTbl').style.display="";
			rowNumbmerPartial=0;
			selectedFlagPartial=0;
			setOtrParamForCSV();
			clearNevigationData();
			if(document.getElementById('isWithoutLogin').value == "N")
				fetchSplOblHdrWebByObligation("N");
			
		  document.getElementById('paymentRentIncomeWithExcelUploadForm').style.display ='none';
		  clear_table_data("RentIncomeWithPreviousDetailsTable");
			document.getElementById('RentIncomeWithPreviousDetailsTable').style.display='none';
			document.getElementById("navigationFieldsetForRentIncomeWith").style.display = 'none';
			document.getElementById("scrollableDivRentIncomeWith").style.display = 'none';
			document.getElementById("RentIncomeWithPeriodMonth").selectedIndex=-1;
			document.getElementById("RentIncomeWithTaxPeriodYear").selectedIndex=-1;
	  }
}

function amendmentOrNormalRentIncomeWHT(obj)
{
	if(obj.value=='amendment')
		{
			document.getElementById('chooseExcelPaymentMethodRentIncomeWith').style.display='';
			document.getElementById('navigationFieldsetForRentIncomeWith').style.display='none';
			document.getElementById('navigationLegendForRentIncomeWith').style.display='';
			document.getElementById('fileRentIncomeWith').disabled=true;
			document.getElementById('instructionsTableRentIncomeWith').style.display='none';
			document.getElementById('isAmendment').value='Y';
		}
	else if(obj.value=='normal')
		{
			document.getElementById('chooseExcelPaymentMethodRentIncomeWith').style.display='none';
			document.getElementById('RentIncomeWithPreviousDetailsTable').style.display='none';
			clear_table_data("RentIncomeWithPreviousDetailsTable");
			document.getElementById('RentIncomeWithTaxPeriodYear').selectedIndex=0;
			document.getElementById('RentIncomeWithPeriodMonth').selectedIndex=0;
			document.getElementById('navigationFieldsetForRentIncomeWith').style.display='none';
			document.getElementById("scrollableDivRentIncomeWith").style.display = 'none';
			document.getElementById('fileRentIncomeWith').disabled=false;
			document.getElementById('instructionsTableRentIncomeWith').style.display='';
			document.getElementById('amendButtonRentIncomeWith').style.display='none';
			document.getElementById('isAmendment').value='N';
		}
}

function onChangeYearRentIncomeWith(obj)
{
		if(obj.value==-1)
		{
			document.getElementById("RentIncomeWithPeriodMonth").selectedIndex=-1;
		}
		if(onChangeYearValidation())
		{
			if(obj.selectedIndex!= 0)
			{
				document.getElementById('RentIncomeWithPeriodMonth').disabled=false;
				GetMonthsForVatWithholding.getMonthsForVatWithholding(document.getElementById('RentIncomeWithTaxPeriodYear').value, 
						document.getElementById('initialLoginPin').value,rentIncomeWith, {async:false,callback:function(data){
							if(data!=null){
								if(data.length>=1)
								{
									dwr.util.removeAllOptions(document.getElementById("RentIncomeWithPeriodMonth"));
									var oOption = document.createElement("OPTION"); 
									oOption.text="--Month--"; 
									oOption.value="-1"; 
									document.getElementById("RentIncomeWithPeriodMonth").add(oOption); 
									dwr.util.addOptions(document.getElementById("RentIncomeWithPeriodMonth"),data,'fromDate','toDate');
									return true;
								}
							}
							else{
								alert("error fetching data.");
							}
						}});
			}
		}else
		{
			document.getElementById('RentIncomeWithPeriodMonth').disabled=true;
			return true;
		}
}

function onChangeMonthRentIncomeWith(obj)
{
	var val=obj.value;
	if(val!=-1)
	{
		if(document.getElementById('isWithoutLogin').value == "N")
			fetchSplOblHdrWebByObligationAmndRentIncomeWith("N");
	}	
}

function fetchSplOblHdrWebByObligationAmndRentIncomeWith(flagForTaxPeriod){
	var obligationId = "";
	var taxPayerId=document.getElementById('hidTaxPayerId').value;
	var startIndexStr=document.getElementById('startIndex').value;
	
	/*if( document.getElementById('cmbTaxSubHead').value==WithHoldee)
	{
		obligationId=WithHoldee;
	}*/
	obligationId=rentIncomeWith;
	var fromDate = document.getElementById('hidObligationFromDate').value;
	var toDate = document.getElementById('hidObligationToDate').value;

	FetchSplOblHdrWebByObligationAmnd.fetchSplOblHdrWebByObligationAmnd(fromDate,toDate,taxPayerId,obligationId,flagForTaxPeriod,startIndexStr,{async:false,callback: function(data) {
		pmtSplDetailVOListForPartial =  data;
		
		var count=0;	
	
		if(pmtSplDetailVOListForPartial!= null && pmtSplDetailVOListForPartial[0].isDataAvailable=="Y"){
			partialDetailArray.length=0;
			for(var i = 0; i< pmtSplDetailVOListForPartial.length ; i++){
				var pmtSplDetailVO = pmtSplDetailVOListForPartial[i];
				partialDetailArray[i] = pmtSplDetailVO;
			}				
			 if(obligationId==rentIncomeWith)
			{
				count=1;
				showRentIncomeWithPreviousDetailsTableForAmnd(partialDetailArray);
			}
			else{
				alert(validObligation);
				return false;
			}
	}
		if(count==0){
			partialDetailArray.length=0;
			for(var i = 0; i< pmtSplDetailVOListForPartial.length ; i++){
				var pmtSplDetailVO = pmtSplDetailVOListForPartial[i];
				partialDetailArray[i] = pmtSplDetailVO;
			}
			if(obligationId==rentIncomeWith)
			{
				showRentIncomeWithPreviousDetailsTableForAmnd(partialDetailArray);
			}
		}
		
	}});

}

function showRentIncomeWithPreviousDetailsTableForAmnd(partialDetailArray)
{
	var flag=0;
	if(partialDetailArray.length>=1){
		document.getElementById('navigationLegendForRentIncomeWith').innerHTML = PreviousLiabilityDetails ;
		var cntr = 0;
		var tabObj = document.getElementById("RentIncomeWithPreviousDetailsTable");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		var period=document.getElementById("RentIncomeWithPeriodMonth").value;
		var dateArray=period.split('-');
		var firstDate=dateArray[0];
		var lastDate= dateArray[1];
		for(var i=0;i<partialDetailArray.length;i++){
			if(partialDetailArray[i].taxperiodFromDtWid!=null && partialDetailArray[i].taxperiodFromDtWid!=""){
				var value=CompareDates(firstDate,partialDetailArray[i].taxperiodFromDtWid);
				if(value==0 || value==2)
					{
					  var val=CompareDates(partialDetailArray[i].taxperiodFromDtWid,lastDate);
					  if(val==0 || val==2)
						{  
						  	flag=1;
							cntr = parseInt(cntr);
							var tabRow = tabObj.insertRow(tabObj.rows.length);
							tabRow.id="rentIncomeWithHoldeeHdrRow_"+cntr;
							var tabCell = new Array();
							for (var j=0;j<8;j++){
								tabCell[j] = tabRow.insertCell(j);
							}
							var pmtSplDetailVO = partialDetailArray[i];
							var element = document.createElement('input');       
							element.type ='checkbox';
							element.onclick = function () {onSelectRentIncomeWithAmndmntPrevDetailRadio(this);};
							element.value = cntr;
							element.id = 'rentIncomeWithHoldeeHdrCheckbox_'+cntr;
							element.name = "rentIncomeWithHoldeeHdrCheckbox";
							element.className='bordercl';
							tabCell[0].appendChild(element); 
				
				
							tabCell[1].innerHTML = pmtSplDetailVO.prn;
							tabCell[1].style.textAlign="center";
							tabCell[1].style.fontSize="11";
				
							tabCell[2].innerHTML = pmtSplDetailVO.fromDate;
							tabCell[2].style.textAlign="center";
							tabCell[2].style.fontSize="11";
				
							tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.totalAmount).toFixed(2),true);
							tabCell[3].style.textAlign="right";
							tabCell[3].style.fontSize="11";
				
							tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualFineAmount).toFixed(2),true);
							tabCell[4].style.textAlign="right";
							tabCell[4].style.fontSize="11";
				
							tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPenaltyAmount).toFixed(2),true);
							tabCell[5].style.textAlign="right";
							tabCell[5].style.fontSize="11";
				
							tabCell[6].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualInterestAmount).toFixed(2),true);
							tabCell[6].style.textAlign="right";
							tabCell[6].style.fontSize="11";
				
							cntr = cntr+1;
						}
					}
			}
			
		}
		if(flag==0)
			{
				var table = document.getElementById("RentIncomeWithPreviousDetailsTable");
				var tabRow = table.insertRow(tabObj.rows.length);
				var tabCell = new Array();
				tabCell[0] = tabRow.insertCell(0);
				tabCell[0].innerHTML ="System has not found any PRN for Rent Income Withholding which are not reconciled. Please select proper period.";
				tabCell[0].style.textAlign="center";
				tabCell[0].colSpan="7";
				tabCell[0].style.color="red";
				document.getElementById("scrollableDivRentIncomeWith").style.height='60px';
			}
		else
		{
			var px= cntr*35;
			if(px<100){
				px=80;
			}
			if(px>270)
			{
				px=270;
			}
			document.getElementById("scrollableDivRentIncomeWith").style.height=px+'px';
		}
		document.getElementById("scrollableDivRentIncomeWith").style.display = "";
		document.getElementById("navigationFieldsetForRentIncomeWith").style.display = "";
		document.getElementById("RentIncomeWithPreviousDetailsTable").style.display = "";
		document.getElementById('hidNavigationFlag').value = "29";
		document.getElementById("uploadDivRentIncomeWith").style.display = "none";
		
	}
}

function downloadFileRentIncomeWith()
{
	
	commonDownloadFile(document.paymentRegForm,'Bcl_Tenant_Dtls.xls','templates');
		
}
/*RI paypoint :: start*/
function downloadFileRIWith()
{
	
	commonDownloadFile(document.RIWitholdingPaymentRegForm,'Bcl_Tenant_Dtls.xls','templates');
		
}
function downloadRIWithPrnAmendment(){
	var  tableObj =document.getElementById('RentIncomeWithPreviousDetailsTable');
	document.getElementById('prnString').value='';
	var prnstring ='';
	var prn = null; 
	if(tableObj.rows.length > 1){
		for(var i = 1, n = tableObj.rows.length; i <n; i++) 
		{
			if(document.getElementById('rentIncomeWithHoldeeHdrCheckbox_'+(i-1)).checked){
				if (document.all) {// for IE
					prn = tableObj.rows[i].cells[1].innerText;
				}
				else{
					var innrhtmltext = tableObj.rows[i].cells[1].textContent;
					prn = innrhtmltext; 
				}
				
				prnstring =prnstring.concat(prn+',');
			}

		}
		if(prnstring.length==0){
			alert("Please select PRN for amendedment");
		}else{
			document.getElementById('prnString').value=prnstring;			
			document.getElementById('cmbTaxSubHead').value=rentIncomeWith;
				if (confirm('Are you sure you want to download amendment ?')){
					document.getElementById('cmdSaveOblig').disabled=false;//changed
					document.RIWitholdingPaymentRegForm.action="paymentRegistration.htm?actionCode=downloadPaymentAmendment";
					document.RIWitholdingPaymentRegForm.submit();
				}			
		}	
		document.getElementById("uploadDivRentIncomeWith").style.display = "";

	}else{
		alert("No payment details avalible for this period");
	}
}

function cancelRIWithPRN(){
	var  tableObj =document.getElementById('RentIncomeWithPreviousDetailsTable');
	var obligationId="35";
	var pinNo="";
	if(document.getElementById('cmbTaxHead').value==IT && document.getElementById('cmbTaxSubHead').value==rentIncomeWith)
	{
		obligationId=rentIncomeWith;
	}
	document.getElementById('prnString').value='';
	var prnstring ='';
	var prn = null; 
	if(tableObj.rows.length > 1){
		for(var i = 1, n = tableObj.rows.length; i <n; i++) 
		{
			if(document.getElementById('rentIncomeWithHoldeeHdrCheckbox_'+(i-1)).checked){
				if (document.all) {// for IE
					prn = tableObj.rows[i].cells[1].innerText;
				}
				else{
					var innrhtmltext = tableObj.rows[i].cells[1].textContent;
					prn = innrhtmltext; 
				}

				prnstring =prnstring.concat(prn+',');
			}

		}
		if(prnstring.length==0){
			alert("Please select PRN for Cancellation");
		}else{
			document.getElementById('prnString').value=prnstring;
			//var excelFor=document.getElementById("excelForPaymentOrAdv").value;
			pinNo = document.getElementById('txtPin').value ;
			if (confirm('Are you sure you want to cancel the  PRN(s) ?')){
				document.getElementById('cmdSaveOblig').disabled=false;//changed

				CancelAdvPRNs.cancelSelectedPRNs(prnstring,obligationId,pinNo,{async:false,callback: function(data){
					var success=data;
					if(data==true)
					{
						alert("PRN(s) cancelled successfully");
						if(document.getElementById('isWithoutLogin').value == "N")
							fetchSplOblHdrWebByObligationAmndRentIncomeWith("N");
					}
					else if(data==false)
					{
						alert("Cannot cancel the PRN(s). Please try again");
					}
				}
				});
			}



		}/*else{
		alert("No payment details avalible for this period");
	}*/
	}
}
/*RI paypoint :: end*/
function downloadRentIncomeWithPrnAmendment(){
	var  tableObj =document.getElementById('RentIncomeWithPreviousDetailsTable');
	document.getElementById('prnString').value='';
	var prnstring ='';
	var prn = null; 
	if(tableObj.rows.length > 1){
		for(var i = 1, n = tableObj.rows.length; i <n; i++) 
		{
			if(document.getElementById('rentIncomeWithHoldeeHdrCheckbox_'+(i-1)).checked){
				if (document.all) {// for IE
					prn = tableObj.rows[i].cells[1].innerText;
				}
				else{
					var innrhtmltext = tableObj.rows[i].cells[1].textContent;
					prn = innrhtmltext; 
				}
				
				prnstring =prnstring.concat(prn+',');
			}

		}
		if(prnstring.length==0){
			alert("Please select PRN for amendedment");
		}else{
			document.getElementById('prnString').value=prnstring;			
			document.getElementById('cmbTaxSubHead').value=rentIncomeWith;
				if (confirm('Are you sure you want to download amendment ?')){
					document.getElementById('cmdSaveOblig').disabled=false;//changed
					document.paymentRegForm.action="paymentRegistration.htm?actionCode=downloadPaymentAmendment";
					document.paymentRegForm.submit();
				}			
		}	
		document.getElementById("uploadDivRentIncomeWith").style.display = "";

	}else{
		alert("No payment details avalible for this period");
	}
}


function cancelRentIncomeWithPRN(){
	var  tableObj =document.getElementById('RentIncomeWithPreviousDetailsTable');
	var obligationId="";
	var pinNo="";
	if(document.getElementById('cmbTaxHead').value==IT && document.getElementById('cmbTaxSubHead').value==rentIncomeWith)
	{
		obligationId=rentIncomeWith;
	}
	document.getElementById('prnString').value='';
	var prnstring ='';
	var prn = null; 
	if(tableObj.rows.length > 1){
		for(var i = 1, n = tableObj.rows.length; i <n; i++) 
		{
			if(document.getElementById('rentIncomeWithHoldeeHdrCheckbox_'+(i-1)).checked){
				if (document.all) {// for IE
					prn = tableObj.rows[i].cells[1].innerText;
				}
				else{
					var innrhtmltext = tableObj.rows[i].cells[1].textContent;
					prn = innrhtmltext; 
				}

				prnstring =prnstring.concat(prn+',');
			}

		}
		if(prnstring.length==0){
			alert("Please select PRN for Cancellation");
		}else{
			document.getElementById('prnString').value=prnstring;
			//var excelFor=document.getElementById("excelForPaymentOrAdv").value;
			pinNo = document.getElementById('txtPin').value ;
			if (confirm('Are you sure you want to cancel the  PRN(s) ?')){
				document.getElementById('cmdSaveOblig').disabled=false;//changed

				CancelAdvPRNs.cancelSelectedPRNs(prnstring,obligationId,pinNo,{async:false,callback: function(data){
					var success=data;
					if(data==true)
					{
						alert("PRN(s) cancelled successfully");
						if(document.getElementById('isWithoutLogin').value == "N")
							fetchSplOblHdrWebByObligationAmndRentIncomeWith("N");
					}
					else if(data==false)
					{
						alert("Cannot cancel the PRN(s). Please try again");
					}
				}
				});
			}



		}/*else{
		alert("No payment details avalible for this period");
	}*/
	}
}

function beforeAddWebRentIncomeWithHoldeeTable()
{
	ItAmnt=removeCommaFrmInput(document.getElementById('in_rentIncomeWithholdeeWebFormTable_5').value);
	TotalAmnt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
}
function afterAddWebRentIncomeWithHoldeeTable()
{
	TotalAmnt=convertToKenyanShillingFormatVal(parseInt(ItAmnt,10)+parseInt(TotalAmnt,10),true);
	document.getElementById('txtTotalAmountPaidOblig').value=TotalAmnt;
	//added for suggestion for allowing partial payment
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	
}
function afterDeleteWebRentIncomeWithHoldeeTable(rowno)
{var table = document.getElementById('rentIncomeWithholdeeWebFormTable');  
var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
var tempAmt = table.rows[rowno].cells[5].innerHTML;
totalAmt = totalAmt - parseFloat(removeCommaFrmInput(tempAmt),"10");
document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);
	
}
function beforeDeleteWebRentIncomeWithHoldeeTable()
{
	
}
function afterModifyWebRentIncomeWithHoldeeTable()
{
	var table = document.getElementById('rentIncomeWithholdeeWebFormTable');
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var newAmt=table.rows[rowno].cells[5].innerHTML;
	var newAmountArray=newAmt.split('<');
	newAmt=newAmountArray[0];
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatVal(parseInt(tmpAmt,10)+parseInt(removeCommaFrmInput(newAmt),"10")-parseInt(removeCommaFrmInput(ItAmnt),10),true); 
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true;
	//added for suggestion for allowing partial payment
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
}
function beforeModifyWebRentIncomeWithHoldeeTable(row)
{	isModifyActive=false;
	if(checkDuplicateRowsForWebRentIncomeWithholdee()){
		rowno=row;
		var table = document.getElementById('rentIncomeWithholdeeWebFormTable');
		ItAmnt=table.rows[rowno].cells[5].innerHTML;
		var amtToPaidWithHoldeeArray=ItAmnt.split('<');
		ItAmnt=amtToPaidWithHoldeeArray[0];
	}
	else {
		return false;
	}
	
}
//added for allowing partial payment
function beforeModifyRentIncomeWithholdeeTable(row){
	isModifyActive=true;
	$(".rentincomewhtradio").attr('checked' , false);
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	var table = document.getElementById('rentIncomeWithholdeeWebFormTable');
	taxperiod=table.rows[row].cells[3].innerHTML;
	var tableId = document.getElementById('rentIncomeWithWebFormLiablibilityTbl');
	for (var i = 0, n = tableId.rows.length; i <n-1; i++) {
	var rowref=document.getElementById('rentIncomeWithHoldeeWebHdrRow_'+i);
	var taxperiodtable=rowref.getElementsByTagName("TD")[1].textContent;
	if(taxperiod==taxperiodtable){
		document.getElementById('rentIncomeWithHoldeeWebFormRadio_'+i).checked=true;
		document.getElementById('actualLiabilityamount_'+i).readOnly = false;
		document.getElementById('actualLiabilityamount_'+i).className='form101_textfcurr form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
		modifyId=document.getElementById('rentIncomeWithHoldeeWebFormRadio_'+i);
	}
}
/*function validateDeleteRowITWHTWebTable(tab_str, rowno, cols)
{
	var table = document.getElementById('rentIncomeWithholdeeWebFormTable');  
	var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var tempAmt = table.rows[rowno].cells[5].innerHTML;
	totalAmt = totalAmt - parseInt(removeCommaFrmInput(tempAmt),"10");
	document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
	document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);

}*/
}

function beforeAddRentIncomeWithHoldeeFunction(row)
{
	var checkDuplicateFlag = checkMonthYearInAddRowForRentIncomeWith(row,'rentIncomeWithTable');
	if(document.getElementById('hidIsPartial').value != "Y")
	{
		if(checkDuplicateFlag){
			checkDuplicateFlag = isRentIncomeWithholdeeRegistered();
		}
	}
	if(checkDuplicateFlag==false)
	{
		return false;
	}

	else
	{
		var checkDuplicateFlag = checkDuplicateRentIncomeWithholdee(row,'rentIncomeWithTable');
		if(checkDuplicateFlag==false)
		{
			return false;
		}
		else
		{
			//taxRateWithHoldee=document.getElementById('in_withholdeeFormTable_8').value;
			rentIncomeWithHoldingTax=removeCommaFrmInput(document.getElementById('in_rentIncomeWithTable_11').value);
			amtToPaidRentIncomeWithHoldee=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
		}
	}
}

/*function checkDuplicateRentIncomeWithholdee(r,id)
{
	rows=r;
	{

		//	document.getElementById(id).value;
		var transactionDate=document.getElementById('in_withholdeeFormTable_5').value;
		var pin=document.getElementById('in_withholdeeFormTable_3').value;
		var natureOfTrans = document.getElementById('in_withholdeeFormTable_6').selectedIndex;
		var natureOfTransValue =document.getElementById('in_withholdeeFormTable_6')[natureOfTrans].text;

		var status = document.getElementById('in_withholdeeFormTable_11').value;

		var countryCd = document.getElementById('in_withholdeeFormTable_14').value;
		var tabObj1 = document.getElementById(id);
		var countryCdTableValue;
		var statusTableValue;
		if(tabObj1.rows.length==1)
		{
		}
		else
		{ 	
			for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
			{ 
				var modify;
				if(document.all)
				{
					modify=trim(tabObj1.rows[i].cells[2].innerText);
					var tableData=tabObj1.rows[i].getElementsByTagName("INPUT")[1].value.split(propertyValueDelimiterStandard);
					var countryArr=tableData[11].split(columnsDelimiterStandard);
					countryCdTableValue=countryArr[1];

					var statusArr=tableData[8].split(columnsDelimiterStandard);
					statusTableValue=statusArr[1];
				}
				else
				{
					modify=trim(tabObj1.rows[i].cells[2].textContent,"");
					var tableData=tabObj1.rows[i].getElementsByTagName("INPUT")[1].value.split(propertyValueDelimiterStandard);
					var countryArr=tableData[11].split(columnsDelimiterStandard);
					countryCdTableValue=countryArr[1];

					var statusArr=tableData[8].split(columnsDelimiterStandard);
					statusTableValue=statusArr[1];
				}
				if(document.getElementById('in_withholdeeFormTable_3').value!="")
				{
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (tabObj1.rows[i].cells[5].innerHTML==transactionDate)&&  (tabObj1.rows[i].cells[3].innerHTML==pin)&&  (tabObj1.rows[i].cells[6].innerHTML==natureOfTransValue) &&  (statusTableValue==status) && (countryCdTableValue==countryCd))
					{
						alert(detailsExists);
						return false;
					}
				}
				else
				{
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (tabObj1.rows[i].cells[5].innerHTML==transactionDate) &&  (tabObj1.rows[i].cells[6].innerHTML==natureOfTransValue) &&   (statusTableValue==status) && (countryCdTableValue==countryCd))
					{
						alert(detailsExists);
						return false;
					}
				}
			}
		}

		return true;
	}

}*/

function afterAddRentIncomeWithHoldeeFunction(rows)
{
	amtToPaidRentIncomeWithHoldee=parseFloat(rentIncomeWithHoldingTax)+parseFloat(amtToPaidRentIncomeWithHoldee);
	amtToPaidRentIncomeWithHoldee=convertToKenyanShillingFormatValWithDecimal(parseFloat(amtToPaidRentIncomeWithHoldee).toFixed(2),true);
	document.getElementById('in_rentIncomeWithTable_3').value="";
	document.getElementById('in_rentIncomeWithTable_4').value="";
	document.getElementById('in_rentIncomeWithTable_12').value="";
	document.getElementById('in_rentIncomeWithTable_13').value="";
	document.getElementById('in_rentIncomeWithTable_14').value="";
	document.getElementById('in_rentIncomeWithTable_5').value="";
	document.getElementById('in_rentIncomeWithTable_6').value="";
	document.getElementById('in_rentIncomeWithTable_7').value="";
	document.getElementById('in_rentIncomeWithTable_8').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_9').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_15').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_16').value="";
	document.getElementById('in_rentIncomeWithTable_17').value="";
	document.getElementById('in_rentIncomeWithTable_18').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_19').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_21').value="";
	document.getElementById('in_rentIncomeWithTable_20').value="";
	document.getElementById('in_rentIncomeWithTable_10').value=0;
	document.getElementById('in_rentIncomeWithTable_11').value=0;
	document.getElementById('txtTotalAmountPaidOblig').value=amtToPaidRentIncomeWithHoldee;
	selectedFlagRentIncomeWithHoldee=selectedFlagRentIncomeWithHoldee+1;
	
	/*document.getElementById('in_withholdeeFormTable_8').value=0;
	document.getElementById('in_withholdeeFormTable_9').value=0;
	document.getElementById('txtTotalAmountPaidOblig').value=amtToPaidWithHoldee;
	document.getElementById('in_withholdeeFormTable_14').value="OTR";
	document.getElementById('in_withholdeeFormTable_14').disabled=true;
	document.getElementById('in_withholdeeFormTable_6').selectedIndex=0;
	selectedFlagWithHoldee=selectedFlagWithHoldee+1;
	if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
	{
		var tabObj1 = document.getElementById('withholdeeFormTable');
		for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
		{ 
			document.getElementById('id_withholdeeFormTable_'+i+'_2').href = '#'; 
			document.getElementById('id_withholdeeFormTable_'+i+'_2').style.visibility = 'hidden'; 
		}
		document.getElementById('withHoldeeRadio_'+rowNumbmerPartial).checked=false;
		selectedFlagPartial=selectedFlagPartial+1;
	}
	document.getElementById('in_withholdeeFormTable_8').style.display="";
	document.getElementById('WithholdingTax').style.display="";
	document.getElementById('in_withholdeeFormTable_9').readOnly=true;
	document.getElementById('in_withholdeeFormTable_9').className='readonlyInput form101_textfcurr_width textonlyRight';
	document.getElementById('in_withholdeeFormTable_4').readOnly=true;
	document.getElementById('in_withholdeeFormTable_12').readOnly=true;
	document.getElementById('in_withholdeeFormTable_15').readOnly=true;
	document.getElementById('in_withholdeeFormTable_4').className='readonlyInput form101_textfcurr_width';
	document.getElementById('in_withholdeeFormTable_12').className='readonlyInput form101_textfcurr_width';
	document.getElementById('in_withholdeeFormTable_15').className='readonlyInput form101_textfcurr_width';*/
	createSkipFieldForAddRow('rentIncomeWithTable','paymentRegForm');
	sessionTimeOut=sessionTime;
	displaySessionTimeOut();

}

function afterDeleteRentIncomeWithHoldeeTable()
{
	deleteFlagRentIncomeWithHoldee = 1;
}

//added for allowing partial payment
function afterModifyRentIncomeWithholdeeTable(){
	
}

function afterModifyRentIncomeWithHoldeeTable() 
{
	modifyFlagRentIncomeWithHoldee = 0;
	commonModifyFlag=0;
	var table = document.getElementById('rentIncomeWithTable');
	/*document.getElementById('in_withholdeeFormTable_8').value=0;
	document.getElementById('in_withholdeeFormTable_14').value="OTR";
	document.getElementById('in_withholdeeFormTable_14').disabled=true;
	document.getElementById('in_withholdeeFormTable_6').selectedIndex=0;*/
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var modifyAmt;
	if(document.all)
	{
		modifyAmt=table.rows[rowno].cells[11].innerText;
	}
	else
	{
		modifyAmt=table.rows[rowno].cells[11].textContent;
	}
	document.getElementById('txtTotalAmountPaidOblig').value=convertToKenyanShillingFormatValWithDecimal(parseFloat(tmpAmt,10)+parseFloat(removeCommaFrmInput(modifyAmt),"10")-parseFloat(removeCommaFrmInput(amtToPaidRentIncomeWithHoldee),10),true); 
	document.getElementById('txtTotalAmountPaidOblig').readOnly=true; 
	document.getElementById('txtTotalAmountPaidOblig').className='readonlyInput form101_textfcurr_width textonlyRight';
	/*document.getElementById('withholdeeFormRow1').style.display="";
	document.getElementById('withholdeeFormRow2').style.display="";
	document.getElementById('in_withholdeeFormTable_4').readOnly=true;
	document.getElementById('in_withholdeeFormTable_12').readOnly=true;
	document.getElementById('in_withholdeeFormTable_15').readOnly=true;
	document.getElementById('in_withholdeeFormTable_4').className='readonlyInput form101_textfcurr_width';
	document.getElementById('in_withholdeeFormTable_12').className='readonlyInput form101_textfcurr_width';
	document.getElementById('in_withholdeeFormTable_15').className='readonlyInput form101_textfcurr_width';*/
	
	document.getElementById('in_rentIncomeWithTable_3').value="";
	document.getElementById('in_rentIncomeWithTable_4').value="";
	document.getElementById('in_rentIncomeWithTable_12').value="";
	document.getElementById('in_rentIncomeWithTable_13').value="";
	document.getElementById('in_rentIncomeWithTable_14').value="";
	document.getElementById('in_rentIncomeWithTable_5').value="";
	document.getElementById('in_rentIncomeWithTable_6').value="";
	document.getElementById('in_rentIncomeWithTable_7').value="";
	document.getElementById('in_rentIncomeWithTable_8').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_9').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_15').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_16').value="";
	document.getElementById('in_rentIncomeWithTable_17').value="";
	document.getElementById('in_rentIncomeWithTable_18').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_19').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_21').value="";
	document.getElementById('in_rentIncomeWithTable_20').value="";
	document.getElementById('in_rentIncomeWithTable_10').value=0;
	document.getElementById('in_rentIncomeWithTable_11').value=0;
	
	/*var modifyAmt1;
	if(document.all)
	{
		modifyAmt1=(table.rows[rowno].cells[7].innerText);
	}
	else
	{
		modifyAmt1=table.rows[rowno].cells[7].textContent;
	}*/
}

function beforeModifyRentIncomeWithHoldeeTable(row) 
{
	if(addRentIncomeWithHoldeeData())
	{
		/*var checkDuplicateFlag = confirmForPartialWithholdee();
		if(checkDuplicateFlag==false)
		{
			return false;
		}*/
		if(isFalse==1){
			return false;
		}
		else
		{
			var checkDuplicateFlag = checkDuplicateRentIncomeWithholdee(row,'rentIncomeWithTable');
			if(checkDuplicateFlag==false)
			{
				return false;
			}
			if(isFalse==1){
				return false;
			}
			else
			{
				var table = document.getElementById('rentIncomeWithTable');
				amtToPaidRentIncomeWithHoldee=table.rows[rowno].cells[11].innerHTML;
				//taxRateWithHoldee=document.getElementById('in_withholdeeFormTable_8').value;
			}
		}
	}
	else
	{
		return false;
	}

}

function beforeDeleteRentIncomeWithHoldee()
{
	if(modifyFlagRentIncomeWithHoldee==1)
	{
		alert(confirmModifyingOperation);
		return false;
	}
}

function checkMonthYearInAddRowForRentIncomeWith(r,id)
{
	rows=r;
	{

		document.getElementById(id).value;
		var transactionDate=document.getElementById('in_'+id+'_20').value.substr(2, document.getElementById('in_'+id+'_20').value.length);
		var tabObj1 = document.getElementById(id);
		if(tabObj1.rows.length==1)
		{
		}
		else
		{ 	
			for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
			{ 
				var tableData=tabObj1.rows[i].getElementsByTagName("INPUT")[1].value.split(propertyValueDelimiterStandard);

				var dateFromArray=tableData[17].split(columnsDelimiterStandard);
				dateFromValue=dateFromArray[1];
				
				if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" &&  (dateFromValue.substr(2, dateFromValue.length)!=transactionDate) && (tabObj1.rows[i].cells[2].innerHTML.indexOf('Modifying')==-1))
				{
					alert(cntGenPaymentslip);
					return false;
				}
			}
		}

		return true;
	}

}

function isRentIncomeWithholdeeRegistered(){
	var taxpayerId = document.getElementById('hidTaxPayerId').value;
	var obligationId = rentIncomeWith;
	
	var landlordPin = document.getElementById('in_rentIncomeWithTable_3').value;	
	var county = document.getElementById('in_rentIncomeWithTable_8').value;
	var district = document.getElementById('in_rentIncomeWithTable_9').value;
	var locality = document.getElementById('in_rentIncomeWithTable_15').value;
	var dateFrom = document.getElementById('in_rentIncomeWithTable_20').value;
	var dateTo = document.getElementById('in_rentIncomeWithTable_21').value;
		
	var PmtSplDetailVO = {
			taxpayerId  : taxpayerId,
			obligationId : obligationId,
			landlordPin : landlordPin,
			county : county,
			district : district,
			locality : locality,
			dateFrom : dateFrom,
			dateTo : dateTo
	};

	if(isSplObligationRegisteredWeb(PmtSplDetailVO))
		return true;
	else
		return false;

}


function addWebRentIncomeWithHoldeeData(){
	resetErrorList();	
	if(addConfirm('a_rentIncomeWithholdeeWebFormTable'))
	{
		if(checkDuplicateRowsForWebRentIncomeWithholdee())
		{
			if(document.getElementById('a_rentIncomeWithholdeeWebFormTable').innerHTML!="Modify")
			{			
				addrow('rentIncomeWithholdeeWebFormTable', '3', '3','5','','','N','N');

			}
			else
			{
				return true;
			}
		}
		
	}
	else{
		isFalse=1;
	}

}

function validateDeleteRowRentIncomeWithWebTable(tab_str, rowno, cols)
{
	var table = document.getElementById('rentIncomeWithholdeeWebFormTable');  
	var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
	var tempAmt = table.rows[rowno].cells[5].innerHTML;
	totalAmt = totalAmt - parseFloat(removeCommaFrmInput(tempAmt),"10");
	document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
	document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalAmountPaidOblig").value, true);

}

function checkDuplicateRowsForWebRentIncomeWithholdee()
{
	var table = document.getElementById('rentIncomeWithholdeeWebFormTable');
	var amt = document.getElementById('in_rentIncomeWithholdeeWebFormTable_4').value;
	var taxPeriod= document.getElementById('in_rentIncomeWithholdeeWebFormTable_3').value;
	if(amt =="" || amt==null|| taxPeriod=="" || taxPeriod==null){
		alert("Please select a row to be added first.");
		return false;
	}
		if(!(table.rows.length==1))
		{ 	
			for (var i = 1, n = table.rows.length; i <n; i++) 
			{ 
				modify=trim(table.rows[i].cells[2].getElementsByTagName('A')[0].innerHTML);
				if((trim(document.getElementById('id_temp_'+'rentIncomeWithholdeeWebFormTable'+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&
					(table.rows[i].cells[3].innerHTML==taxPeriod))
				{
					alert("You already added this details.");
					return false;
				}
			}
		}
		return true;
}

function checkLandlordPin(id)
{
	if(document.getElementById('hidPinNo').value==document.getElementById(id).value)
	{
		document.getElementById(id).value="";
		if(document.getElementById('cmbPaymentType').value=="SAT")
		{
			alert("Tenant PIN and Landlord PIN cannot be same.");
			return false;
		}
		else
		{
			alert("Taxpayer PIN and Agent PIN cannot be same.");
			return false;
		}
	}
	else
	{
		return true;
	}
}

function onchangeWithholPINRentIncomeWith(obj)
{
	var pin = trim(obj.value);
	pin=pin.toUpperCase();
	var taxPayerId= document.getElementById('hidTaxPayerId').value;
	if(validPIN(obj)){
		resetLandlordDtls();
		FetchTaxpayerDetailRentIncomeWith.fetchTaxpayerDetailRentIncomeWith(pin,taxPayerId,{async:false,callback: function(data){
			if(data != NULL &&  data != null){
				if(data.isDataAvailable == N_FLAG){
					if(data.isAgent == ERROR ||data.isAgent == NO_CALL_MADE){ // Handled Scenario : 1) if no call made from Controller to impl 2) impl to facade
						alert(errorFetchingData);
					}
					else if(data.isAgent == NO_DETAILS_FOUND){// Handled Scenario : 1) call made to facade with invalid PIN
						alert(validPin);
					}
					resetRentIncomeWithholdeeInfoInWith();
					return false;
				}
				//Added by Mingu for handling PIN Without obligation :: START
				if(data.isPinWithNoOblig != null && data.isPinWithNoOblig == 'Y'){
					alert("This PIN is non-transactional and will require additional of the relevant obligations to progress")
					resetRentIncomeWithholdeeInfoInWith();
					return false;
				}
				//Added by Mingu for handling PIN Without obligation :: END
				if(data.taxPayerFirstName != null || data.taxPayerId != null){
					
					document.getElementById('in_rentIncomeWithTable_22').value = data.taxPayerId;
					
					if(data.taxPayerFirstName != null && data.taxPayerFirstName!="")
					{
						document.getElementById('in_rentIncomeWithTable_4').value=data.taxPayerFirstName;
						document.getElementById('in_rentIncomeWithTable_4').readOnly=true;
						document.getElementById('in_rentIncomeWithTable_4').className='readonlyInput form101_textfcurr_width';
					}
					
					if(data.emailId != null && data.emailId!="")
					{
						document.getElementById('in_rentIncomeWithTable_13').value=data.emailId;
						document.getElementById('in_rentIncomeWithTable_13').readOnly=true;
						document.getElementById('in_rentIncomeWithTable_13').className='readonlyInput form101_textfcurr_width';
					}
					
					if(data.taxPayerFullAddr != null && data.taxPayerFullAddr!="")
					{
						//document.getElementById('in_rentIncomeWithTable_13').value=data.emailId;
						dwr.util.setValue('landlordAdd',data.taxPayerFullAddr);
						document.getElementById('in_rentIncomeWithTable_12').readOnly=true;
						document.getElementById('in_rentIncomeWithTable_12').className='readonlyInput form101_textfcurr_width';
					}
					
					/*if(data.lrNumber != null && data.lrNumber!="")
					{
						//document.getElementById('in_rentIncomeWithTable_14').readOnly=true;
						//document.getElementById('in_rentIncomeWithTable_14').className='readonlyInput form101_textfcurr_width';
						document.getElementById('in_rentIncomeWithTable_14').value=data.lrNumber;
					}
					if(data.building != null && data.building!="")
					{
						//document.getElementById('in_rentIncomeWithTable_5').readOnly=true;
						//document.getElementById('in_rentIncomeWithTable_5').className='readonlyInput form101_textfcurr_width';
						document.getElementById('in_rentIncomeWithTable_5').value=data.building;
					}
					if(data.street != null && data.street!="")
					{
						//document.getElementById('in_rentIncomeWithTable_6').readOnly=true;
						//document.getElementById('in_rentIncomeWithTable_6').className='readonlyInput form101_textfcurr_width';
						document.getElementById('in_rentIncomeWithTable_6').value=data.street;
					}
					if(data.city != null && data.city!="")
					{
						//document.getElementById('in_rentIncomeWithTable_7').readOnly=true;
						//document.getElementById('in_rentIncomeWithTable_7').className='readonlyInput form101_textfcurr_width';
						document.getElementById('in_rentIncomeWithTable_7').value=data.city;
					}
					if(data.descAddress != null && data.descAddress!="")
					{
						//document.getElementById('in_rentIncomeWithTable_16').readOnly=true;
						//document.getElementById('in_rentIncomeWithTable_16').className='readonlyInput form101_textfcurr_width';
						dwr.util.setValue('descAddr',data.descAddress);
						//document.getElementById('in_rentIncomeWithTable_7').value=data.city;
					}
					if(data.poBox != null && data.poBox!="")
					{
						//document.getElementById('in_rentIncomeWithTable_17').readOnly=true;
						//document.getElementById('in_rentIncomeWithTable_17').className='readonlyInput form101_textfcurr_width';
						document.getElementById('in_rentIncomeWithTable_17').value=data.poBox;
					}
					if(data.county != null)
					{
						var s=document.getElementById('in_rentIncomeWithTable_8');
						var v=data.county;
						for ( var i = 0; i < s.options.length; i++ ) {
					        if ( s.options[i].value == v ) {
					            s.options[i].selected = true;
					            selectDistrictByCountryRentIncomeWith('in_rentIncomeWithTable_8','in_rentIncomeWithTable_9');
					            //document.getElementById('in_rentIncomeWithTable_8').disabled=true;
					           // isCountyDisabled=true;
					           // return;
					        }
					    }
						
					}
					if(data.district != null)
					{
						var s=document.getElementById('in_rentIncomeWithTable_9');
						var v=data.district;
						for ( var i = 0; i < s.options.length; i++ ) {
					        if ( s.options[i].value == v ) {
					            s.options[i].selected = true;
					            selectLocalityByDistrictRentIncomeWith('in_rentIncomeWithTable_9','in_rentIncomeWithTable_15');
					           // document.getElementById('in_rentIncomeWithTable_9').disabled=true;
					           // isDistrictDisabled=true;
					           // return;
					        }
					    }
						
					}
					if(data.locality != null)
					{
						var s=document.getElementById('in_rentIncomeWithTable_15');
						var v=data.locality;
						for ( var i = 0; i < s.options.length; i++ ) {
					        if ( s.options[i].value == v ) {
					            s.options[i].selected = true;
					           // document.getElementById('in_rentIncomeWithTable_15').disabled=true;
					          //  isLocalityDisabled=true;
					          //  return;
					        }
					    }
					}
					if(data.postalCode != null)
					{
						var selectObj=document.getElementById('in_rentIncomeWithTable_18');
						var valueToSet=data.postalCode;
						for (var i = 0; i < selectObj.options.length; i++) {
					        if (selectObj.options[i].text== valueToSet) {
					            selectObj.options[i].selected = true;
					            document.getElementById('in_rentIncomeWithTable_19').value=document.getElementById('in_rentIncomeWithTable_18').options[document.getElementById('in_rentIncomeWithTable_18').selectedIndex].text;// selectedIndex.title;
					            document.getElementById('in_rentIncomeWithTable_18').disabled=true;
					            document.getElementById('in_rentIncomeWithTable_19').disabled=true;
					            isPostOfcDisabled=true;
					            isPostCodeDisabled=true;
					            //return;
					        }
					    }
					}
					*/
					/*taxPayerType=data.taxPayerType;
					citizenshipCode=data.taxPayerCitizenshipCode;
					toCheckPinIndiOrNonIndi();*/
					// changes made for the suggestion in PR#52 and MOM  15022016v1.0
					//errorDTOList=this.checkForCitizenship(pmtCustomDTO.getPmtSplWithholidingDtlDTOList());
					/*if(indiNonIndiCheck){
						checkResidentOrNonResident();
					}*/
					//indiNonIndiCheck=true;
				}
				if(data.taxPayerFirstName == NULL || data.taxPayerFirstName == null){
					resetRentIncomeWithholdeeInfoInWith();
					alert(validPin);
					
					return false;
				}
			}
			else{
				alert(errorFetchingData);
				resetRentIncomeWithholdeeInfoInWith();
				return false;
			}

		}});
		return true;
	}
	else{
		resetRentIncomeWithholdeeInfoInWith();
		return false;
	}
}

function resetRentIncomeWithholdeeInfoInWith(){
	document.getElementById('in_rentIncomeWithTable_3').value="";
	document.getElementById('in_rentIncomeWithTable_4').value="";
	document.getElementById('in_rentIncomeWithTable_5').value="";
	document.getElementById('in_rentIncomeWithTable_6').value="";
	document.getElementById('in_rentIncomeWithTable_7').value="";
	document.getElementById('in_rentIncomeWithTable_8').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_9').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_10').value="";
	document.getElementById('in_rentIncomeWithTable_11').value="";
	document.getElementById('in_rentIncomeWithTable_12').value="";
	document.getElementById('in_rentIncomeWithTable_13').value="";
	document.getElementById('in_rentIncomeWithTable_14').value="";
	document.getElementById('in_rentIncomeWithTable_15').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_16').value="";
	document.getElementById('in_rentIncomeWithTable_17').value="";
	document.getElementById('in_rentIncomeWithTable_18').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_19').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_20').value="";
	document.getElementById('in_rentIncomeWithTable_21').value="";
	/*removeOptions(document.getElementById("in_rentIncomeWithTable_9"));
	removeOptions(document.getElementById("in_rentIncomeWithTable_15"));*/
	selectLocalityByDistrictRentIncomeWith('in_rentIncomeWithTable_9','in_rentIncomeWithTable_15');
	selectDistrictByCountryRentIncomeWith('in_rentIncomeWithTable_8','in_rentIncomeWithTable_9');
}

function resetLandlordDtls(){
	
	document.getElementById('in_rentIncomeWithTable_4').value="";
	document.getElementById('in_rentIncomeWithTable_5').value="";
	document.getElementById('in_rentIncomeWithTable_6').value="";
	document.getElementById('in_rentIncomeWithTable_7').value="";
	document.getElementById('in_rentIncomeWithTable_8').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_9').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_10').value="";
	document.getElementById('in_rentIncomeWithTable_11').value="";
	document.getElementById('in_rentIncomeWithTable_12').value="";
	document.getElementById('in_rentIncomeWithTable_13').value="";
	document.getElementById('in_rentIncomeWithTable_14').value="";
	document.getElementById('in_rentIncomeWithTable_15').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_16').value="";
	document.getElementById('in_rentIncomeWithTable_17').value="";
	document.getElementById('in_rentIncomeWithTable_18').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_19').selectedIndex=0;
	document.getElementById('in_rentIncomeWithTable_20').value="";
	document.getElementById('in_rentIncomeWithTable_21').value="";
	/*removeOptions(document.getElementById("in_rentIncomeWithTable_9"));
	removeOptions(document.getElementById("in_rentIncomeWithTable_15"));*/
	selectLocalityByDistrictRentIncomeWith('in_rentIncomeWithTable_9','in_rentIncomeWithTable_15');
	selectDistrictByCountryRentIncomeWith('in_rentIncomeWithTable_8','in_rentIncomeWithTable_9');
}

function calcRentIncomeWithHoldingTax()
{
	/*var taxRate= document.getElementById("rentIncomeWithRate").value;*/
	var taxRate;
	var dateFrom = document.getElementById('in_rentIncomeWithTable_20').value;
	/*taxRate =  parseInt(taxRate, 10);*/	
	var year=dateFrom.substr(6);
	var month=dateFrom.substr(3, 2);
	//if( new Date(dateFrom)>= new Date("01/07/2023") ){
	if(parseInt(year) > 2023 ){
		taxRate=7.5;
	}else{
		taxRate=10;
	}
	var grossAmt=removeCommaFrmInput(document.getElementById('in_rentIncomeWithTable_10').value);
	if(grossAmt!="")
	{
		withHoldingTax=parseInt(grossAmt,10)*parseFloat(taxRate)/parseInt(100,10);
		document.getElementById('in_rentIncomeWithTable_11').value=convertToKenyanShillingFormatValWithDecimal(Math.ceil(withHoldingTax),true);
/*		document.getElementById('in_rentIncomeWithTable_11').value=convertToKenyanShillingFormatValWithDecimal(withHoldingTax,true);
*/		
	}
	document.getElementById('in_rentIncomeWithTable_10').value=convertToKenyanShillingFormatVal(grossAmt,true);
}

function validateDateToAgainstDateFrom(obj,lableName){
	var date = obj.value;
	var regDate = document.getElementById('in_rentIncomeWithTable_20').value;
	if(validateDateForFromDateValue(date,regDate)){
		//return true;
		validateToDate();
	}
	else{
		//alert(lableName+" should be after Taxpayer Registration Date");
		alert("Please select "+lableName+" after date from Date "+regDate );
		obj.value = "";
		obj.focus();
		return false;
	}
}

function validateDateForFromDateValue(date,regDate){
	/*regDate = regDate.substring(2);
	regDate = "01"+regDate;*/
	//alert("in payment.js-->validateDateForTaxpayerRegDateValue-->reg date is-->"+regDate);
	if (isEqual(date, regDate)) {
		return true;
	}
	else if (!fnCompareDates(date, regDate)){
		return true;
	} 
	else{
		return false;
	}
	return true;
}

function validateToDate()
{
	var fromDate=document.getElementById('in_rentIncomeWithTable_20').value.substr(2, document.getElementById('in_rentIncomeWithTable_20').value.length);
	var toDate=document.getElementById('in_rentIncomeWithTable_21').value.substr(2, document.getElementById('in_rentIncomeWithTable_21').value.length);
	
	if(fromDate!=toDate)
	{
		alert('Date To must be of same month as Date From');
		document.getElementById('in_rentIncomeWithTable_21').value="";
		return false;
	}
	else
		return true;
}

function onChangeDateFrom()
{
	var dateFrom = document.getElementById('in_rentIncomeWithTable_20').value;
	var year=dateFrom.substr(6);
	var month=dateFrom.substr(3, 2);
	//if( new Date(dateFrom)>= new Date("01/07/2023") ){
	if((parseInt(year)==2023 && parseInt(month)>=7) || parseInt(year) > 2023 ){
	//if( new Date(dateFrom)>= new Date("01/07/2023") ){
	
	}else{
		document.getElementById('in_rentIncomeWithTable_21').value="";
	}
}

function addRentIncomeWithHoldeeData(row)
{
	resetErrorList();
	/*if(validateFormFields(rentIncomeWithJSON))
	{*/
		/*document.getElementById('in_withholdeeFormTable_3').readOnly=true;
		document.getElementById('in_withholdeeFormTable_3').className='readonlyInput form101_textfcurr_width';
		document.getElementById('in_withholdeeFormTable_4').readOnly=true;
		document.getElementById('in_withholdeeFormTable_12').readOnly=true;
		document.getElementById('in_withholdeeFormTable_15').readOnly=true;
		document.getElementById('in_withholdeeFormTable_4').className='readonlyInput form101_textfcurr_width';
		document.getElementById('in_withholdeeFormTable_12').className='readonlyInput form101_textfcurr_width';
		document.getElementById('in_withholdeeFormTable_15').className='readonlyInput form101_textfcurr_width';*/
		document.getElementById('in_rentIncomeWithTable_8').disabled=false;
		document.getElementById('in_rentIncomeWithTable_9').disabled=false;
		document.getElementById('in_rentIncomeWithTable_15').disabled=false;
		document.getElementById('in_rentIncomeWithTable_18').disabled=false;
		document.getElementById('in_rentIncomeWithTable_19').disabled=false;
		document.getElementById('in_rentIncomeWithTable_25').disabled=false;
		if(validateFormFields(rentIncomeWithJSON))
		{
			hideTab('TabView',2);
			resetErrorList();
			incError=0;
			var checkDuplicateFlag = checkMonthYearInAddRowRentIncomeWith(row,'rentIncomeWithTable');
			if(checkDuplicateFlag==false)
			{
				return false;
			}
			var checkDuplicateFlag = checkDuplicateRentIncomeWithholdee(row,'rentIncomeWithTable');
			if(checkDuplicateFlag==false)
			{
				return false;
			}
			if( removeCommaFrmInput(document.getElementById('in_rentIncomeWithTable_10').value)>0  &&  removeCommaFrmInput(document.getElementById('in_rentIncomeWithTable_11').value)>0 )
			{
				if(addConfirm('a_rentIncomeWithTable'))
				{
					if(document.getElementById('a_rentIncomeWithTable').innerHTML!="Modify")
					{
						/*if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
						{
							addrow('withholdeeFormTable', '7', '18','4','validateDeleteRowWithHoldeeTable','validateModifyRowWithHoldeeTable','N','N','','7,8');
						}
						else
						{*/
							addrow('rentIncomeWithTable', '9', '23','','validateDeleteRowRentIncomeWithHoldeeTable','validateModifyRowRentIncomeWithHoldeeTable','N','N');
						/*}*/
					}
					else
					{
						return true;
					}
				}
				else{
					isFalse=1;
				}
			}
			else
			{
				document.getElementById('in_rentIncomeWithTable_11').value=0;
				document.getElementById('in_rentIncomeWithTable_10').value="";
				alert(taxGreaterThanZero);
				return false;
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}

		if(isCountyDisabled)
			document.getElementById('in_rentIncomeWithTable_8').disabled=true;
		if(isDistrictDisabled)
			document.getElementById('in_rentIncomeWithTable_9').disabled=true;
		if(isLocalityDisabled)
			document.getElementById('in_rentIncomeWithTable_15').disabled=true;
		if(isPostOfcDisabled)	
			document.getElementById('in_rentIncomeWithTable_18').disabled=true;
		if(isPostCodeDisabled)
			document.getElementById('in_rentIncomeWithTable_19').disabled=true;
		
	/*}*/
	/*else
	{
		getErrTabToggle('TabView','2');	
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}*/


}

function checkMonthYearInAddRowRentIncomeWith(r,id)
{
	rows=r;
	{
		document.getElementById(id).value;
		var transactionDate=document.getElementById('in_'+id+'_20').value.substr(2, document.getElementById('in_'+id+'_20').value.length);
		var tabObj1 = document.getElementById(id);
		if(tabObj1.rows.length==1)
		{
		}
		else
		{ 	
			for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
			{ 
				var tableData=tabObj1.rows[i].getElementsByTagName("INPUT")[1].value.split(propertyValueDelimiterStandard);

				var dateFromArray=tableData[17].split(columnsDelimiterStandard);
				dateFromValue=dateFromArray[1];
				
				
				//Added on 18/07/2022 Ticket # Finance act 2023 changes
				var dateToBeAdded=document.getElementById('in_'+id+'_20').value
				var year=dateFromValue.substr(6);
				var month1=dateFromValue.substr(3, 2);
				if((parseInt(year)==yearFa2023 && parseInt(month1)>=mnthRFa2023) || parseInt(year) > yearFa2023 ){
				if(dateFromValue!=dateToBeAdded)
					{//alert(declareAllTransInAMonth);
						//alert("You cannot generate the payment slip with multiple Transactions of different Day/Month/Year.");
						alert("Please declare transactions with similar payment dates (Day/Month/Year). For different payment dates, capture the transactions in separate payment slip.");
						return false;
					}
				}else{
				//End on 18/07/2022 Ticket # Finance act 2023 changes
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" &&  (dateFromValue.substr(2, dateFromValue.length)!=transactionDate) && (tabObj1.rows[i].cells[2].innerHTML.indexOf('Modifying')==-1))
					{
						alert(cntGenPaymentslip);
						return false;
					}
				}
			}
		}

		return true;
	}

}

function checkDuplicateRentIncomeWithholdee(r,id)
{
	rows=r;
	{
		var dateFrom=document.getElementById('in_rentIncomeWithTable_20').value;
		var pin=document.getElementById('in_rentIncomeWithTable_3').value;
		var countyId = document.getElementById('in_rentIncomeWithTable_8').selectedIndex;
		var taxArea = document.getElementById('in_rentIncomeWithTable_15').value;
		var districtId = document.getElementById('in_rentIncomeWithTable_9').selectedIndex;
		var dateTo = document.getElementById('in_rentIncomeWithTable_21').value;
		var county = document.getElementById('in_rentIncomeWithTable_8')[countyId].text;
		var district = document.getElementById('in_rentIncomeWithTable_9')[districtId].text;
		//var taxArea = document.getElementById('in_rentIncomeWithTable_15')[taxAreaId].text;
		/*var natureOfTrans = document.getElementById('in_withholdeeFormTable_6').selectedIndex;
		var natureOfTransValue =document.getElementById('in_withholdeeFormTable_6')[natureOfTrans].text;

		var status = document.getElementById('in_withholdeeFormTable_11').value;

		var countryCd = document.getElementById('in_withholdeeFormTable_14').value;*/
		var tabObj1 = document.getElementById(id);
		var taxAreaValue;
		var dateFromValue;
		var dateToValue;
		
		if(tabObj1.rows.length==1)
		{
		}
		else
		{ 	
			for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
			{ 
				var modify;
				if(document.all)
				{
					modify=trim(tabObj1.rows[i].cells[2].innerText);
					var tableData=tabObj1.rows[i].getElementsByTagName("INPUT")[1].value.split(propertyValueDelimiterStandard);
					var taxAreaArray=tableData[12].split(columnsDelimiterStandard);
					taxAreaValue=taxAreaArray[1];

					var dateFromArray=tableData[17].split(columnsDelimiterStandard);
					dateFromValue=dateFromArray[1];
					
					var dateToArray=tableData[18].split(columnsDelimiterStandard);
					dateToValue=dateToArray[1];
				}
				else
				{
					modify=trim(tabObj1.rows[i].cells[2].textContent,"");
					var tableData=tabObj1.rows[i].getElementsByTagName("INPUT")[1].value.split(propertyValueDelimiterStandard);
					var taxAreaArray=tableData[12].split(columnsDelimiterStandard);
					taxAreaValue=taxAreaArray[1];

					var dateFromArray=tableData[17].split(columnsDelimiterStandard);
					dateFromValue=dateFromArray[1];
					
					var dateToArray=tableData[18].split(columnsDelimiterStandard);
					dateToValue=dateToArray[1];
				}
				if(document.getElementById('in_rentIncomeWithTable_3').value!="")
				{
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (tabObj1.rows[i].cells[8].innerHTML==county)&&  (tabObj1.rows[i].cells[3].innerHTML==pin) &&  (tabObj1.rows[i].cells[9].innerHTML==district) &&  (dateFromValue==dateFrom) && (dateToValue==dateTo) && (taxAreaValue==taxArea))
					{
						alert(detailsExists);
						return false;
					}
				}
				/*else
				{
					if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete" && (modify=="Modify") &&  (tabObj1.rows[i].cells[20].innerHTML==transactionDate) &&  (tabObj1.rows[i].cells[6].innerHTML==natureOfTransValue) &&   (statusTableValue==status) && (countryCdTableValue==countryCd))
					{
						alert(detailsExists);
						return false;
					}
				}*/
			}
		}

		return true;
	}

}

function validateDeleteRowRentIncomeWithHoldeeTable(tab_str, rowno, cols) 
{
	if(deleteFlagRentIncomeWithHoldee==1 && modifyFlagRentIncomeWithHoldee==0)
	{
		var table = document.getElementById('rentIncomeWithTable');  
		var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value);
		var tempAmt = table.rows[rowno].cells[11].innerHTML;
		totalAmt = totalAmt - parseFloat(removeCommaFrmInput(tempAmt),"10");
		document.getElementById('txtTotalAmountPaidOblig').value =  totalAmt;
		document.getElementById('txtTotalAmountPaidOblig').value = convertToKenyanShillingFormatValWithDecimal(document.getElementById("txtTotalAmountPaidOblig").value, true);
		selectedFlagRentIncomeWithHoldee=selectedFlagRentIncomeWithHoldee-1;
		if(selectedFlagRentIncomeWithHoldee==0)
		{
			clear_table_data('rentIncomeWithTable');
		}
		/*if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
		{
			selectedFlagPartial=selectedFlagPartial-1;
		}*/
		deleteFlagRentIncomeWithHoldee = 0;
		//currentPaymentWithHoldee();
	}
	else
	{
		deleteFlagRentIncomeWithHoldee = 0;
	}
}

function validateModifyRowRentIncomeWithHoldeeTable(tab_str, rowno, cols) 
{
	modifyFlagRentIncomeWithHoldee = 1;
	commonModifyFlag=1;
	/*var transType=document.getElementById('in_withholdeeFormTable_6').value;
	if(transType=="WHT_0300" || transType=="WHT_0402" || transType=="WHT_0400" || transType=="WHT_0401"|| transType=="WHT_0411")
	{
		document.getElementById('in_withholdeeFormTable_14').disabled=false; 
	}
	else
	{
		document.getElementById('in_withholdeeFormTable_14').disabled=true;
		document.getElementById('in_withholdeeFormTable_14').value="OTR";
	}
	onChangeComboData();
	fetchWithholdeeTaxRate();
	hideTaxRateCombo();
	if(document.getElementById('in_withholdeeFormTable_3').value!=''){
		document.getElementById('in_withholdeeFormTable_4').readOnly=true;
		document.getElementById('in_withholdeeFormTable_12').readOnly=true;
		document.getElementById('in_withholdeeFormTable_15').readOnly=true;
		document.getElementById('in_withholdeeFormTable_4').className='readonlyInput form101_textfcurr_width';
		document.getElementById('in_withholdeeFormTable_12').className='readonlyInput form101_textfcurr_width';
		document.getElementById('in_withholdeeFormTable_15').className='readonlyInput form101_textfcurr_width';
	}else{
		document.getElementById('in_withholdeeFormTable_4').readOnly=false;
		document.getElementById('in_withholdeeFormTable_12').readOnly=false;
		document.getElementById('in_withholdeeFormTable_15').readOnly=false;
		document.getElementById('in_withholdeeFormTable_4').className='form101_textfcurr form101_textfcurr_width';
		document.getElementById('in_withholdeeFormTable_12').className='form101_textfcurr form101_textfcurr_width';
		document.getElementById('in_withholdeeFormTable_15').className='form101_textfcurr form101_textfcurr_width';
	}*/

}

function selectDistrictByCountryRentIncomeWith(countryId,districtId,districtValue)
{
    var selectedCountyId="";
    var isdistrictComboLength=0;

    selectedCountyId=document.getElementById(countryId).value;
    isdistrictComboLength=document.getElementById(districtId).length;
   
    for(var i=isdistrictComboLength;i>0;i--)
    {
        document.getElementById(districtId).remove(i);
    }
   
    if(selectedCountyId != '')
    {     
        var index = 0;
        var arrayLength = districtArray.length;
        while(index < arrayLength)
        {
            if(districtArray[index].countyId == selectedCountyId)
            {
                var optionObj = document.createElement("option");
                optionObj.text = districtArray[index].description;
                optionObj.value = districtArray[index].districtId;
                optionObj.title= districtArray[index].description;
                if(districtValue==districtArray[index].districtId)
                {
                    optionObj.selected = "selected";
                }
				document.getElementById(districtId).options[document.getElementById(districtId).options.length] = optionObj; 
                
            }
            index++;
        }
    }
}
function selectLocalityByDistrictRentIncomeWith(districtId,localityId,localityValue)
{
	var selectedDistrictId="";
    var islocalityComboLength=0;
    
    selectedDistrictId=document.getElementById(districtId).value;
    islocalityComboLength=document.getElementById(localityId).length;
    
    for(var i=islocalityComboLength;i>0;i--)
    {
        document.getElementById(localityId).remove(i);
    }
    if(selectedDistrictId != "")
    {
        var index = 0;
        var arrayLength = localityArray.length;
        while(index < arrayLength)
        {
            if(localityArray[index].districtId == selectedDistrictId)
            {
                var optionObj = document.createElement("option");
                optionObj.text = localityArray[index].description;
                optionObj.value = localityArray[index].localityId;
                optionObj.title= localityArray[index].description;
                if(localityValue && localityValue==localityArray[index].localityId)
                {
                    optionObj.selected = "selected";
                }

                document.getElementById(localityId).options[document.getElementById(localityId).options.length] = optionObj; 
                
            }
            index++;
        }
    }
}

function showRentIncomeWithHoldeePartialTable(partialDetailArray){
	if(partialDetailArray.length>=1){
		document.getElementById('paymentRentIncomeWithWebForm').style.display="";
		
		document.getElementById('navigationLegend').innerHTML = PreviousLiabilityDetails ;
		document.getElementById("rentIncomeWithWebFormLiablibilityTbl").style.display = "";
		var cntr = 0;
		var tabObj = document.getElementById("rentIncomeWithWebFormLiablibilityTbl");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		for(var i=0;i<partialDetailArray.length;i++){
			cntr = parseInt(cntr);
			var tabRow = tabObj.insertRow(tabObj.rows.length);
			tabRow.id="rentIncomeWithHoldeeWebHdrRow_"+cntr;
			var tabCell = new Array();
			for (var j=0;j<8;j++){
				tabCell[j] = tabRow.insertCell(j);
			}
			var pmtSplDetailVO = partialDetailArray[i];
		
			var element = document.createElement('input');       
			element.type ='radio';
			//added for allowing partial payment
			element.onclick = function () {onSelectRentIncomeWithHoldeeHdrRadio(this);};
			element.value = cntr;
			element.id = 'rentIncomeWithHoldeeWebFormRadio_'+cntr;
			element.name = "rentIncomeWithHoldeeWebFormRadio";
			element.className='bordercl rentincomewhtradio';
			
			tabCell[0].appendChild(element); 


			tabCell[1].innerHTML = pmtSplDetailVO.taxPeriod;
			tabCell[1].style.textAlign="center";
			tabCell[1].style.fontSize="11";

			tabCell[2].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualFineAmount).toFixed(2),true);
			tabCell[2].style.textAlign="right";
			tabCell[2].style.fontSize="11";


			tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPenaltyAmount).toFixed(2),true);
			tabCell[3].style.textAlign="right";
			tabCell[3].style.fontSize="11";

			tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualInterestAmount).toFixed(2),true);
			tabCell[4].style.textAlign="right";
			tabCell[4].style.fontSize="11";

			tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			tabCell[5].style.textAlign="right";
			tabCell[5].style.fontSize="11";
			//added for suggestion for allowing partial payment
			var elementtext = document.createElement("input");
			elementtext.type="text";
			elementtext.name="actualLiabilityamount_"+cntr;
			elementtext.id="actualLiabilityamount_"+cntr;
			elementtext.onchange=function() {onChangeAmtToBePaidRentWht(this);};
			elementtext.setAttribute("value", convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true));
			
			//tabCell[6].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualLiabilityAmount).toFixed(2),true);
			elementtext.setAttribute("readOnly", "readOnly");
			elementtext.className='readonlyInput form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
			elementtext.setAttribute('maxlength', 15);
			elementtext.style.textAlign = 'right'; 
			tabCell[6].appendChild(elementtext);
			tabCell[6].style.textAlign="right";
			tabCell[6].style.fontSize="11";
			//end
			var element = document.createElement('input');
     		element.type = 'hidden';
   			element.value =  convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.actualPrincipalAmount).toFixed(2),true);
   			element.width = "0%";
   			tabCell[7].appendChild(element);
   			tabCell[7].style.display = "none";
   			
			cntr = cntr+1;
		}
		document.getElementById("navigationFieldset").style.display = "";
		document.getElementById("rentIncomeWithWebFormLiablibilityTbl").style.display = "";
		document.getElementById("navigationTableTaxSpl").style.display = "";
		document.getElementById('rentIncomeWithholdeeWebFormTable').style.display = 'none';
		document.getElementById("rentIncomeWithholdeeWebFormAddRowTable").style.display = "none";
		document.getElementById('hidNavigationFlag').value = "6";
		validatePaginationLastTaxSpl();
		validatePaginationFirstTaxSpl();
	}
}

//added for suggestion for allowing partial payment
function onChangeAmtToBePaidRentWht(obj){
	
	var arr=obj.id.split("_");
	var row=arr[1];
	var rowRef = document.getElementById("rentIncomeWithHoldeeWebHdrRow_" + row);
	var amtPayable = rowRef.getElementsByTagName("TD")[5].textContent;
	amtPayable=parseInt(removeCommaFrmInput(amtPayable),10).toFixed(2);
	if(parseInt(obj.value)<0 || parseInt(obj.value)>parseInt(amtPayable)){
		alert("Amount to be paid should be greater than 0 and less than amount payable");
		obj.value=amtPayable;
		return false;
	}
	document.getElementById("in_rentIncomeWithholdeeWebFormTable_5").value=obj.value;
	return true;
	
}

function saveRentIncomeWithPaymentOblig()
{
	if (document.getElementById('cmbTaxSubHead').value==rentIncomeWith && document.getElementById('RentIncomeWithPaymentType').value=='e'){

		if(document.getElementById('isAmendment').value=='Y')
		{
			var  tableObj =document.getElementById('RentIncomeWithPreviousDetailsTable');
			document.getElementById('prnString').value='';
			var prnstring ='';
			var prn = null; 
			if(tableObj.rows.length > 1){
				for(var i = 1, n = tableObj.rows.length; i <n; i++) 
				{
					if(document.getElementById('rentIncomeWithHoldeeHdrCheckbox_'+(i-1)).checked){
						if (document.all) {// for IE
							prn = tableObj.rows[i].cells[1].innerText;
						}
						else{
							var innrhtmltext = tableObj.rows[i].cells[1].textContent;
							prn = innrhtmltext; 
						}

						prnstring =prnstring.concat(prn+',');
					}

				}
				if(prnstring.length==0){
					alert("Please select Prn for amendedment");
					return false;
				}else{
					document.getElementById('prnString').value=prnstring;
				}
			}
		}

		if(validateFileRentIncomeWith())
		{
			if(saveConfirm())
			{
				document.getElementById('cmdSaveOblig').disabled=true;
				document.getElementById('cmdClearOblig').disabled=true;
				document.getElementById('back').disabled=true;
				document.paymentRegForm.action="paymentRegistration.htm?actionCode=savePaymentExcelDetail";
				document.paymentRegForm.submit();

			}
		}

	}
	else
	{
		if(validateFormFields(paymentRegTaxObligPaymentDetailsJson))
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(document.getElementById('cmbTaxSubHead').value==rentIncomeWith)
			{
				if(document.getElementById('rentIncomeWithRadio1').checked == false && document.getElementById('rentIncomeWithRadio2').checked == false)
				{
					alert('Please select atleast one operation for Rent Income Withholding payment.');
					return false;
				}
			}

			if(modifyFlagRentIncomeWithHoldee==1)
			{
				alert(firstModify);
				return false;
			}
			else
			{
				if(removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOblig').value)>0)
				{
					if(saveConfirm())
					{
						document.getElementById('cmdSaveOblig').disabled=true;
						document.getElementById('cmdClearOblig').disabled=true;
						document.getElementById('back').disabled=true;
						document.getElementById("txtTotalAmountPaidOblig").value = removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOblig").value);
						var rows = document.getElementById('rentIncomeWithWebFormLiablibilityTbl').rows.length;
						var flag=false;
						var table = document.getElementById('rentIncomeWithholdeeWebFormTable');
						if(!(table.rows.length==1))
						{ 	
							for (var i = 1, n = table.rows.length; i <n; i++) 
							{ 
								modify=trim(table.rows[i].cells[2].getElementsByTagName('A')[0].innerHTML);
								if((trim(document.getElementById('id_temp_'+'rentIncomeWithholdeeWebFormTable'+'_'+i+'_1').value))=="Delete" && (modify=="Modify"))
								{
									flag=true;
									break;
								}
							}
						}
						if(flag)
						{
							document.getElementById('isPrevLiabilityChosenForITWht').value='Y';
						}
						else
						{
							document.getElementById('isPrevLiabilityChosenForITWht').value='N';
						}
						document.paymentRegForm.action="paymentRegistration.htm?actionCode=saveObligationDetail";
						document.paymentRegForm.submit();
					}
				}
				else
				{
					alert(totalAmtGreaterThenZero);
					return false;
				}
			}
		}
	}
}

function validateFileRentIncomeWith(){
	var file=document.getElementById("fileRentIncomeWith");
	
	if(file){
		fileName= file.value;
	
	if(fileName=="")
	{	
		alert('Please upload file.');
		file.value='';
		file.focus();
		return false;
	}else{
		var index = fileName.lastIndexOf(".");
		var length = fileName.length;
		var ext = fileName.substring(index+1).toLowerCase();
		if(fileName!='')
		{
			if (!(ext == 'xls'|| ext == 'zip' ))
			{
				alert("Please upload xls or zip file.");
				file.value='';
				file.focus();
				return false;
			}else{
				return true;
			}
	    }
	}
}
	else{
		alert('Please upload file.');
		return false;
	}
}

function validateDateFoRentIncomeWithDate(obj,lableName){
	var date = obj.value;
	var regDate = document.getElementById('rentIncomeWithEffectiveDate').value;
	
	var dateFrom = document.getElementById('in_rentIncomeWithTable_20').value;
	document.getElementById('in_rentIncomeWithTable_10').value='';
	//Added on 19/07/2023, finance act 2023 changes
	if(obj.id=="in_rentIncomeWithTable_20"){
		var year=dateFrom.substr(6);
		var month=dateFrom.substr(3, 2);
		//if( new Date(dateFrom)>= new Date("01/07/2023") ){
		if((parseInt(year)==2023 && parseInt(month)>=7) || parseInt(year) > 2023 ){
			document.getElementById("in_rentIncomeWithTable_21").value=dateFrom;
			document.getElementById("dateFrom").innerHTML="Rent Payment/Receipt Date by Agent";
			document.getElementById("in_rentIncomeWithTable_21").disabled=true;
		}else{
			document.getElementById("in_rentIncomeWithTable_21").disabled=false;
			//document.getElementById("dateFrom").innerHTML="Date From";
			document.getElementById("in_rentIncomeWithTable_21").value="";
		}
	}
	//End 19/07/2023
	
	
	if(validateDateForTaxpayerRegDateValue(date,regDate)){
		return true; 
	}
	else{
		//alert(lableName+" should be after Taxpayer Registration Date");
		alert("Please select "+lableName+" after Rent Income Withholding Roll out Date "+regDate );
		obj.value = "";
		obj.focus();
		return false;
	}
}

function onSelectRentIncomeWithAmndmntPrevDetailRadio(obj)
{

	var rows = document.getElementById('RentIncomeWithPreviousDetailsTable').rows.length;
	var flag=false;
	for(var i=0; i<rows-1;i++)
		{
			if(document.getElementById('rentIncomeWithHoldeeHdrCheckbox_'+i).checked==true)
				{
					flag=true;
				}
		}
	if(flag==true)
		{
		 document.getElementById('amendButtonRentIncomeWith').style.display='';
		 document.getElementById('fileRentIncomeWith').disabled=false;
		 return true;
		}
	else
		{
			document.getElementById('amendButtonRentIncomeWith').style.display='none';
			 document.getElementById('fileRentIncomeWith').disabled=true;
			 document.getElementById('fileRentIncomeWith').value='';
			return false;
		}
}

function onSelectRentIncomeWithHoldeeHdrRadio(obj)
{	//added for allowing partial payment
	
	var rowNum = obj.value;
	var currentId=document.getElementById('rentIncomeWithHoldeeWebFormRadio_'+rowNum);
	if(!(currentId == modifyId)){
	if(isModifyActive==true){
		alert("Please complete modify action.");
		document.getElementById('rentIncomeWithHoldeeWebFormRadio_'+rowNum).checked=false;
		modifyId.checked=true;
		return false;
	}
	}
	
	document.getElementById('rentIncomeWithholdeeWebFormTable').style.display = '';
	document.getElementById("rentIncomeWithholdeeWebFormAddRowTable").style.display = "";
	document.getElementById("rentIncomeWithWebFormLiablibilityTbl").style.display = "";
	
	document.getElementById('paymentRentIncomeWithRegForm').style.display = 'none';
	
	
	var rowNum = obj.value;
	objValue=obj.value;		
	
	rowNumbmerPartial=obj.value;
	//added for suggestion for allowing partial payment
	//document.getElementsByName('actualLiabilityamount').readOnly = true;
	$(".RentWhtAmountToBePaid").attr('readonly' , true);
	$(".RentWhtAmountToBePaid").addClass('readonlyInput');
	if(document.getElementById('cmbTaxSubHead').value!=NSSF && document.getElementById('cmbTaxSubHead').value!=amnestyCode)
	{
		document.getElementById('actualLiabilityamount_'+objValue).readOnly = false;
		document.getElementById('actualLiabilityamount_'+objValue).className='form101_textfcurr form101_textfcurr_width textonlyRight RentWhtAmountToBePaid';
	}
	
	//end
	
	if(selectedFlagRentIncomeWithHoldee>0 && document.getElementById('hidIsPartial').value != "Y")
	{
		alert(cntAddPrevLiab);
		document.getElementById('rentIncomeWithHoldeeWebHdrRow_'+rowNumbmerPartial).checked=false;
		//Added on 12/09/2024 to sort RENT WHT Issue.
		//Allow generation of interest or penalty only or principal only not both
		document.getElementById('rentIncomeWithHoldeeWebFormRadio_'+rowNumbmerPartial).checked=false;
		document.getElementById('txtTotalAmountPaidOblig').value="0";
		//End 12/09/2024
	}
	else
	{
		var taxPayerId=document.getElementById('hidTaxPayerId').value;
		var rowNum = obj.value;
		objValue=obj.value;
		var rowRef = document.getElementById("rentIncomeWithHoldeeWebHdrRow_" + rowNum);
				
		startIndexStr=parseInt(document.getElementById('startIndexUpdate').value);
		
		var principalAmount = rowRef.getElementsByTagName("input")[2].value;
		
		if (removeCommaFrmInput(principalAmount) > 0){
			
			alert ("Principal amount is pending for this period . Please make Payment of the Principal amount first.");
			if(document.getElementById('rentIncomeWithholdeeWebFormTable').rows.length>1)
			{
				document.getElementById('paymentRentIncomeWithRegForm').style.display = 'none';
			}
			else
			{
				document.getElementById('paymentRentIncomeWithRegForm').style.display = '';
				document.getElementById('paymentRentIncomeWithWebForm').style.display = 'none';
				clear_table_data('rentIncomeWithTable');
			}
			rowRef.getElementsByTagName("input")[0].checked= false ;
			return false ;
		}
		else {
			var taxPeriodDisp = rowRef.getElementsByTagName("TD")[1].textContent;
			//Added by Mingu for Amnesty Enhancement :: START
			var taxPeriodDispArray = taxPeriodDisp.split(" ");
			var yearStr = taxPeriodDispArray[1];
			var yearInt = parseInt(yearStr);
			//13/08/2024commented to open after amnesty period ended::START
			/*if(yearInt<=2022){
				alert("You cannot pay the Penalty and Interest for periods before January 2023.");
				rowRef.getElementsByTagName("input")[0].checked= false ;
				return false;
			}*/
			//13/08/2024commented to open after amnesty period ended::END
			//Added by Mingu for Amnesty Enhancement :: END
			document.getElementById("hidTaxPeriod").value=taxPeriodDisp;
			document.getElementById("in_rentIncomeWithholdeeWebFormTable_3").value=taxPeriodDisp;

			var obligationId=document.getElementById('cmbTaxSubHead').value;
		
			var taxPayable = rowRef.getElementsByTagName("TD")[5].textContent;			
			taxPayable=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(taxPayable),10).toFixed(2),true);				
			document.getElementById("in_rentIncomeWithholdeeWebFormTable_4").value=taxPayable;

			var amountPaid = (rowRef.getElementsByTagName("input")[1].value);
			amountPaid=	convertToKenyanShillingFormatValWithDecimal(parseInt(removeCommaFrmInput(amountPaid),10).toFixed(2),true);
			document.getElementById("in_rentIncomeWithholdeeWebFormTable_5").value=amountPaid;
		}
	

	}

}


var rentIncomeWithJSON={"field":[{"name":"in_rentIncomeWithTable_3","rule":[{"required":"y","dispName":"Landlord PIN","type":"isValAlphaNumericWithoutSpace","minLength":"11","maxLength":"11"}]},
                               {"name":"in_rentIncomeWithTable_4","rule":[{"required":"y","dispName":"Landlord Name","type":"bussnamewithspecialchrs"}]},
                               {"name":"in_rentIncomeWithTable_12","rule":[{"required":"y","dispName":"Landlord Address","type":"bussnamewithspecialchrs"}]},
                               {"name":"in_rentIncomeWithTable_13","rule":[{"required":"y","dispName":"Landlord Email Id","type":"email"}]},
                               {"name":"in_rentIncomeWithTable_14","rule":[{"required":"n","type":"alphanumericspecialchara","dispName":"L.R. Nunber","maxLength":"50"}]},
                               {"name":"in_rentIncomeWithTable_5","rule":[{"required":"y","type":"alphanumericspecialcharaemp","dispName":"Building","maxLength":"50"}]},
                               {"name":"in_rentIncomeWithTable_6","rule":[{"required":"y","type":"alphanumericspecialcharaemp","dispName":"Street/Road","maxLength":"50"}]},
                               {"name":"in_rentIncomeWithTable_7","rule":[{"required":"y","type":"alphanumericspecialcharaemp","dispName":"City/Town","maxLength":"50"}]},
                               {"name":"in_rentIncomeWithTable_9","rule":[{"required":"y","dispName":"District"}]},
                               {"name":"in_rentIncomeWithTable_8","rule":[{"required":"y","dispName":"County"}]},
                               {"name":"in_rentIncomeWithTable_16","rule":[{"required":"y","type":"alphanumericspecialcharaemp","dispName":"Descriptive Address","maxLength":"200"}]},
                               {"name":"in_rentIncomeWithTable_19","rule":[{"required":"y","dispName":"Postal Code"}]},
                               {"name":"in_rentIncomeWithTable_15","rule":[{"required":"y","dispName":"Tax Area/Locality"}]},
                               {"name":"in_rentIncomeWithTable_18","rule":[{"required":"y","dispName":"Post Office Name"}]},
                               {"name":"in_rentIncomeWithTable_17","rule":[{"required":"y","type":"numeric","dispName":"P.O.Box","minLength":"1","maxLength":"15"}]},
                               {"name":"in_rentIncomeWithTable_20","rule":[{"required":"y","dispName":"Date From","type":"date"}]},
                               {"name":"in_rentIncomeWithTable_21","rule":[{"required":"y","dispName":"Date To","type":"date"}]},
                               {"name":"in_rentIncomeWithTable_10","rule":[{"required":"y","dispName":"Amount Payable","maxLength":"15","type":"amount"}]},
                               {"name":"in_rentIncomeWithTable_25","rule":[{"required":"y","dispName":"Type of Property"}]}
                   ]};



function validateRentIncomeWithHoldeeDtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, rentIncomeWithJSON);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}

}


/*function removeOptions(selectbox)
{
    var i;
    for(i=selectbox.options.length-1;i>=0;i--)
    {
        selectbox.remove(i);
    }
}*/
//end