Calendar=function(d,c,f,a){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=f||null;this.onClose=a||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT.DEF_DATE_FORMAT;this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT;this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof d=="number"?d:Calendar._FD;this.showsOtherMonths=false;this.dateStr=c;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=1;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3;}var b=new Array();for(var e=8;e>0;){b[--e]=Calendar._DN[e].substr(0,Calendar._SDN_len);}Calendar._SDN=b;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3;}b=new Array();for(var e=12;e>0;){b[--e]=Calendar._MN[e].substr(0,Calendar._SMN_len);}Calendar._SMN=b;}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(e){var a=0,d=0;var c=/^div$/i.test(e.tagName);if(c&&e.scrollLeft){a=e.scrollLeft;}if(c&&e.scrollTop){d=e.scrollTop;}var f={x:e.offsetLeft-a,y:e.offsetTop-d};if(e.offsetParent){var b=this.getAbsolutePos(e.offsetParent);f.x+=b.x;f.y+=b.y;}return f;};Calendar.isRelated=function(c,a){var d=a.relatedTarget;if(!d){var b=a.type;if(b=="mouseover"){d=a.fromElement;}else{if(b=="mouseout"){d=a.toElement;}}}while(d){if(d==c){return true;}d=d.parentNode;}return false;};Calendar.removeClass=function(e,d){if(!(e&&e.className)){return;}var a=e.className.split(" ");var b=new Array();for(var c=a.length;c>0;){if(a[--c]!=d){b[b.length]=a[c];}}e.className=b.join(" ");};Calendar.addClass=function(b,a){Calendar.removeClass(b,a);b.className+=" "+a;};Calendar.getElement=function(a){if(Calendar.is_ie){var b=window.event.srcElement;if(b.tagName=="DIV"){b=b.parentNode;}return b;}else{return a.currentTarget;}};Calendar.getTargetElement=function(a){if(Calendar.is_ie){return window.event.srcElement;}else{return a.target;}};Calendar.stopEvent=function(a){a||(a=window.event);if(Calendar.is_ie){a.cancelBubble=true;a.returnValue=false;}else{a.preventDefault();a.stopPropagation();}return false;};Calendar.addEvent=function(a,c,b){if(a.attachEvent){a.attachEvent("on"+c,b);}else{if(a.addEventListener){a.addEventListener(c,b,true);}else{a["on"+c]=b;}}};Calendar.removeEvent=function(a,c,b){if(a.detachEvent){a.detachEvent("on"+c,b);}else{if(a.removeEventListener){a.removeEventListener(c,b,true);}else{a["on"+c]=null;}}};Calendar.createElement=function(c,b){var a=null;if(document.createElementNS){a=document.createElementNS("http://www.w3.org/1999/xhtml",c);}else{a=document.createElement(c);}if(typeof b!="undefined"){b.appendChild(a);}return a;};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true);}}};Calendar.findMonth=function(a){if(typeof a.month!="undefined"){return a;}else{if(typeof a.parentNode.month!="undefined"){return a.parentNode;}}return null;};Calendar.findYear=function(a){if(typeof a.year!="undefined"){return a;}else{if(typeof a.parentNode.year!="undefined"){return a.parentNode;}}return null;};Calendar.showMonthsCombo=function(){var e=Calendar._C;if(!e){return false;}var e=e;var f=e.activeDiv;var d=e.monthsCombo;if(e.hilitedMonth){Calendar.removeClass(e.hilitedMonth,"hilite");}if(e.activeMonth){Calendar.removeClass(e.activeMonth,"active");}var c=e.monthsCombo.getElementsByTagName("div")[e.date.getMonth()];Calendar.addClass(c,"active");e.activeMonth=c;var b=d.style;b.display="block";if(f.navtype<0){b.left=f.offsetLeft+"px";}else{var a=d.offsetWidth;if(typeof a=="undefined"){a=50;}b.left=(f.offsetLeft+f.offsetWidth-a)+"px";}b.top=(f.offsetTop+f.offsetHeight)+"px";};Calendar.showYearsCombo=function(d){var a=Calendar._C;if(!a){return false;}var a=a;var c=a.activeDiv;var f=a.yearsCombo;if(a.hilitedYear){Calendar.removeClass(a.hilitedYear,"hilite");}if(a.activeYear){Calendar.removeClass(a.activeYear,"active");}a.activeYear=null;var b=a.date.getFullYear()+(d?1:-1);var j=f.firstChild;var h=false;for(var e=12;e>0;--e){if(b>=a.minYear&&b<=a.maxYear){j.innerHTML=b;j.year=b;j.style.display="block";h=true;}else{j.style.display="none";}j=j.nextSibling;b+=d?a.yearStep:-a.yearStep;}if(h){var k=f.style;k.display="block";if(c.navtype<0){k.left=c.offsetLeft+"px";}else{var g=f.offsetWidth;if(typeof g=="undefined"){g=50;}k.left=(c.offsetLeft+c.offsetWidth-g)+"px";}k.top=(c.offsetTop+c.offsetHeight)+"px";}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false;}if(cal.timeout){clearTimeout(cal.timeout);}var el=cal.activeDiv;if(!el){return false;}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev);}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev);}};Calendar.tableMouseOver=function(n){var a=Calendar._C;if(!a){return;}var c=a.activeDiv;var j=Calendar.getTargetElement(n);if(j==c||j.parentNode==c){Calendar.addClass(c,"hilite active");Calendar.addClass(c.parentNode,"rowhilite");}else{if(typeof c.navtype=="undefined"||(c.navtype!=50&&(c.navtype==0||Math.abs(c.navtype)>2))){Calendar.removeClass(c,"active");}Calendar.removeClass(c,"hilite");Calendar.removeClass(c.parentNode,"rowhilite");}n||(n=window.event);if(c.navtype==50&&j!=c){var m=Calendar.getAbsolutePos(c);var p=c.offsetWidth;var o=n.clientX;var q;var l=true;if(o>m.x+p){q=o-m.x-p;l=false;}else{q=m.x-o;}if(q<0){q=0;}var f=c._range;var h=c._current;var g=Math.floor(q/10)%f.length;for(var e=f.length;--e>=0;){if(f[e]==h){break;}}while(g-->0){if(l){if(--e<0){e=f.length-1;}}else{if(++e>=f.length){e=0;}}}var b=f[e];c.innerHTML=b;a.onUpdateTime();}var d=Calendar.findMonth(j);if(d){if(d.month!=a.date.getMonth()){if(a.hilitedMonth){Calendar.removeClass(a.hilitedMonth,"hilite");}Calendar.addClass(d,"hilite");a.hilitedMonth=d;}else{if(a.hilitedMonth){Calendar.removeClass(a.hilitedMonth,"hilite");}}}else{if(a.hilitedMonth){Calendar.removeClass(a.hilitedMonth,"hilite");}var k=Calendar.findYear(j);if(k){if(k.year!=a.date.getFullYear()){if(a.hilitedYear){Calendar.removeClass(a.hilitedYear,"hilite");}Calendar.addClass(k,"hilite");a.hilitedYear=k;}else{if(a.hilitedYear){Calendar.removeClass(a.hilitedYear,"hilite");}}}else{if(a.hilitedYear){Calendar.removeClass(a.hilitedYear,"hilite");}}}return Calendar.stopEvent(n);};Calendar.tableMouseDown=function(a){if(Calendar.getTargetElement(a)==Calendar.getElement(a)){return Calendar.stopEvent(a);}};Calendar.calDragIt=function(b){var c=Calendar._C;if(!(c&&c.dragging)){return false;}var e;var d;if(Calendar.is_ie){d=window.event.clientY+document.body.scrollTop;e=window.event.clientX+document.body.scrollLeft;}else{e=b.pageX;d=b.pageY;}c.hideShowCovered();var a=c.element.style;a.left=(e-c.xOffs)+"px";a.top=(d-c.yOffs)+"px";return Calendar.stopEvent(b);};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false;}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev);}cal.hideShowCovered();};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false;}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver);}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp);}}else{if(cal.isPopup){cal._dragStart(ev);}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250);}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout);}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250);}else{if(el.navtype==0){cal.params.inputField.value="";cal.callCloseHandler();}else{cal.timeout=null;}}}return Calendar.stopEvent(ev);};Calendar.dayMouseDblClick=function(a){Calendar.cellClick(Calendar.getElement(a),a||window.event);if(Calendar.is_ie){document.selection.empty();}};Calendar.dayMouseOver=function(b){var a=Calendar.getElement(b);if(Calendar.isRelated(a,b)||Calendar._C||a.disabled){return false;}if(a.ttip){if(a.ttip.substr(0,1)=="_"){a.ttip=a.caldate.print(a.calendar.ttDateFormat)+a.ttip.substr(1);}a.calendar.tooltips.innerHTML=a.ttip;}if(a.navtype!=300){Calendar.addClass(a,"hilite");if(a.caldate){Calendar.addClass(a.parentNode,"rowhilite");}}return Calendar.stopEvent(b);};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false;}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite");}if(el.calendar){el.calendar.tooltips.innerHTML=_TT.SEL_DATE;}return stopEvent(ev);}};Calendar.cellClick=function(e,o){var c=e.calendar;var h=false;var l=false;var f=null;if(typeof e.navtype=="undefined"){if(c.currentDateEl){Calendar.removeClass(c.currentDateEl,"selected");Calendar.addClass(e,"selected");h=(c.currentDateEl==e);if(!h){c.currentDateEl=e;}}c.date.setDateOnly(e.caldate);f=c.date;var b=!(c.dateClicked=!e.otherMonth);if(!b&&!c.currentDateEl){c._toggleMultipleDate(new Date(f));}else{l=true;}if(b){c._init(c.firstDayOfWeek,f);}}else{if(e.navtype==200){Calendar.removeClass(e,"hilite");c.callCloseHandler();return;}f=new Date(c.date);if(e.navtype==0){f.setDateOnly(new Date());}c.dateClicked=false;var n=f.getFullYear();var g=f.getMonth();function a(q){var r=f.getDate();var i=f.getMonthDays(q);if(r>i){f.setDate(i);}f.setMonth(q);}switch(e.navtype){case 400:Calendar.removeClass(e,"hilite");var p=Calendar._TT.ABOUT;if(typeof p!="undefined"){p+=c.showsTime?Calendar._TT.ABOUT_TIME:"";}else{p='Help and about box text is not translated into this language.\nIf you know this language and you feel generous please update\nthe corresponding file in "lang" subdir to match calendar-en.js\nand send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\nThank you!\nhttp://dynarch.com/mishoo/calendar.epl\n';}alert(p);return;case -2:if(n>c.minYear){f.setFullYear(n-1);}break;case -1:if(g>0){a(g-1);}else{if(n-->c.minYear){f.setFullYear(n);a(11);}}break;case 1:if(g<11){a(g+1);}else{if(n<c.maxYear){f.setFullYear(n+1);a(0);}}break;case 2:if(n<c.maxYear){f.setFullYear(n+1);}break;case 100:c.setFirstDayOfWeek(e.fdow);return;case 50:var k=e._range;var m=e.innerHTML;for(var j=k.length;--j>=0;){if(k[j]==m){break;}}if(o&&o.shiftKey){if(--j<0){j=k.length-1;}}else{if(++j>=k.length){j=0;}}var d=k[j];e.innerHTML=d;c.onUpdateTime();return;case 0:if((typeof c.getDateStatus=="function")&&c.getDateStatus(f,f.getFullYear(),f.getMonth(),f.getDate())){return false;}break;}if(!f.equalsTo(c.date)){c.setDate(f);}else{if(e.navtype==0){l=h=true;}}}if(l){c.callHandler();}if(h){Calendar.removeClass(e,"hilite");c.callCloseHandler();}};Calendar.prototype.create=function(n){var m=null;if(!n){m=document.getElementsByTagName("body")[0];this.isPopup=true;}else{m=n;this.isPopup=false;}this.date=this.dateStr?new Date(this.dateStr):new Date();var q=Calendar.createElement("table");this.table=q;q.cellSpacing=0;q.cellPadding=0;q.calendar=this;Calendar.addEvent(q,"mousedown",Calendar.tableMouseDown);var a=Calendar.createElement("div");this.element=a;a.className="calendar";if(this.isPopup){a.style.position="absolute";a.style.display="none";}a.appendChild(q);var k=Calendar.createElement("thead",q);var o=null;var r=null;var b=this;var e=function(s,j,i){o=Calendar.createElement("td",r);o.colSpan=j;o.className="button";if(i!=0&&Math.abs(i)<=2){o.className+=" nav";}Calendar._add_evs(o);o.calendar=b;o.navtype=i;o.innerHTML="<div unselectable='on'>"+s+"</div>";return o;};r=Calendar.createElement("tr",k);var c=6;(this.isPopup)&&--c;(this.weekNumbers)&&++c;e("?",1,400).ttip=Calendar._TT.INFO;this.title=e("",c,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT.DRAG_TO_MOVE;this.title.style.cursor="move";e("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE;}r=Calendar.createElement("tr",k);r.className="headrow";this._nav_py=e("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT.PREV_YEAR;this._nav_pm=e("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT.PREV_MONTH;this._nav_now=e(Calendar._TT.TODAY,this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT.GO_TODAY;this._nav_nm=e("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT.NEXT_MONTH;this._nav_ny=e("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT.NEXT_YEAR;r=Calendar.createElement("tr",k);r.className="daynames";if(this.weekNumbers){o=Calendar.createElement("td",r);o.className="name wn";o.innerHTML=Calendar._TT.WK;}for(var h=7;h>0;--h){o=Calendar.createElement("td",r);if(!h){o.navtype=100;o.calendar=this;Calendar._add_evs(o);}}this.firstdayname=(this.weekNumbers)?r.firstChild.nextSibling:r.firstChild;this._displayWeekdays();var g=Calendar.createElement("tbody",q);this.tbody=g;for(h=6;h>0;--h){r=Calendar.createElement("tr",g);if(this.weekNumbers){o=Calendar.createElement("td",r);}for(var f=7;f>0;--f){o=Calendar.createElement("td",r);o.calendar=this;Calendar._add_evs(o);}}if(this.showsTime){r=Calendar.createElement("tr",g);r.className="time";o=Calendar.createElement("td",r);o.className="time";o.colSpan=2;o.innerHTML=Calendar._TT.TIME||"&nbsp;";o=Calendar.createElement("td",r);o.className="time";o.colSpan=(this.weekNumbers?4:3)-1;(function(){function t(C,E,D,F){var A=Calendar.createElement("span",o);A.className=C;A.innerHTML=E;A.calendar=b;A.ttip=Calendar._TT.TIME_PART;A.navtype=50;A._range=[];if(typeof D!="number"){A._range=D;}else{for(var B=D;B<=F;++B){var z;if(B<10&&F>=10){z="0"+B;}else{z=""+B;}A._range[A._range.length]=z;}}Calendar._add_evs(A);return A;}var x=b.date.getHours();var i=b.date.getMinutes();var y=!b.time24;var j=(x>12);if(y&&j){x-=12;}var v=t("hour",x,y?1:0,y?12:23);var u=Calendar.createElement("span",o);u.innerHTML=":";u.className="colon";var s=t("minute",i,0,59);var w=null;o=Calendar.createElement("td",r);o.className="time";if(y){w=t("ampm",j?"pm":"am",["am","pm"]);}else{o.innerHTML="&nbsp;";}o=Calendar.createElement("td",r);o.className="time";o.colSpan=2;o.calendar=b;o.navtype=0;o.ttip=Calendar._TT.CLEAR;o.innerHTML="<div unselectable='on'>Clear"||"&nbsp;</div>";Calendar._add_evs(o);b.onSetTime=function(){var A,z=this.date.getHours(),B=this.date.getMinutes();if(y){A=(z>=12);if(A){z-=12;}if(z==0){z=12;}w.innerHTML=A?"pm":"am";}v.innerHTML=(z<10)?("0"+z):z;s.innerHTML=(B<10)?("0"+B):B;};b.onUpdateTime=function(){var A=this.date;var B=parseInt(v.innerHTML,10);if(y){if(/pm/i.test(w.innerHTML)&&B<12){B+=12;}else{if(/am/i.test(w.innerHTML)&&B==12){B=0;}}}var C=A.getDate();var z=A.getMonth();var D=A.getFullYear();A.setHours(B);A.setMinutes(parseInt(s.innerHTML,10));A.setFullYear(D);A.setMonth(z);A.setDate(C);this.dateClicked=false;};})();}else{this.onSetTime=this.onUpdateTime=function(){};}var l=Calendar.createElement("tfoot",q);r=Calendar.createElement("tr",l);r.className="footrow";o=e(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300);o.className="ttip";if(this.isPopup){o.ttip=Calendar._TT.DRAG_TO_MOVE;o.style.cursor="move";}this.tooltips=o;a=Calendar.createElement("div",this.element);this.monthsCombo=a;a.className="combo";for(h=0;h<Calendar._MN.length;++h){var d=Calendar.createElement("div");d.className=Calendar.is_ie?"label-IEfix":"label";d.month=h;d.innerHTML=Calendar._SMN[h];a.appendChild(d);}a=Calendar.createElement("div",this.element);this.yearsCombo=a;a.className="combo";for(h=12;h>0;--h){var p=Calendar.createElement("div");p.className=Calendar.is_ie?"label-IEfix":"label";a.appendChild(p);}this._init(this.firstDayOfWeek,this.date);m.appendChild(this.element);};Calendar._keyEvent=function(e){if(!window._dynarch_popupCalendar){return false;}(Calendar.is_ie)&&(e=window.event);var g=window._dynarch_popupCalendar;var a=(Calendar.is_ie||e.type=="keypress");if(e.ctrlKey){switch(e.keyCode){case 37:a&&Calendar.cellClick(g._nav_pm);break;case 38:a&&Calendar.cellClick(g._nav_py);break;case 39:a&&Calendar.cellClick(g._nav_nm);break;case 40:a&&Calendar.cellClick(g._nav_ny);break;default:return false;}}else{switch(e.keyCode){case 32:Calendar.cellClick(g._nav_now);break;case 27:a&&g.callCloseHandler();break;case 37:case 38:case 39:case 40:if(a){var b=g.date.getDate()-1;var c=g.currentDateEl;var f=null;var d=(e.keyCode==37)||(e.keyCode==38);switch(e.keyCode){case 37:(--b>=0)&&(f=g.ar_days[b]);break;case 38:b-=7;(b>=0)&&(f=g.ar_days[b]);break;case 39:(++b<g.ar_days.length)&&(f=g.ar_days[b]);break;case 40:b+=7;(b<g.ar_days.length)&&(f=g.ar_days[b]);break;}if(!f){if(d){Calendar.cellClick(g._nav_pm);}else{Calendar.cellClick(g._nav_nm);}b=(d)?g.date.getMonthDays():1;c=g.currentDateEl;f=g.ar_days[b-1];}Calendar.removeClass(c,"selected");Calendar.addClass(f,"selected");g.date=new Date(f.caldate);g.currentDateEl=f;}break;case 13:if(a){g.callHandler();g.hide();}break;default:return false;}}return Calendar.stopEvent(e);};Calendar.prototype._init=function(l,u){var s=new Date();this.table.style.visibility="hidden";var f=u.getFullYear();if(f<this.minYear){f=this.minYear;u.setFullYear(f);}else{if(f>this.maxYear){f=this.maxYear;u.setFullYear(f);}}this.firstDayOfWeek=l;this.date=new Date(u);var v=u.getMonth();var x=u.getDate();var w=u.getMonthDays();u.setDate(1);var p=(u.getDay()-this.firstDayOfWeek)%7;if(p<0){p+=7;}u.setDate(-p);u.setDate(u.getDate()+1);var c=this.tbody.firstChild;var h=Calendar._SMN[v];var n=new Array();var m=Calendar._TT.WEEKEND;var b=this.multiple?(this.datesCells={}):null;if(typeof this.getDateText!="function"){this.getDateText=function(i,j){return j;};}for(var r=0;r<6;++r,c=c.nextSibling){var a=c.firstChild;if(this.weekNumbers){a.className="day wn";a.innerHTML=u.getWeekNumber();a=a.nextSibling;}c.className="daysrow";var t=false;for(var q=0;q<7;++q,a=a.nextSibling,u.setDate(u.getDate()+1)){var d=u.getDate();var e=u.getDay();a.className="day";var k=(u.getMonth()==v);if(!k){if(this.showsOtherMonths){a.className+=" othermonth";a.otherMonth=true;}else{a.className="emptycell";a.innerHTML="&nbsp;";a.disabled=true;continue;}}else{a.otherMonth=false;t=true;}a.disabled=false;a.innerHTML=this.getDateText(u,d);if(b){b[u.print("%Y%m%d")]=a;}if(this.getDateStatus){var o=this.getDateStatus(u,f,v,d);if(typeof this.getDateToolTip=="function"){var g=this.getDateToolTip(u,f,v,d);if(g){a.title=g;}}if(o===true){a.className+=" disabled";a.disabled=true;}else{if(/disabled/i.test(o)){a.disabled=true;}a.className+=" "+o;}}if(!a.disabled){n[n.length]=a;a.caldate=new Date(u);a.ttip="_";if(!this.multiple&&k&&d==x&&this.hiliteToday){a.className+=" selected";this.currentDateEl=a;}if(u.getFullYear()==s.getFullYear()&&u.getMonth()==s.getMonth()&&d==s.getDate()){a.className+=" today";a.ttip+=Calendar._TT.PART_TODAY;}if(m.indexOf(e.toString())!=-1){a.className+=a.otherMonth?" oweekend":" weekend";}}}if(!(t||this.showsOtherMonths)){c.className="emptyrow";}}this.ar_days=n;this.title.innerHTML=Calendar._MN[v]+", "+f;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates();};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var b in this.multiple){var a=this.datesCells[b];var c=this.multiple[b];if(!c){continue;}if(a){a.className+=" selected";}}}};Calendar.prototype._toggleMultipleDate=function(b){if(this.multiple){var c=b.print("%Y%m%d");var a=this.datesCells[c];if(a){var e=this.multiple[c];if(!e){Calendar.addClass(a,"selected");this.multiple[c]=b;}else{Calendar.removeClass(a,"selected");delete this.multiple[c];}}}};Calendar.prototype.setDateToolTipHandler=function(a){this.getDateToolTip=a;};Calendar.prototype.setDate=function(a){if(!a.equalsTo(this.date)){this._init(this.firstDayOfWeek,a);}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date);};Calendar.prototype.setFirstDayOfWeek=function(a){this._init(a,this.date);this._displayWeekdays();};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(a){this.getDateStatus=a;};Calendar.prototype.setRange=function(b,c){this.minYear=b;this.maxYear=c;};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat));}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this);}this.hideShowCovered();};Calendar.prototype.destroy=function(){var a=this.element.parentNode;a.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null;};Calendar.prototype.reparent=function(b){var a=this.element;a.parentNode.removeChild(a);b.appendChild(a);};Calendar._checkCalendar=function(b){var c=window._dynarch_popupCalendar;if(!c){return false;}var a=Calendar.is_ie?Calendar.getElement(b):Calendar.getTargetElement(b);for(;a!=null&&a!=c.element;a=a.parentNode){}if(a==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(b);}};Calendar.prototype.show=function(){var e=this.table.getElementsByTagName("tr");for(var d=e.length;d>0;){var f=e[--d];Calendar.removeClass(f,"rowhilite");var c=f.getElementsByTagName("td");for(var b=c.length;b>0;){var a=c[--b];Calendar.removeClass(a,"hilite");Calendar.removeClass(a,"active");}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar);}this.hideShowCovered();};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar);}this.element.style.display="none";this.hidden=true;this.hideShowCovered();};Calendar.prototype.showAt=function(a,c){var b=this.element.style;b.left=a+"px";b.top=c+"px";this.show();};Calendar.prototype.showAtElement=function(c,d){var a=this;var e=Calendar.getAbsolutePos(c);if(!d||typeof d!="string"){this.showAt(e.x,e.y+c.offsetHeight);return true;}function b(i){if(i.x<0){i.x=0;}if(i.y<0){i.y=0;}var j=document.createElement("div");var h=j.style;h.position="absolute";h.right=h.bottom=h.width=h.height="0px";document.body.appendChild(j);var g=Calendar.getAbsolutePos(j);document.body.removeChild(j);if(Calendar.is_ie){g.y+=document.body.scrollTop;g.x+=document.body.scrollLeft;}else{g.y+=window.scrollY;g.x+=window.scrollX;}var f=i.x+i.width-g.x;if(f>0){i.x-=f;}f=i.y+i.height-g.y;if(f>0){i.y-=f;}}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var f=a.element.offsetWidth;var i=a.element.offsetHeight;a.element.style.display="none";var g=d.substr(0,1);var j="l";if(d.length>1){j=d.substr(1,1);}switch(g){case"T":e.y-=i;break;case"B":e.y+=c.offsetHeight;break;case"C":e.y+=(c.offsetHeight-i)/2;break;case"t":e.y+=c.offsetHeight-i;break;case"b":break;}switch(j){case"L":e.x-=f;break;case"R":e.x+=c.offsetWidth;break;case"C":e.x+=(c.offsetWidth-f)/2;break;case"l":e.x+=c.offsetWidth-f;break;case"r":break;}e.width=f;e.height=i+40;a.monthsCombo.style.display="none";b(e);a.showAt(e.x,e.y);};if(Calendar.is_khtml){setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);}else{Calendar.continuation_for_the_fucking_khtml_browser();}};Calendar.prototype.setDateFormat=function(a){this.dateFormat=a;};Calendar.prototype.setTtDateFormat=function(a){this.ttDateFormat=a;};Calendar.prototype.parseDate=function(l,c){var n=new Date();var o=0;var e=-1;var k=0;var q=l.split(/\W+/);if(!c){c=this.dateFormat;}var p=c.match(/%./g);var h=0,g=0;var r=0;var f=0;for(h=0;h<q.length;++h){if(!q[h]){continue;}switch(p[h]){case"%d":case"%e":k=parseInt(q[h],10);break;case"%m":e=parseInt(q[h],10)-1;break;case"%Y":case"%y":o=parseInt(q[h],10);(o<100)&&(o+=(o>29)?1900:2000);break;case"%b":case"%B":for(g=0;g<12;++g){if(Calendar._MN[g].substr(0,q[h].length).toLowerCase()==q[h].toLowerCase()){e=g;break;}}break;case"%H":case"%I":case"%k":case"%l":r=parseInt(q[h],10);break;case"%P":case"%p":if(/pm/i.test(q[h])&&r<12){r+=12;}else{if(/am/i.test(q[h])&&r>=12){r-=12;}}break;case"%M":f=parseInt(q[h],10);break;}}if(isNaN(o)){o=n.getFullYear();}if(isNaN(e)){e=n.getMonth();}if(isNaN(k)){k=n.getDate();}if(isNaN(r)){r=n.getHours();}if(isNaN(f)){f=n.getMinutes();}if(o!=0&&e!=-1&&k!=0){this.setDate(new Date(o,e,k,r,f,0));return;}o=0;e=-1;k=0;for(h=0;h<q.length;++h){if(q[h].search(/[a-zA-Z]+/)!=-1){var s=-1;for(g=0;g<12;++g){if(Calendar._MN[g].substr(0,q[h].length).toLowerCase()==q[h].toLowerCase()){s=g;break;}}if(s!=-1){if(e!=-1){k=e+1;}e=s;}}else{if(parseInt(q[h],10)<=12&&e==-1){e=q[h]-1;}else{if(parseInt(q[h],10)>31&&o==0){o=parseInt(q[h],10);(o<100)&&(o+=(o>29)?1900:2000);}else{if(k==0){k=q[h];}}}}}if(o==0){o=n.getFullYear();}if(e!=-1&&k!=0){this.setDate(new Date(o,e,k,r,f,0));}};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera){return;}var a=this;Calendar.continuation_for_the_fucking_khtml_browser=function(){function c(k){var i=k.style.visibility;if(!i){if(document.defaultView&&typeof(document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml){i=document.defaultView.getComputedStyle(k,"").getPropertyValue("visibility");}else{i="";}}else{if(k.currentStyle){i=k.currentStyle.visibility;}else{i="";}}}return i;}var t=new Array("applet","iframe","select");var d=a.element;var b=Calendar.getAbsolutePos(d);var g=b.x;var e=d.offsetWidth+g;var s=b.y;var r=d.offsetHeight+s;for(var j=t.length;j>0;){var h=document.getElementsByTagName(t[--j]);var f=null;for(var m=h.length;m>0;){f=h[--m];b=Calendar.getAbsolutePos(f);var q=b.x;var o=f.offsetWidth+q;var n=b.y;var l=f.offsetHeight+n;if(a.hidden||(q>e)||(o<g)||(n>r)||(l<s)){if(!f.__msh_save_visibility){f.__msh_save_visibility=c(f);}f.style.visibility=f.__msh_save_visibility;}else{if(!f.__msh_save_visibility){f.__msh_save_visibility=c(f);}f.style.visibility="hidden";}}}};if(Calendar.is_khtml){setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);}else{Calendar.continuation_for_the_fucking_khtml_browser();}};Calendar.prototype._displayWeekdays=function(){var b=this.firstDayOfWeek;var a=this.firstdayname;var d=Calendar._TT.WEEKEND;for(var c=0;c<7;++c){a.className="day name";var e=(c+b)%7;if(c){a.ttip=Calendar._TT.DAY_FIRST.replace("%s",Calendar._DN[e]);a.navtype=100;a.calendar=this;a.fdow=e;Calendar._add_evs(a);}if(d.indexOf(e.toString())!=-1){Calendar.addClass(a,"weekend");}a.innerHTML=Calendar._SDN[(c+b)%7];a=a.nextSibling;}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none";};Calendar.prototype._dragStart=function(ev){if(this.dragging){return;}this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft;}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX;}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd);}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.prototype.getMonthDays=function(b){var a=this.getFullYear();if(typeof b=="undefined"){b=this.getMonth();}if(((0==(a%4))&&((0!=(a%100))||(0==(a%400))))&&b==1){return 29;}else{return Date._MD[b];}};Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var c=new Date(this.getFullYear(),0,0,0,0,0);var b=a-c;return Math.floor(b/Date.DAY);};Date.prototype.getWeekNumber=function(){var c=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var b=c.getDay();c.setDate(c.getDate()-(b+6)%7+3);var a=c.valueOf();c.setMonth(0);c.setDate(4);return Math.round((a-c.valueOf())/(7*86400000))+1;};Date.prototype.equalsTo=function(a){return((this.getFullYear()==a.getFullYear())&&(this.getMonth()==a.getMonth())&&(this.getDate()==a.getDate())&&(this.getHours()==a.getHours())&&(this.getMinutes()==a.getMinutes()));};Date.prototype.setDateOnly=function(a){var b=new Date(a);this.setDate(1);this.setFullYear(b.getFullYear());this.setMonth(b.getMonth());this.setDate(b.getDate());};Date.prototype.print=function(l){var b=this.getMonth();var k=this.getDate();var n=this.getFullYear();var p=this.getWeekNumber();var q=this.getDay();var v={};var r=this.getHours();var c=(r>=12);var h=(c)?(r-12):r;var u=this.getDayOfYear();if(h==0){h=12;}var e=this.getMinutes();var j=this.getSeconds();v["%a"]=Calendar._SDN[q];v["%A"]=Calendar._DN[q];v["%b"]=Calendar._SMN[b];v["%B"]=Calendar._MN[b];v["%C"]=1+Math.floor(n/100);v["%d"]=(k<10)?("0"+k):k;v["%e"]=k;v["%H"]=(r<10)?("0"+r):r;v["%I"]=(h<10)?("0"+h):h;v["%j"]=(u<100)?((u<10)?("00"+u):("0"+u)):u;v["%k"]=r;v["%l"]=h;v["%m"]=(b<9)?("0"+(1+b)):(1+b);v["%M"]=(e<10)?("0"+e):e;v["%n"]="\n";v["%p"]=c?"PM":"AM";v["%P"]=c?"pm":"am";v["%s"]=Math.floor(this.getTime()/1000);v["%S"]=(j<10)?("0"+j):j;v["%t"]="\t";v["%U"]=v["%W"]=v["%V"]=(p<10)?("0"+p):p;v["%u"]=q+1;v["%w"]=q;v["%y"]=(""+n).substr(2,2);v["%Y"]=n;v["%%"]="%";var t=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return l.replace(t,function(a){return v[a]||a;});}var o=l.match(t);for(var g=0;g<o.length;g++){var f=v[o[g]];if(f){t=new RegExp(o[g],"g");l=l.replace(t,f);}}return l;};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(b){var a=new Date(this);a.__msh_oldSetFullYear(b);if(a.getMonth()!=this.getMonth()){this.setDate(28);}this.__msh_oldSetFullYear(b);};window._dynarch_popupCalendar=null;
/*Calendar-en.js*/
Calendar._DN=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");Calendar._SDN=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun");Calendar._FD=0;Calendar._MN=new Array("January","February","March","April","May","June","July","August","September","October","November","December");Calendar._SMN=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");Calendar._TT={};Calendar._TT.INFO="About the calendar";Calendar._TT.ABOUT="Date selection:\n- Use the \xab, \xbb buttons to select year\n- Use the "+String.fromCharCode(8249)+", "+String.fromCharCode(8250)+" buttons to select month\n- Hold mouse button on any of the above buttons for faster selection.";Calendar._TT.ABOUT_TIME="\n\nTime selection:\n- Click on any of the time parts to increase it\n- or Shift-click to decrease it\n- or click and drag for faster selection.";Calendar._TT.PREV_YEAR="Prev. year (hold for menu)";Calendar._TT.PREV_MONTH="Prev. month (hold for menu)";Calendar._TT.GO_TODAY="Go Today";Calendar._TT.NEXT_MONTH="Next month (hold for menu)";Calendar._TT.NEXT_YEAR="Next year (hold for menu)";Calendar._TT.SEL_DATE="Select date";Calendar._TT.DRAG_TO_MOVE="Drag to move";Calendar._TT.PART_TODAY=" (today)";Calendar._TT.DAY_FIRST="Display %s first";Calendar._TT.WEEKEND="0,6";Calendar._TT.CLOSE="Close";Calendar._TT.TODAY="Today";Calendar._TT.TIME_PART="(Shift-)Click or drag to change value";Calendar._TT.DEF_DATE_FORMAT="%Y-%m-%d";Calendar._TT.TT_DATE_FORMAT="%a, %b %e";Calendar._TT.WK="wk";Calendar._TT.TIME="Time:";Calendar._TT.CLEAR="Clear Date";
/*calendar-setup.js*/
Calendar.setup=function(g){function f(h,i){if(typeof g[h]=="undefined"){g[h]=i}}f("inputField",null);f("displayArea",null);f("button",null);f("eventName","click");f("ifFormat","%Y/%m/%d");f("daFormat","%Y/%m/%d");f("singleClick",true);f("disableFunc",null);f("dateStatusFunc",g.disableFunc);f("dateText",null);f("firstDay",null);f("align","Br");f("range",[1900,2999]);f("weekNumbers",true);f("flat",null);f("flatCallback",null);f("onSelect",null);f("onClose",null);f("onUpdate",null);f("date",null);f("showsTime",false);f("timeFormat","24");f("electric",true);f("step",1);f("position",null);f("cache",false);f("showOthers",false);f("multiple",null);var c=["inputField","displayArea","button"];for(var b in c){if(typeof g[c[b]]=="string"){g[c[b]]=document.getElementById(g[c[b]])}}if(!(g.flat||g.multiple||g.inputField||g.displayArea||g.button)){return false}function a(i){var h=i.params;var j=(i.dateClicked||h.electric);if(j&&h.inputField){h.inputField.value=i.date.print(h.ifFormat);h.inputField.focus();if(typeof h.inputField.onchange=="function"){h.inputField.onchange()}}if(j&&h.displayArea){h.displayArea.innerHTML=i.date.print(h.daFormat)}if(j&&typeof h.onUpdate=="function"){h.onUpdate(i)}if(j&&h.flat){if(typeof h.flatCallback=="function"){h.flatCallback(i)}}if(j&&h.singleClick&&i.dateClicked){i.callCloseHandler()}}if(g.flat!=null){if(typeof g.flat=="string"){g.flat=document.getElementById(g.flat)}if(!g.flat){return false}var e=new Calendar(g.firstDay,g.date,g.onSelect||a);e.showsOtherMonths=g.showOthers;e.showsTime=g.showsTime;e.time24=(g.timeFormat=="24");e.params=g;e.weekNumbers=g.weekNumbers;e.setRange(g.range[0],g.range[1]);e.setDateStatusHandler(g.dateStatusFunc);e.getDateText=g.dateText;if(g.ifFormat){e.setDateFormat(g.ifFormat)}if(g.inputField&&typeof g.inputField.value=="string"){e.parseDate(g.inputField.value)}e.create(g.flat);e.show();return false}var d=g.button||g.displayArea||g.inputField;d["on"+g.eventName]=function(){var h=g.inputField||g.displayArea;var k=g.inputField?g.ifFormat:g.daFormat;var o=false;var m=window.calendar;if(!(m&&g.cache)){window.calendar=m=new Calendar(g.firstDay,g.date,g.onSelect||a,g.onClose||function(i){i.hide()});m.showsTime=g.showsTime;m.time24=(g.timeFormat=="24");m.weekNumbers=g.weekNumbers;o=true}else{if(g.date){m.setDate(g.date)}m.hide()}if(g.multiple){m.multiple={};for(var j=g.multiple.length;--j>=0;){var n=g.multiple[j];var l=n.print("%Y%m%d");m.multiple[l]=n}}m.showsOtherMonths=g.showOthers;m.yearStep=g.step;m.setRange(g.range[0],g.range[1]);m.params=g;m.setDateStatusHandler(g.dateStatusFunc);m.getDateText=g.dateText;m.setDateFormat(k);if(o){m.create()}if(h){m.parseDate(h.value||h.innerHTML)}m.refresh();if(!g.position){m.showAtElement(g.button||g.displayArea||g.inputField,g.align)}else{m.showAt(g.position[0],g.position[1])}return false};return e};