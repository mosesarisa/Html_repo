
function addStandardLevyTable(id,row)
{
	resetErrorList();
	if(id=="standardLevydiv1")
	{
		if(document.getElementById('standardLevydiv2').style.display=="")
		{
			if(selectedFlagStandardLevy2<=0)

			{
				alert(atleastOneCommodityDetails);
				return false;
			}
		}
		if(document.getElementById('standardLevydiv3').style.display=="")
		{
			if(selectedFlagStandardLevy3<=0)

			{
				alert(atleastOneCommodityDetails);
				return false;
			}
		}
		if(document.getElementById('standardLevydiv4').style.display=="")
		{
			if(selectedFlagStandardLevy4<=0)

			{
				alert(atleastOneCommodityDetails);
				return false;
			}
		}
		if(document.getElementById('standardLevydiv5').style.display=="")
		{
			if(selectedFlagStandardLevy5<=0)

			{
				alert(atleastOneCommodityDetails);
				return false;
			}
		}
		if(document.getElementById('standardLevydiv6').style.display=="")
		{
			if(selectedFlagStandardLevy6<=0)

			{
				alert(atleastOneCommodityDetails);
				return false;
			}
		}
		if(validateFormFields(paymentRegOTRPeriodYearJson))
		{
			if (validateFormFields(paymentRegOTRPeriodMonthJson,paymentRegOTRStdDevDtl1Json))
			{
				hideTab('TabView',5);
				resetErrorList();
				incError=0;
				var checkDuplicateFlag = checkDuplicateForStandard(row,'standardLevyDtl1');
				if(checkDuplicateFlag==false)
				{
					return false;
				}
				if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value)<=0)
				{
					alert(amtPayable);
					return false;	
				}
				if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_6').value)<=0)
				{
					alert(amtPaid);
					return false;	
				}
				if(addConfirm('a_standardLevyDtl1'))
				{
					if(document.getElementById('a_standardLevyDtl1').innerHTML!="Modify")
					{
						addrow('standardLevyDtl1', '4', '14', '4', 'validateDeleteRowIntoStandardLevyDtl1', 'validateModifyRowIntoStandardLevyDtl1', 'N','N')
					}
					else
					{
						return true;
					}
				}
			}
			else
			{
				getErrTabToggle('TabView','2');	
				tabview_switch('TabView', '2');
				hideAndShowTable("errorDiv");
				document.getElementById('btnTbl').style.display="none";
				return false;
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
			return false;
		}
	}
	else if(id=="standardLevydiv2")
	{
		if (validateFormFields(paymentRegOTRStdDevDtl2Json)) 
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl2_7').value)<=0)
			{
				alert(amtPayableByCommodity);
				return false;	
			}
			if(addConfirm('a_standardLevyDtl2'))
			{
				if(document.getElementById('a_standardLevyDtl2').innerHTML!="Modify")
				{
					addrow('standardLevyDtl2', '5', '5', '4', 'validateDeleteRowStandardLevy2Table', 'validateModifyRowStandardLevy2Table', 'N','N')
				}
				else
				{
					return true;
				}
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
			return false;
		}
	}
	else if(id=="standardLevydiv3")
	{
		if (validateFormFields(paymentRegOTRStdDevDtl3Json)) 
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl3_7').value)<=0)
			{
				alert(amtPayableByCommodity);
				return false;	
			}
			if(addConfirm('a_standardLevyDtl3'))
			{
				if(document.getElementById('a_standardLevyDtl3').innerHTML!="Modify")
				{
					addrow('standardLevyDtl3', '5', '5', '4', 'validateDeleteRowStandardLevy3Table', 'validateModifyRowStandardLevy3Table', 'N','N')
				}
				else
				{
					return true;
				}
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
			return false;
		}
	}
	else if(id=="standardLevydiv4")
	{
		if (validateFormFields(paymentRegOTRStdDevDtl4Json)) 
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl4_7').value)<=0)
			{
				alert(amtPayableByCommodity);
				return false;	
			}
			if(addConfirm('a_standardLevyDtl4')) 
			{
				if(document.getElementById('a_standardLevyDtl4').innerHTML!="Modify")
				{
					addrow('standardLevyDtl4', '5', '5', '4', 'validateDeleteRowStandardLevy4Table', 'validateModifyRowStandardLevy4Table', 'N','N')
				}
				else
				{
					return true;
				}
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
			return false;
		}
	}
	else if(id=="standardLevydiv5")
	{
		if (validateFormFields(paymentRegOTRStdDevDtl5Json)) 
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl5_7').value)<=0)
			{
				alert(amtPayableByCommodity);
				return false;	
			}
			if(addConfirm('a_standardLevyDtl5'))
			{
				if(document.getElementById('a_standardLevyDtl5').innerHTML!="Modify")
				{
					addrow('standardLevyDtl5', '5', '5', '4', 'validateDeleteRowStandardLevy5Table', 'validateModifyRowStandardLevy5Table', 'N','N')
				}
				else
				{
					return true;
				}
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
			return false;
		}
	}
	else if(id=="standardLevydiv6")
	{
		if (validateFormFields(paymentRegOTRStdDevDtl6Json)) 
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl6_7').value)<=0)
			{
				alert(amtPayableByCommodity);
				return false;	
			}
			if(addConfirm('a_standardLevyDtl6'))
			{
				if(document.getElementById('a_standardLevyDtl6').innerHTML!="Modify")
				{
					addrow('standardLevyDtl6', '5', '5', '4', 'validateDeleteRowStandardLevy6Table', 'validateModifyRowStandardLevy6Table', 'N','N')
				}
				else
				{
					return true;
				}
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
			return false;
		}
	}
	else if (id=='standardLevyDtlPartial1')
	{
		if (validateFormFields(paymentRegOTRPeriodMonthJson,paymentRegOTRStdDevDtlPartial1Json)) 
		{
			hideTab('TabView',5);
			resetErrorList();
			incError=0;
			var checkDuplicateFlag = checkDuplicateForStandard(row,'standardLevyDtlPartial1');
			if(checkDuplicateFlag==false)
			{
				return false;
			}
			if(removeCommaFrmInput(document.getElementById('in_standardLevyDtlPartial1_5').value)<=0)
			{
				alert(amtPayable);
				return false;	
			}
			if(removeCommaFrmInput(document.getElementById('in_standardLevyDtlPartial1_6').value)<=0)
			{
				alert(amtPaid);
				return false;	
			}
			if(addConfirm('a_standardLevyDtlPartial1')) 
			{
				if(document.getElementById('a_standardLevyDtlPartial1').innerHTML!="Modify")
				{
					addrow('standardLevyDtlPartial1', '4', '13', '4', 'validateDeleteRowIntoStandardLevyDtlPartial1', 'validateModifyRowIntoStandardLevyDtlPartial1', 'N','N')
				}
			}
		}
		else
		{
			getErrTabToggle('TabView','2');	
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
			return false;
		}
	}
	//added by Mingu for iTax - KEBS Integration :: START
	var kebsEntryNo = document.getElementById('kebsEntryNo').value;
	document.getElementById('in_standardLevyDtl1_4').value = kebsEntryNo;
	//added by Mingu for iTax - KEBS Integration :: END
}
function beforeAddStandardLevy2Function()
{
	document.getElementById('hidTotalAmtPaid').value=removeCommaFrmInput(document.getElementById('in_standardLevyDtl2_7').value);

	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl2_6').value;
}

function afterAddStandardLevy2Function()
{
	var tmpAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmt,10)+parseInt(document.getElementById('hidTotalAmtPaid').value,10)),true); 
	document.getElementById('in_standardLevyDtl2_6').value=document.getElementById('hidRateOfLevy').value;
	//checkAmtToBePaid();
	selectedFlagStandardLevy2=selectedFlagStandardLevy2+1;
}


function afterDeleteStandardLevy2Table()
{
	deleteFlagStandardLevy2 = 1;
	selectedFlagStandardLevy2 = selectedFlagStandardLevy2 -1;
}
function beforeModifyStandardLevy2Table(row)
{
	if(addStandardLevyTable('standardLevydiv2',row))
	{
		totalAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl2_6').value;
	}
	else
	{
		return false;
	}
}


function afterModifyStandardLevy2Table()
{
	modifyFlagStandardLevy2 = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtl2');  
	totalAmt = parseInt(removeCommaFrmInput(totalAmt),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[7].innerHTML),10) - parseInt(removeCommaFrmInput(tempAmtValStandard),10);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(totalAmt,true);
	document.getElementById('in_standardLevyDtl2_6').value=document.getElementById('hidRateOfLevy').value;
}

function beforeDeleteStandardLevy2Table()
{
	if(modifyFlagStandardLevy2==1 || modifyFlagStandardLevy1==1)
	{
		alert(confirmModifyingOperation);
		return false;
	}
}

function validateDeleteRowStandardLevy2Table(tab_str, rowno, cols)
{

	if(deleteFlagStandardLevy2==1 && modifyFlagStandardLevy2==0)
	{
		var table = document.getElementById('standardLevyDtl2');
		totalAmt = removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		var tempAmt = table.rows[rowno].cells[7].innerHTML;
		totalAmt =  parseInt(totalAmt,10) - parseInt(removeCommaFrmInput(tempAmt),10);
		document.getElementById('in_standardLevyDtl1_5').value = convertToKenyanShillingFormatVal(totalAmt, true);
		deleteFlagStandardLevy2 = 0;
	}
	else
	{
		deleteFlagStandardLevy2 = 0;
	}
}

function validateModifyRowStandardLevy2Table(tab_str, cols_1, rowno, cols_2)
{
	modifyFlagStandardLevy2 = 1;
	commonModifyFlag=1;
	tempAmtValStandard = document.getElementById('in_standardLevyDtl2_7').value;
}



function beforeAddStandardLevy3Function()
{
	document.getElementById('hidTotalAmtPaid').value=removeCommaFrmInput(document.getElementById('in_standardLevyDtl3_7').value);

	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl3_6').value;
}

function afterAddStandardLevy3Function()
{
	var tmpAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmt,10)+parseInt(document.getElementById('hidTotalAmtPaid').value,10)),true); 
	document.getElementById('in_standardLevyDtl3_6').readonly=false;
	document.getElementById('in_standardLevyDtl3_6').value=document.getElementById('hidRateOfLevy').value;
	document.getElementById('in_standardLevyDtl3_6').readonly=true;

	selectedFlagStandardLevy3=selectedFlagStandardLevy3+1;
}


function afterDeleteStandardLevy3Table()
{
	deleteFlagStandardLevy3 = 1;
	selectedFlagStandardLevy3 = selectedFlagStandardLevy3 -1;
}
function beforeModifyStandardLevy3Table(row)
{
	if(addStandardLevyTable('standardLevydiv3',row))
	{
		totalAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl3_6').value;
	}
	else
	{
		return false;
	}
}


function afterModifyStandardLevy3Table()
{
	modifyFlagStandardLevy3 = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtl3');  
	totalAmt = parseInt(removeCommaFrmInput(totalAmt),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[7].innerHTML),10) - parseInt(removeCommaFrmInput(tempAmtValStandard),10);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(totalAmt,true);
	document.getElementById('in_standardLevyDtl3_6').value=document.getElementById('hidRateOfLevy').value;
}

function beforeDeleteStandardLevy3Table()
{
	if(modifyFlagStandardLevy3==1 || modifyFlagStandardLevy1==1)
	{
		alert(confirmModifyingOperation);
		return false;
	}
}

function validateDeleteRowStandardLevy3Table(tab_str, rowno, cols)
{

	if(deleteFlagStandardLevy3==1 && modifyFlagStandardLevy3==0)
	{
		var table = document.getElementById('standardLevyDtl3');
		totalAmt = removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		var tempAmt = table.rows[rowno].cells[7].innerHTML;
		totalAmt =  parseInt(totalAmt,10) - parseInt(removeCommaFrmInput(tempAmt),10);
		document.getElementById('in_standardLevyDtl1_5').value = convertToKenyanShillingFormatVal(totalAmt, true);
		deleteFlagStandardLevy3 = 0;
	}
	else
	{
		deleteFlagStandardLevy3 = 0;
	}
}

function validateModifyRowStandardLevy3Table(tab_str, cols_1, rowno, cols_2)
{
	modifyFlagStandardLevy3 = 1;
	commonModifyFlag=1;
	tempAmtValStandard = document.getElementById('in_standardLevyDtl3_7').value;
}


function beforeAddStandardLevy4Function()
{
	document.getElementById('hidTotalAmtPaid').value=removeCommaFrmInput(document.getElementById('in_standardLevyDtl4_7').value);

	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl4_6').value;
}

function afterAddStandardLevy4Function()
{
	var tmpAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmt,10)+parseInt(document.getElementById('hidTotalAmtPaid').value,10)),true); 
	document.getElementById('in_standardLevyDtl4_6').readonly=false;
	document.getElementById('in_standardLevyDtl4_6').value=document.getElementById('hidRateOfLevy').value;
	document.getElementById('in_standardLevyDtl4_6').readonly=true;

	selectedFlagStandardLevy4=selectedFlagStandardLevy4+1;
}


function afterDeleteStandardLevy4Table()
{
	deleteFlagStandardLevy4 = 1;
	selectedFlagStandardLevy4 = selectedFlagStandardLevy4 -1;
}
function beforeModifyStandardLevy4Table(row)
{
	if(addStandardLevyTable('standardLevydiv4',row))
	{
		totalAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl4_6').value;
	}
	else
	{
		return false;
	}
}


function afterModifyStandardLevy4Table()
{
	modifyFlagStandardLevy4 = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtl4');  
	totalAmt = parseInt(removeCommaFrmInput(totalAmt),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[7].innerHTML),10) - parseInt(removeCommaFrmInput(tempAmtValStandard),10);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(totalAmt,true);
	document.getElementById('in_standardLevyDtl4_6').value=document.getElementById('hidRateOfLevy').value;
}

function beforeDeleteStandardLevy4Table()
{
	if(modifyFlagStandardLevy4==1 || modifyFlagStandardLevy1==1)
	{
		alert(confirmModifyingOperation);
		return false;
	}
}

function validateDeleteRowStandardLevy4Table(tab_str, rowno, cols)
{

	if(deleteFlagStandardLevy4==1 && modifyFlagStandardLevy4==0)
	{
		var table = document.getElementById('standardLevyDtl4');
		totalAmt = removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		var tempAmt = table.rows[rowno].cells[7].innerHTML;
		totalAmt =  parseInt(totalAmt,10) - parseInt(removeCommaFrmInput(tempAmt),10);
		document.getElementById('in_standardLevyDtl1_5').value = convertToKenyanShillingFormatVal(totalAmt, true);
		deleteFlagStandardLevy4 = 0;
	}
	else
	{
		deleteFlagStandardLevy4 = 0;
	}
}

function validateModifyRowStandardLevy4Table(tab_str, cols_1, rowno, cols_2)
{
	modifyFlagStandardLevy4 = 1;
	commonModifyFlag=1;
	tempAmtValStandard = document.getElementById('in_standardLevyDtl4_7').value;
}

function beforeAddStandardLevy5Function()
{
	document.getElementById('hidTotalAmtPaid').value=removeCommaFrmInput(document.getElementById('in_standardLevyDtl5_7').value);

	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl5_6').value;
}

function afterAddStandardLevy5Function()
{
	var tmpAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmt,10)+parseInt(document.getElementById('hidTotalAmtPaid').value,10)),true); 
	document.getElementById('in_standardLevyDtl5_6').readonly=false;
	document.getElementById('in_standardLevyDtl5_6').value=document.getElementById('hidRateOfLevy').value;
	document.getElementById('in_standardLevyDtl5_6').readonly=true;

	selectedFlagStandardLevy5=selectedFlagStandardLevy5+1;
}


function afterDeleteStandardLevy5Table()
{
	deleteFlagStandardLevy5 = 1;
	selectedFlagStandardLevy5 = selectedFlagStandardLevy5 -1;
}
function beforeModifyStandardLevy5Table(row)
{
	if(addStandardLevyTable('standardLevydiv5',row))
	{
		totalAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl5_6').value;
	}
	else
	{
		return false;
	}
}


function afterModifyStandardLevy5Table()
{
	modifyFlagStandardLevy5 = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtl5');  
	totalAmt = parseInt(removeCommaFrmInput(totalAmt),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[7].innerHTML),10) - parseInt(removeCommaFrmInput(tempAmtValStandard),10);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(totalAmt,true);
	document.getElementById('in_standardLevyDtl5_6').value=document.getElementById('hidRateOfLevy').value;
}

function beforeDeleteStandardLevy5Table()
{
	if(modifyFlagStandardLevy5==1 || modifyFlagStandardLevy1==1)
	{
		alert(confirmModifyingOperation);
		return false;
	}
}

function validateDeleteRowStandardLevy5Table(tab_str, rowno, cols)
{

	if(deleteFlagStandardLevy5==1 && modifyFlagStandardLevy5==0)
	{
		var table = document.getElementById('standardLevyDtl5');
		totalAmt = removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		var tempAmt = table.rows[rowno].cells[7].innerHTML;
		totalAmt =  parseInt(totalAmt,10) - parseInt(removeCommaFrmInput(tempAmt),10);
		document.getElementById('in_standardLevyDtl1_5').value = convertToKenyanShillingFormatVal(totalAmt, true);
		deleteFlagStandardLevy5 = 0;
	}
	else
	{
		deleteFlagStandardLevy5 = 0;
	}
}

function validateModifyRowStandardLevy5Table(tab_str, cols_1, rowno, cols_2)
{
	modifyFlagStandardLevy5 = 1;
	commonModifyFlag=1;
	tempAmtValStandard = document.getElementById('in_standardLevyDtl5_7').value;
}
function beforeAddStandardLevy6Function()
{
	document.getElementById('hidTotalAmtPaid').value=removeCommaFrmInput(document.getElementById('in_standardLevyDtl6_7').value);

	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl6_6').value;
}

function afterAddStandardLevy6Function()
{
	var tmpAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmt,10)+parseInt(document.getElementById('hidTotalAmtPaid').value,10)),true); 
	document.getElementById('in_standardLevyDtl6_6').readonly=false;
	document.getElementById('in_standardLevyDtl6_6').value=document.getElementById('hidRateOfLevy').value;
	document.getElementById('in_standardLevyDtl6_6').readonly=true;

	selectedFlagStandardLevy6=selectedFlagStandardLevy6+1;
}


function afterDeleteStandardLevy6Table()
{
	deleteFlagStandardLevy6 = 1;
	selectedFlagStandardLevy6 = selectedFlagStandardLevy6 -1;
}
function beforeModifyStandardLevy6Table(row)
{
	if(addStandardLevyTable('standardLevydiv6',row))
	{
		totalAmt=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl6_6').value;
	}
	else
	{
		return false;
	}
}


function afterModifyStandardLevy6Table()
{
	modifyFlagStandardLevy6 = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtl6');  
	totalAmt = parseInt(removeCommaFrmInput(totalAmt),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[7].innerHTML),10) - parseInt(removeCommaFrmInput(tempAmtValStandard),10);
	document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(totalAmt,true);
	document.getElementById('in_standardLevyDtl6_6').value=document.getElementById('hidRateOfLevy').value;
}

function beforeDeleteStandardLevy6Table()
{
	if(modifyFlagStandardLevy6==1 || modifyFlagStandardLevy1==1)
	{
		alert(confirmModifyingOperation);
		return false;
	}
}

function validateDeleteRowStandardLevy6Table(tab_str, rowno, cols)
{

	if(deleteFlagStandardLevy6==1 && modifyFlagStandardLevy6==0)
	{
		var table = document.getElementById('standardLevyDtl6');
		totalAmt = removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		var tempAmt = table.rows[rowno].cells[7].innerHTML;
		totalAmt =  parseInt(totalAmt,10) - parseInt(removeCommaFrmInput(tempAmt),10);
		document.getElementById('in_standardLevyDtl1_5').value = convertToKenyanShillingFormatVal(totalAmt, true);
		deleteFlagStandardLevy6 = 0;
	}
	else
	{
		deleteFlagStandardLevy6 = 0;
	}
}

function validateModifyRowStandardLevy6Table(tab_str, cols_1, rowno, cols_2)
{
	modifyFlagStandardLevy6 = 1;
	commonModifyFlag=1;
	tempAmtValStandard = document.getElementById('in_standardLevyDtl6_7').value;
}
function validateDeleteRowStandardLevy(tab_str, rowno, cols) 
{
	if(modifyFlagStandardLevy==1)
	{
		alert(confirmModifyingOperation);
	}
	if(deleteFlagStandardLevy==1 && modifyFlagStandardLevy==0 )
	{
		var table = document.getElementById('standardLevyDtl');  
		var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalTaxPayable').value);
		var tempAmt = table.rows[rowno].cells[7].innerHTML;
		totalAmt = totalAmt - parseInt(removeCommaFrmInput(tempAmt),"10");
		document.getElementById('txtTotalTaxPayable').value =  totalAmt;
		document.getElementById('txtTotalTaxPayable').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalTaxPayable").value, true);
		document.getElementById('txtTotalAmountPaid').value = convertToKenyanShillingFormatVal(totalAmt, true);
		selectedFlagStandardLevy=selectedFlagStandardLevy-1;
		deleteFlagStandardLevy = 0;
	}
	else
	{
		deleteFlagStandardLevy = 0;
	}
}
function afterDeleteStandardLevyFunction()
{
	deleteFlagStandardLevy = 1;

}
function validateModifyRowStandardLevy(tab_str, cols_1, rowno, cols_2) 
{
	modifyFlagStandardLevy = 1;
	commonModifyFlag=1;
	amtToPaidStdLevy = removeCommaFrmInput(document.getElementById('in_standardLevyDtl_7').value);
	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl_6').value;
}
function afterModifyRowStandardLevy() 
{
	alert(afterModifyRowStdLevy);
	modifyFlagStandardLevy = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtl');  
	var	totalAmt = removeCommaFrmInput(document.getElementById('txtTotalTaxPayable').value);
	var tempAmt = table.rows[rowno].cells[7].innerHTML;
	totalAmt =parseInt( totalAmt,10)-parseInt(amtToPaidStdLevy,10) + parseInt(removeCommaFrmInput(tempAmt),"10");
	document.getElementById('txtTotalTaxPayable').value =  totalAmt;
	document.getElementById('txtTotalTaxPayable').value = convertToKenyanShillingFormatVal(document.getElementById("txtTotalTaxPayable").value, true);
	document.getElementById('txtTotalAmountPaid').value = convertToKenyanShillingFormatVal(totalAmt, true);
	document.getElementById('in_standardLevyDtl1_5').value= convertToKenyanShillingFormatVal(totalAmt, true);
	document.getElementById('in_standardLevyDtl_6').value=document.getElementById('hidRateOfLevy').value;
}



function onChangeCalcAdjutStd()
{

	var underDeclaredPrevMonth=0;
	var overDeclaredPrevMonth=0;
	var penalty=0;
	if(validateFormFields(paymentRegOTRStdDevAmountDetailsJson)) 
	{
		hideTab('TabView',5);
		resetErrorList();
		incError=0;
		underDeclaredPrevMonth= trim(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_7').value),"");
		overDeclaredPrevMonth= trim(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_8').value),"");
		penalty= trim(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_9').value),"");
		if(underDeclaredPrevMonth==null || underDeclaredPrevMonth=="")
		{
			underDeclaredPrevMonth=0;
			document.getElementById('in_standardLevyDtl1_7').value=0;
		}
		if(overDeclaredPrevMonth==null || overDeclaredPrevMonth=="")
		{
			overDeclaredPrevMonth=0;
			document.getElementById('in_standardLevyDtl1_8').value=0;
		}
		if(penalty==null || penalty=="")
		{
			penalty=0;
			document.getElementById('in_standardLevyDtl1_9').value=0;
		}
		balnceAdjustmentPervStdLevy=document.getElementById('in_standardLevyDtl1_10').value;
		var txtBalnceAdjustment= parseInt(underDeclaredPrevMonth,10)+parseInt(penalty,10)-parseInt(overDeclaredPrevMonth,10);
		document.getElementById('in_standardLevyDtl1_7').value=convertToKenyanShillingFormatVal(parseInt(underDeclaredPrevMonth,10),true);
		document.getElementById('in_standardLevyDtl1_8').value=convertToKenyanShillingFormatVal(parseInt(overDeclaredPrevMonth,10),true);
		document.getElementById('in_standardLevyDtl1_9').value=convertToKenyanShillingFormatVal(parseInt(penalty,10),true);
		document.getElementById('in_standardLevyDtl1_10').value=convertToKenyanShillingFormatVal(parseInt(txtBalnceAdjustment,10),true);
		document.getElementById('in_standardLevyDtl1_5').value= parseInt(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value),10)+parseInt(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_10').value),10)-parseInt(removeCommaFrmInput(balnceAdjustmentPervStdLevy),10);
		document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(document.getElementById('in_standardLevyDtl1_5').value,true);

		//document.getElementById('txtTotalAmountPaid').value=document.getElementById('txtTotalTaxPayable').value;
		//checkAmtToBePaid();
	}
	else
	{
		getErrTabToggle('TabView','2');	
		tabview_switch('TabView', '2');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}
}
function calcAmtPaybleCommodity(id)
{
	var exFactory=0;
	var rateOfLevy=0;
	var levyRateId;
	var amoutOfComodityId;
	var commodity=id.substring(0,20);
	amoutOfComodityId=commodity+"7";
	levyRateId=commodity+"6";
	//if (validateFormFields(paymentRegOTRStdDevAddRowDetailsJson) ) 
	{		
		exFactory=removeCommaFrmInput(document.getElementById(id).value);
		rateOfLevy=document.getElementById(levyRateId).value;
		document.getElementById(amoutOfComodityId).value=convertToKenyanShillingFormatVal(Math.ceil(parseInt(exFactory,10)*parseFloat(rateOfLevy)/parseInt(100,10)),true);
		document.getElementById(id).value=convertToKenyanShillingFormatVal(exFactory,true);

		//document.getElementById('in_standardLevyDtl_7').value=convertToKenyanShillingFormatValMath.ceil((parseInt(exFactory,10)*parseFloat(rateOfLevy)),true);
	}
	/*else
	{
		document.getElementById(id).value="";
		getErrTabToggle('TabView','5');	
		tabview_switch('TabView', '5');
		hideAndShowTable("errorDiv");
		document.getElementById('btnTbl').style.display="none";
	}*/
}
function checkAmtToBePaid()
{
	if(document.getElementById('cmbTaxSubHead').value==standardObligationId)
	{
		var amtPayableOtr=removeCommaFrmInput(document.getElementById('txtTotalAmountPayableOTR').value);
		var amtPaidOtr=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOTR').value);
		if(parseInt(amtPayableOtr,10)<=parseInt(removeCommaFrmInput(minAmtToPaid),10)||(parseInt(amtPayableOtr,10)<parseInt(removeCommaFrmInput(minAmtToPaidConditional),10) && parseInt(amtPayableOtr,10)>=parseInt(removeCommaFrmInput(minAmtToPaid),10)))
		{
			if(parseInt(amtPaidOtr,10)<parseInt(removeCommaFrmInput(minAmtToPaid),10))
			{
				alert(modifyAmtToMinimum);
				//	document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(minAmtToPaid),true);
				return false;
			}
			if(parseInt(amtPaidOtr,10)>parseInt(removeCommaFrmInput(maxAmtToPaid),10))
			{
				alert(modifyAmtToMaximum);
				//document.getElementById('txtTotalAmountPaidOTR').value=maxAmtToPaid;
				return false;
			}
			return true;
		}
		if(parseInt(amtPayableOtr,10)>=parseInt(removeCommaFrmInput(minAmtToPaidConditional),10))
		{
			if(parseInt(amtPaidOtr,10)<parseInt(removeCommaFrmInput(minAmtToPaidConditional),10))
			{
				alert(modifyAmtToMinimumThirty);
				//document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(minAmtToPaidConditional),true);
				return false;
			}
			if(parseInt(amtPaidOtr,10)>parseInt(removeCommaFrmInput(maxAmtToPaid),10))
			{
				alert(modifyAmtToMaximumForty);
				//document.getElementById('txtTotalAmountPaidOTR').value=maxAmtToPaid;
				return false;
			}
			return true;
		}
		if(parseInt(amtPaidOtr,10)>parseInt(removeCommaFrmInput(maxAmtToPaid),10))
		{
			alert(modifyAmtToMaximumForty);
			//document.getElementById('txtTotalAmountPaidOTR').value=maxAmtToPaid;
			return false;
		}
		return true;
	}

}

function beforeAddStandardLevyDtl1(row)
{
	var checkDuplicateFlag = checkDuplicateForStandard(row,'standardLevyDtl1');
	if(checkDuplicateFlag){
		checkDuplicateFlag = isStdLevyRegistered();
	}
	if(checkDuplicateFlag==false)
	{
		return false;
	}
	else
	{
		var taxPeriod=document.getElementById('cmbTaxPeriodMonth').selectedIndex;
		var taxPeriodValue= document.getElementById('cmbTaxPeriodMonth')[taxPeriod].text;
		var taxPeriod = document.getElementById('cmbTaxPeriodYear').selectedIndex;
		var taxPeriodYear =document.getElementById('cmbTaxPeriodYear')[taxPeriod].text;
		document.getElementById('in_standardLevyDtl1_3').value=taxPeriodValue+"-"+taxPeriodYear;
		document.getElementById('standardLevyDtl1').style.display = '';
		document.getElementById('in_standardLevyDtl1_14').value=document.getElementById('cmbTaxPeriodMonth').value;
		document.getElementById('hidTotalAmtPaid').value=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value);
		TotalAmtToPaidStandardLevy1=removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_6').value);

		if(addRowArray.length>0)
		{
			document.getElementById('in_standardLevyDtl1_11').value=addRowArray[0];
		}
		else
		{
			alert(cntAddMoreThanFive);
			return false;
		}
	}

	/*cntrForDynamicTable=parseInt(cntrForDynamicTable,10)+parseInt(1,10);
	alert(cntrForDynamicTable);
	//alert(cntrForDynamicTable);
	if(cntrForDynamicTable<7)
	{
		document.getElementById('in_standardLevyDtl1_11').value="standardLevydiv"+cntrForDynamicTable;
	}
	else
	{
		cntrForDynamicTable=6;
		alert("You cannot add more than 5 details.");
		return false;
	}*/
}
function afterAddStandardLevyDtl1()
{
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPayableOTR').value);
	var tmpAmtToPaid=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOTR').value);
	document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmtToPaid,10)+parseInt(TotalAmtToPaidStandardLevy1,10)),true); 
	document.getElementById('txtTotalAmountPayableOTR').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmt,10)+parseInt(document.getElementById('hidTotalAmtPaid').value,10)),true); 
	selectedFlagStandardLevy1=selectedFlagStandardLevy1+1;
	document.getElementById('in_standardLevyDtl1_5').value=0;
	document.getElementById('in_standardLevyDtl1_6').value=0;
	document.getElementById('in_standardLevyDtl1_7').value=0;
	document.getElementById('in_standardLevyDtl1_8').value=0;
	document.getElementById('in_standardLevyDtl1_9').value=0;
	document.getElementById('in_standardLevyDtl1_10').value=0;
	//checkAmtToBePaid();
	document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
	document.getElementById(addRowArray[0]).style.display='none';
	if(addRowArray.length==1)
	{
		lastValueOfArray=addRowArray[0];
		document.getElementById(addRowArray[0]).style.display='';
	}
	addRowArray.splice(0,1);
	if(addRowArray.length>0)
	{
		document.getElementById(addRowArray[0]).style.display='';
	}
	document.getElementById('in_standardLevyDtl1_7').readOnly=false;
	document.getElementById('in_standardLevyDtl1_8').readOnly=false;
	document.getElementById('cmbTaxPeriodYear').selectedIndex=0; 
	document.getElementById('cmbTaxPeriodMonth').disabled=true;

}

function beforeModifyIntoStandardLevyDtl1(row)
{
	var checkDuplicateFlag = addStandardLevyTable('standardLevydiv1',row);
	if(checkDuplicateFlag==false)
	{
		return false;
	}
	else
	{
		totalAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPayableOTR').value);
		amtToPaidStd=removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOTR").value);
		var taxPeriod=document.getElementById('cmbTaxPeriodMonth').selectedIndex;
		var taxPeriodValue= document.getElementById('cmbTaxPeriodMonth')[taxPeriod].text;
		var taxPeriod = document.getElementById('cmbTaxPeriodYear').selectedIndex;
		var taxPeriodYear =document.getElementById('cmbTaxPeriodYear')[taxPeriod].text;
		document.getElementById('in_standardLevyDtl1_3').value=taxPeriodValue+"-"+taxPeriodYear;
		document.getElementById('in_standardLevyDtl1_14').value=document.getElementById('cmbTaxPeriodMonth').value;
	}

	//document.getElementById('cmbTaxPeriodMonth').value=document.getElementById('in_widowsTable_11').value;
}


function afterModifyIntoStandardLevyDtl1()
{
	modifyFlagStandardLevy1 = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtl1'); 
	totalAmt = parseInt(removeCommaFrmInput(totalAmt),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[5].innerHTML),10) - parseInt(removeCommaFrmInput(tempAmtValStandard1),10);
	amtToPaidStd = parseInt(removeCommaFrmInput(amtToPaidStd),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[6].innerHTML),10) - parseInt(removeCommaFrmInput(TotalAmtToPaidStd),10);
	document.getElementById('txtTotalAmountPayableOTR').value = convertToKenyanShillingFormatVal(totalAmt, true);
	document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(amtToPaidStd, true);
	document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
	document.getElementById(addRowArray[0]).style.display='none';
	addRowArray.splice(0,1);
	if(addRowArray.length>0)
	{
		document.getElementById(addRowArray[0]).style.display='';
	}
	else
	{
		document.getElementById(lastValueOfArray).style.display='';
	}
	document.getElementById('in_standardLevyDtl1_5').value=0;
	document.getElementById('in_standardLevyDtl1_6').value=0;
	document.getElementById('in_standardLevyDtl1_7').value=0;
	document.getElementById('in_standardLevyDtl1_8').value=0;
	document.getElementById('in_standardLevyDtl1_9').value=0;
	document.getElementById('in_standardLevyDtl1_10').value=0;
	document.getElementById('in_standardLevyDtl1_7').readOnly=false;
	document.getElementById('in_standardLevyDtl1_8').readOnly=false;
	document.getElementById('in_standardLevyDtl1_7').className='form101_textfcurr form101_textfcurr_width textonlyRight';
	document.getElementById('in_standardLevyDtl1_8').className='form101_textfcurr form101_textfcurr_width textonlyRight';
	document.getElementById('cmbTaxPeriodYear').selectedIndex=0; 
	document.getElementById('cmbTaxPeriodMonth').disabled=true;
	if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
	{
		document.getElementById('cmbTaxPeriodMonth').disabled=true;
		document.getElementById('in_standardLevyDtl1_7').readOnly=true;
		document.getElementById('in_standardLevyDtl1_8').readOnly=true;
		document.getElementById('in_standardLevyDtl1_7').className='readonlyInput form101_textfcurr_width textonlyRight';
		document.getElementById('in_standardLevyDtl1_8').className='readonlyInput form101_textfcurr_width textonlyRight';
	}
	/*if(cntrForDynamicTable<7)
	{
		if(cntrForDynamicTable<6)
		{
			document.getElementById("standardLevydiv"+cntrForDynamicTable).style.display='none';
		}
		var i=parseInt(cntrForDynamicTable,10)+parseInt(1,10);
		if(i<7)
		{
			document.getElementById("standardLevydiv"+i).style.display='';
		}
	}*/
}

function validateModifyRowIntoStandardLevyDtl1(tab_str, cols_1, rowno, cols_2)
{
	modifyFlagStandardLevy1 = 1;
	commonModifyFlag=1;
	tempAmtValStandard1 = document.getElementById('in_standardLevyDtl1_5').value;
	TotalAmtToPaidStd=document.getElementById('in_standardLevyDtl1_6').value;
	var year =parseInt(document.getElementById('in_standardLevyDtl1_14').value.substr(6, document.getElementById('in_standardLevyDtl1_14').value.length),10);
	document.getElementById('cmbTaxPeriodYear').value=year;
	getSelectedMonthOfSelectedYearWeb('cmbTaxPeriodYear','cmbTaxPeriodMonth','false');
	document.getElementById('cmbTaxPeriodMonth').value=document.getElementById('in_standardLevyDtl1_14').value;

	if(addRowArray.length==0)
	{
		document.getElementById(document.getElementById('in_standardLevyDtl1_11').value).style.display='';
		document.getElementById(lastValueOfArray).style.display='none';
		addRowArray.splice(0,0,document.getElementById('in_standardLevyDtl1_11').value); 
	}
	else
	{
		addRowArray.splice(0,0,document.getElementById('in_standardLevyDtl1_11').value); 
		document.getElementById(document.getElementById('in_standardLevyDtl1_11').value).style.display='';
		document.getElementById(addRowArray[1]).style.display='none';
	}
	if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_7').value)>0)
	{
		document.getElementById('in_standardLevyDtl1_7').readOnly=false;
		document.getElementById('in_standardLevyDtl1_8').readOnly=true;
	}
	if(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_8').value)>0)
	{
		document.getElementById('in_standardLevyDtl1_7').readOnly=true;
		document.getElementById('in_standardLevyDtl1_8').readOnly=false;
	}
	/*if(cntrForDynamicTable==7)
	{
		var i=cntrForDynamicTable-1;
		document.getElementById("standardLevydiv"+i).style.display='none';
	}
	else
	{
		var i=cntrForDynamicTable+1;
		document.getElementById("standardLevydiv"+i).style.display='none';
	}*/

}

function afterDeleteIntoStandardLevyDtl1(rows)
{
	deleteFlagStandardLevy1 = 1;
	selectedFlagStandardLevy1 = selectedFlagStandardLevy1 -1;
	var deleteRowValue=document.getElementById('id_standardLevyDtl1_'+rows).value.split(propertyValueDelimiterStandard);
	var deleteRowValueOfDivId=deleteRowValue[8].split(columnsDelimiterStandard);
	addRowArray.splice(0,0,deleteRowValueOfDivId[1]); 
	var id=deleteRowValueOfDivId[1].substr(15,16);
	var tab_str="standardLevyDtl"+id;
	if(id==2)
	{
		selectedFlagStandardLevy2=0;
	}
	if(id==3)
	{
		selectedFlagStandardLevy3=0;
	}
	if(id==4)
	{
		selectedFlagStandardLevy4=0;
	}
	if(id==5)
	{
		selectedFlagStandardLevy5=0;
	}
	if(id==6)
	{
		selectedFlagStandardLevy6=0;
	}
	for(var i=document.getElementById(tab_str).rows.length; i > 1;i--)
	{
		document.getElementById(tab_str).deleteRow(i-1);
	}
	document.getElementById(addRowArray[0]).style.display='';

	if(addRowArray.length>1)
	{
		document.getElementById(addRowArray[1]).style.display='none';
	}
	else
	{
		document.getElementById(lastValueOfArray).style.display='none';
	}
}
function beforeDeleteStandardLevyDtl1()
{
	if(modifyFlagStandardLevy1==1 || modifyFlagStandardLevy2==1  || modifyFlagStandardLevy3==1  || modifyFlagStandardLevy4==1  || modifyFlagStandardLevy5==1  || modifyFlagStandardLevy6==1 )
	{
		alert(confirmModifyingOperation);
		return false;
	}
}

function validateDeleteRowIntoStandardLevyDtl1(tab_str, rowno, cols)
{

	if(deleteFlagStandardLevy1==1 && modifyFlagStandardLevy1==0)
	{
		var table = document.getElementById('standardLevyDtl1');
		totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPayableOTR').value);
		var tempAmt = table.rows[rowno].cells[5].innerHTML;
		totalAmt =  parseInt(totalAmt,10) - parseInt(removeCommaFrmInput(tempAmt),10);
		document.getElementById('txtTotalAmountPayableOTR').value = convertToKenyanShillingFormatVal(totalAmt, true);
		amtToPaidStd=removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOTR").value);
		amtToPaidStd= parseInt(amtToPaidStd,10)-parseInt(removeCommaFrmInput(table.rows[rowno].cells[6].innerHTML),10);
		document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(amtToPaidStd, true);
		deleteFlagStandardLevy1 = 0;
	}
	else
	{
		deleteFlagStandardLevy1 = 0;
	}
}

function checkDuplicateForStandard(r,id)
{
	rows=r;

	tabObj1 = document.getElementById(id);

	var taxPeriodValue;
	var taxPeriod = document.getElementById('cmbTaxPeriodMonth').selectedIndex;
	var taxPeriodMonth =document.getElementById('cmbTaxPeriodMonth')[taxPeriod].text;
	var taxPeriod = document.getElementById('cmbTaxPeriodYear').selectedIndex;
	var taxPeriodYear =document.getElementById('cmbTaxPeriodYear')[taxPeriod].text;
	taxPeriodValue=trim(taxPeriodMonth)+'-'+trim(taxPeriodYear);

	if(tabObj1.rows.length==1)
	{
	}
	else
	{ 
		for (var i = 1, n = tabObj1.rows.length; i <n; i++) 
		{ 
			if(modifyFlagStandardLevy1==1)
			{
				var modify;
				if(document.all)
				{
					modify=trim(tabObj1.rows[i].cells[2].innerText);
				}
				else
				{
					modify=trim(tabObj1.rows[i].cells[2].textContent,"");
				}
				if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete"  && (trim(tabObj1.rows[i].cells[3].innerHTML)==taxPeriodValue) && (trim(modify)==trim("Modify")))
				{
					alert(alreadyAddedDetials);
					return false;
				}
			}
			else
			{
				if((trim(document.getElementById('id_temp_'+id+'_'+i+'_1').value))=="Delete"  && (trim(tabObj1.rows[i].cells[3].innerHTML)==taxPeriodValue))
				{
					alert(alreadyAddedDetials);
					return false;
				}
			}
		}
	}
	return true;

}

function clearStdTbl2()
{
	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl2_6').value;
	if(	clear_table('standardLevyDtl2','5'))
	{
		modifyFlagStandardLevy2=0;
		commonModifyFlag=0;
		document.getElementById('in_standardLevyDtl2_6').value=document.getElementById('hidRateOfLevy').value;
	}
}
function clearStdTbl3()
{
	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl3_6').value;
	if(clear_table('standardLevyDt3','5'))
	{
		modifyFlagStandardLevy3=0;
		commonModifyFlag=0;
		document.getElementById('in_standardLevyDtl3_6').value=document.getElementById('hidRateOfLevy').value;
	}
}
function clearStdTbl4()
{
	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl4_6').value;
	if(clear_table('standardLevyDtl4','5'))
	{
		modifyFlagStandardLevy4=0;
		commonModifyFlag=0;
		document.getElementById('in_standardLevyDtl4_6').value=document.getElementById('hidRateOfLevy').value;
	}
}
function clearStdTbl5()
{
	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl5_6').value;
	if(clear_table('standardLevyDtl5','5'))
	{
		modifyFlagStandardLevy5=0;
		commonModifyFlag=0;
		document.getElementById('in_standardLevyDtl5_6').value=document.getElementById('hidRateOfLevy').value;
	}
}
function clearStdTbl6()
{
	document.getElementById('hidRateOfLevy').value=document.getElementById('in_standardLevyDtl6_6').value;
	if(clear_table('standardLevyDtl6','5'))
	{	
		modifyFlagStandardLevy6=0;
		commonModifyFlag=0;
		document.getElementById('in_standardLevyDtl6_6').value=document.getElementById('hidRateOfLevy').value;
	}
}
function clearStdTbl1()
{
	if(document.getElementById('in_standardLevyDtl1_5').value=="")
	{
		document.getElementById('in_standardLevyDtl1_5').value=0;
	}
	if(document.getElementById('in_standardLevyDtl1_10').value=="")
	{
		document.getElementById('in_standardLevyDtl1_10').value=0;
	}
	var tempAmt=parseInt(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_5').value),10)-parseInt(removeCommaFrmInput(document.getElementById('in_standardLevyDtl1_10').value),10);
	if(clear_table('standardLevyDtl1','12'))
	{
		if(modifyFlagStandardLevy1>0)
		{
			if(addRowArray.length>0)
			{
				document.getElementById(addRowArray[0]).style.display='none';
			}
			addRowArray.splice(0,1);
			if(addRowArray.length>0)
			{
				document.getElementById(addRowArray[0]).style.display='';
			}
			else
			{
				document.getElementById(lastValueOfArray).style.display='';
			}
		}
		modifyFlagStandardLevy1=0;
		commonModifyFlag=0;
		document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
		document.getElementById('in_standardLevyDtl1_5').value=convertToKenyanShillingFormatVal(tempAmt,true);
		document.getElementById('in_standardLevyDtl1_6').value=0;
		document.getElementById('in_standardLevyDtl1_7').value=0;
		document.getElementById('in_standardLevyDtl1_8').value=0;
		document.getElementById('in_standardLevyDtl1_9').value=0;
		document.getElementById('in_standardLevyDtl1_10').value=0;
		document.getElementById('in_standardLevyDtl1_7').readOnly=false;
		document.getElementById('in_standardLevyDtl1_8').readOnly=false;
		document.getElementById('cmbTaxPeriodYear').selectedIndex=0; 
		document.getElementById('cmbTaxPeriodMonth').disabled=true;

	}
}
function fetchStdDetail(hdrId,obligationId)
{
	document.getElementById('standardLevyTbl').style.display='none';
	document.getElementById('standardLevyAdd').style.display='none';
	document.getElementById('standardLevyDtl').style.display='none'; 
	document.getElementById('standardLevyTbl1').style.display='none';
	document.getElementById('standardLevyFieldlset').style.display='none';
	document.getElementById('txtTotalAmountPayableOTR').value=0;
	document.getElementById('txtTotalAmountPaidOTR').value=0;
	FetchSpecialObligationDtlWeb.fetchSpecialObligationDtlWeb(hdrId,obligationId,function(data){
		document.getElementById("hidgsonStrForPmtDetailDTO").value=data.gsonStrForPmtDetailDTO;
		var StdDetailList=data.pmtSplStdList;
		var PmtDetailDto=data;
		if(data!=null){
			var cntr=0;
			var tabObj=document.getElementById("standardLevyHdrTable");
			for(var l=tabObj.rows.length; l >1 ;l--){
				tabObj.deleteRow(l -1);
				var tabRow=tabObj.insertRow(tabObj.rows.length);
				tabRow.id="standardLevyHdrTable"+cntr;
				var tabCell=new Array();
				for (var j=0;j<9;j++){
					tabCell[j]=tabRow.insertCell(j);
				}

				tabCell[0].innerHTML=cntr+1;
				tabCell[0].style.textAlign="center";
				tabCell[0].style.fontSize="11";

				tabCell[1].innerHTML=PmtDetailDto.entryNo;
				tabCell[1].style.textAlign="center";
				tabCell[1].style.fontSize="11";

				tabCell[2].innerHTML=convertToKenyanShillingFormatVal(Math.ceil(PmtDetailDTO.underDecPrevMnthStd),true);;
				tabCell[2].style.textAlign="center";
				tabCell[2].style.fontSize="11";

				tabCell[3].innerHTML=convertToKenyanShillingFormatVal(Math.ceil(PmtDetailDTO.overDecPrevMnthStd),true);
				tabCell[3].style.textAlign="right";
				tabCell[3].style.fontSize="11";

				tabCell[4].innerHTML=convertToKenyanShillingFormatVal(Math.ceil(PmtDetailDTO.penaltyStd),true);
				tabCell[4].style.textAlign="right";
				tabCell[4].style.fontSize="11";

				tabCell[5].innerHTML=convertToKenyanShillingFormatVal(Math.ceil(PmtDetailDTO.balAdjstStd),true);
				tabCell[5].style.textAlign="right";
				tabCell[5].style.fontSize="11";

				var element=document.createElement('input');
				element.type='hidden';
				element.value=PmtDetailDTO.hdrId; //dtl id 
				element.width="0%";
				tabCell[6].appendChild(element);
				tabCell[6].style.display="none";

				var element=document.createElement('input');
				element.type='hidden';
				element.value=hdrId; 
				element.width="0%";
				tabCell[7].appendChild(element);
				tabCell[7].style.display="none";

				document.getElementById("standardLevyHdrTable").style.display="";
			}
		}

		if(StdDetailList.length>=1){
			var cntr=0;
			var tabObj=document.getElementById("standardLevyDetailTable");
			for(var l=tabObj.rows.length; l >1 ;l--){
				tabObj.deleteRow(l -1);
			}	
			for(var i=0;i<StdDetailList.length;i++){
				cntr=parseInt(cntr);
				var tabRow=tabObj.insertRow(tabObj.rows.length);
				tabRow.id="standardLevyDetailTable"+cntr;
				var tabCell=new Array();
				for (var j=0;j<9;j++){
					tabCell[j]=tabRow.insertCell(j);
				}
				var PmtSplDetailDTO=StdDetailList[i];

				tabCell[0].innerHTML=cntr+1;
				tabCell[0].style.textAlign="center";
				tabCell[0].style.fontSize="11";

				tabCell[1].innerHTML=PmtSplDetailDTO.comoType;
				tabCell[1].style.textAlign="center";
				tabCell[1].style.fontSize="11";

				tabCell[2].innerHTML=PmtSplDetailDTO.quntManu;
				tabCell[2].style.textAlign="center";
				tabCell[2].style.fontSize="11";

				tabCell[3].innerHTML=convertToKenyanShillingFormatVal(Math.ceil(PmtSplDetailDTO.exFactVal),true);
				tabCell[3].style.textAlign="right";
				tabCell[3].style.fontSize="11";

				tabCell[4].innerHTML=convertToKenyanShillingFormatVal(Math.ceil(PmtSplDetailDTO.levyRate),true);
				tabCell[4].style.textAlign="right";
				tabCell[4].style.fontSize="11";

				tabCell[5].innerHTML=convertToKenyanShillingFormatVal(Math.ceil(PmtSplDetailDTO.amtPaidByCommo),true);
				tabCell[5].style.textAlign="right";
				tabCell[5].style.fontSize="11";

				var element=document.createElement('input');
				element.type='hidden';
				element.value=PmtSplDetailDTO.hdrId; //dtl id 
				element.width="0%";
				tabCell[6].appendChild(element);
				tabCell[6].style.display="none";

				var element=document.createElement('input');
				element.type='hidden';
				element.value=hdrId; 
				element.width="0%";
				tabCell[7].appendChild(element);
				tabCell[7].style.display="none";

				cntr=cntr+1;
			}
			document.getElementById("standardLevyDetailTable").style.display="";
		}

	});
	document.getElementById('txtTotalAmountPaidOTR').value=remainingAmountForPartial;
	document.getElementById('txtTotalAmountPayableOTR').value=remainingAmountForPartial;
	isPartial="yes";
}


function showStandardPartialTable(partialDetailArray){
	if(partialDetailArray.length>=1){
		var cntr = 0;
		var tabObj = document.getElementById("in_SplObligHdrTbl_5");
		for(var l = tabObj.rows.length; l >1 ;l--){
			tabObj.deleteRow(l -1);
		}	
		for(var i=0;i<partialDetailArray.length;i++){
			cntr = parseInt(cntr);
			var tabRow = tabObj.insertRow(tabObj.rows.length);
			tabRow.id="stdHdrRow_"+cntr;
			var tabCell = new Array();
			for (var j=0;j<12;j++){
				tabCell[j] = tabRow.insertCell(j);
			}
			var pmtSplDetailVO = partialDetailArray[i];
			/*if(document.all)
			{
				var element = document.createElement("<input type = 'radio' onclick = 'onSelectStdHdrRadio(this);'>");
				element.setAttribute("name", "stdRadio");
				element.setAttribute("id", "stdRadio_"+cntr);
				element.setAttribute("value", cntr);					            
				tabCell[0].appendChild(element);

			}
			else{
				var element = document.createElement('input');       
				element.setAttribute('type', 'radio');     
				element.setAttribute('name', 'stdRadio');
				element.setAttribute('id', 'stdRadio_'+cntr);
				element.setAttribute('value', cntr);     
				element.setAttribute("onclick","javascript:onSelectStdHdrRadio(this);");
				tabCell[0].appendChild(element);
			}*/
			
			var element = document.createElement('input');       
			element.type ='radio';
			element.onclick = function () {onSelectStdHdrRadio(this);};
			element.value = cntr;
			element.id = 'stdRadio_'+cntr;
			element.name = "stdRadio";
			element.className='bordercl';
			tabCell[0].appendChild(element); 

			/*	tabCell[0].innerHTML = cntr+1;
			tabCell[0].style.textAlign="center";
			tabCell[0].style.fontSize="11";*/

			tabCell[1].innerHTML = pmtSplDetailVO.taxPeriod;
			tabCell[1].style.textAlign="center";
			tabCell[1].style.fontSize="11";

			tabCell[2].innerHTML = pmtSplDetailVO.entryNoStd;
			tabCell[2].style.textAlign="center";
			tabCell[2].style.fontSize="11";

			/*tabCell[3].innerHTML =convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.exFactVal).toFixed(2),true);
			tabCell[3].style.textAlign="center";
			tabCell[3].style.fontSize="11";*/

			tabCell[3].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.valueOfTaxPayable).toFixed(2),true);
			tabCell[3].style.textAlign="right";
			tabCell[3].style.fontSize="11";

			tabCell[4].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.amountPaid).toFixed(2),true);
			tabCell[4].style.textAlign="right";
			tabCell[4].style.fontSize="11";

			tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.amountPayable).toFixed(2),true);
			tabCell[5].style.textAlign="right";
			tabCell[5].style.fontSize="11";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.bclSplObilgationHdrId;
			element.width = "0%";
			tabCell[6].appendChild(element);
			tabCell[6].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.bclSplObilgationDtlId;
			element.width = "0%";
			tabCell[7].appendChild(element);
			tabCell[7].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.obilgationHdrId;
			element.width = "0%";
			tabCell[8].appendChild(element);
			tabCell[8].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.obilgationDtlId;
			element.width = "0%";
			tabCell[9].appendChild(element);
			tabCell[9].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.fromDate;
			element.width = "0%";
			tabCell[10].appendChild(element);
			tabCell[10].style.display = "none";

			var element = document.createElement('input');
			element.type = 'hidden';
			element.value =  pmtSplDetailVO.toDate;
			element.width = "0%";
			tabCell[11].appendChild(element);
			tabCell[11].style.display = "none";
			cntr = cntr+1;
		}
		document.getElementById("navigationTableSplHdr").style.display = '';
		document.getElementById("navigationTableSpltbl").style.display = '';
		document.getElementById("in_SplObligHdrTbl_5").style.display = "";
	}
}

function onSelectStdHdrRadio(obj)
{
	rowNumbmerPartial=obj.value;
	if((selectedFlagStandardLevy1>0 || selectedFlagStandardLevy2>0 || selectedFlagStandardLevy3>0 || selectedFlagStandardLevy4>0 || selectedFlagStandardLevy5>0 || selectedFlagStandardLevy6>0) && document.getElementById('hidIsPartial').value != "Y")
	{
		alert(cntAddPrevLiab);
		document.getElementById('stdRadio_'+rowNumbmerPartial).checked=false;
	}
	else
	{
		var taxPayerId=document.getElementById('hidTaxPayerId').value;
		document.getElementById('hidIsPartial').value = "Y";
		var rowNum = obj.value;
		objValue=obj.value;
		var rowRef = document.getElementById("stdHdrRow_" + rowNum);
		bclPaymentHdrId = 0;// not of use
		bclPaymentDtlId = 0 ;// not of use
		bclSplObligHdrId = 0;
		bclSplObliDtlId = 0;// not of use
		obligationHdrId = 0;// of no use
		obligationDtlId = 0;// used
		var entryNo;
		var taxPayableValue;
		var amountToBePaid;

		if(document.all)
		{
			bclSplObligHdrId = (rowRef.getElementsByTagName("INPUT")[1].value);
			bclSplObliDtlId = (rowRef.getElementsByTagName("INPUT")[2].value);
			obligationHdrId = (rowRef.getElementsByTagName("INPUT")[3].value);
			obligationDtlId = (rowRef.getElementsByTagName("INPUT")[4].value);
			fromDt = (rowRef.getElementsByTagName("INPUT")[5].value);
			toDt = (rowRef.getElementsByTagName("INPUT")[6].value);
			taxperiod=rowRef.getElementsByTagName("TD")[1].innerText;
			taxPayableValue=rowRef.getElementsByTagName("TD")[3].innerText;
			entryNo = rowRef.getElementsByTagName("TD")[2].innerText;
			amountToBePaid = rowRef.getElementsByTagName("TD")[5].innerText;
			/*bclSplObligHdrId= (rowRef.getElementsByTagName("INPUT")[7].value);
			bclSplObliDtlId = (rowRef.getElementsByTagName("INPUT")[8].value);
			obligationHdrId = (rowRef.getElementsByTagName("INPUT")[9].value);
			obligationDtlId = (rowRef.getElementsByTagName("INPUT")[10].value);*/


		}
		else
		{
			bclSplObligHdrId = (rowRef.getElementsByTagName("INPUT")[1].value);
			bclSplObliDtlId = (rowRef.getElementsByTagName("INPUT")[2].value);
			obligationHdrId = (rowRef.getElementsByTagName("INPUT")[3].value);
			obligationDtlId = (rowRef.getElementsByTagName("INPUT")[4].value);
			fromDt = (rowRef.getElementsByTagName("INPUT")[5].value);
			toDt = (rowRef.getElementsByTagName("INPUT")[6].value);
			taxperiod=rowRef.getElementsByTagName("TD")[1].textContent;
			taxPayableValue=rowRef.getElementsByTagName("TD")[3].textContent;
			entryNo = rowRef.getElementsByTagName("TD")[2].textContent;
			amountToBePaid = rowRef.getElementsByTagName("TD")[5].textContent;

		}
//		hide table 
		startIndexStr="";
		var parentId=null;
		document.getElementById('standardLevyFieldlset1').style.display="none";
		document.getElementById('standardLevyFieldlset').style.display="none";
		document.getElementById('standardLevydiv1').style.display="none";
		document.getElementById('standardLevyDtl1').style.display="none"; 
		document.getElementById('standardLevyAdd1').style.display="none"; 
		//show partial
		document.getElementById('standardLevyFieldlsetPatial').style.display="";
		document.getElementById('standardLevydivPartial').style.display="";
		document.getElementById('standardLevyAddPartial1').style.display=""; 
		document.getElementById('standardLevyDtlPartial1').style.display=""; 


		var year  = fromDt.substring(6);
		document.getElementById("cmbTaxPeriodYear").value = year;
		getSelectedMonthOfSelectedYearWeb('cmbTaxPeriodYear','cmbTaxPeriodMonth','false');
		document.getElementById('hidObligationFromDate').value=fromDt;
		document.getElementById('hidObligationToDate').value=toDt;
		document.getElementById("cmbTaxPeriodMonth").value =fromDt+"-"+toDt;
		document.getElementById("in_standardLevyDtlPartial1_3").value =taxperiod;
		document.getElementById("in_standardLevyDtlPartial1_12").value =fromDt;
		document.getElementById("in_standardLevyDtlPartial1_13").value =toDt;

		FetchSpecialObligationDtlWeb.fetchSpecialObligationDtlWeb(bclSplObliDtlId,standardObligationId,taxPayerId,parentId,startIndexStr,{async:false,callback:function(data){
			if(data!=null){
				document.getElementById('cmbTaxPeriodYear').disabled=true;
				document.getElementById('cmbTaxPeriodMonth').disabled=true;
				var pmtSplDetailVOList=data;
				if(pmtSplDetailVOList.length>=1 && pmtSplDetailVOList[0].isDataAvailable == "Y"){

					var pmtSplDetailVO = pmtSplDetailVOList[0];
					document.getElementById('in_standardLevyDtlPartial1_4').value = entryNo;

					if(pmtSplDetailVO.underDecPrevMnthStd != null &&pmtSplDetailVO.underDecPrevMnthStd != ""){
						document.getElementById('in_standardLevyDtlPartial1_7').value = convertToKenyanShillingFormatVal(Math.ceil(pmtSplDetailVO.underDecPrevMnthStd),true);
					}
					if(pmtSplDetailVO.overDecPrevMnthStd != null &&pmtSplDetailVO.overDecPrevMnthStd != ""){
						document.getElementById('in_standardLevyDtlPartial1_8').value = convertToKenyanShillingFormatVal(Math.ceil(pmtSplDetailVO.overDecPrevMnthStd),true);
					}
					if(pmtSplDetailVO.penaltyStd != null &&pmtSplDetailVO.penaltyStd != ""){
						document.getElementById('in_standardLevyDtlPartial1_9').value = convertToKenyanShillingFormatVal(Math.ceil(pmtSplDetailVO.penaltyStd),true);
					}
					if(pmtSplDetailVO.balAdjstStd != null &&pmtSplDetailVO.balAdjstStd != ""){
						document.getElementById('in_standardLevyDtlPartial1_10').value = convertToKenyanShillingFormatVal(Math.ceil(pmtSplDetailVO.balAdjstStd),true);
					}

					document.getElementById('in_standardLevyDtlPartial1_5').value = convertToKenyanShillingFormatVal(Math.ceil(parseInt(removeCommaFrmInput(taxPayableValue),10)),true);

					document.getElementById('in_standardLevyDtlPartial1_6').value =convertToKenyanShillingFormatVal(Math.ceil(parseInt(removeCommaFrmInput(amountToBePaid),10)),true);
					document.getElementById('in_standardLevyDtlPartial1_15').value = bclSplObliDtlId;

					fetchStdDtlForPartial(bclSplObliDtlId,standardObligationId,taxPayerId);

				}

			}

		}});

	}
}
function fetchStdDtlForPartial(bclSplObliDtlId,standardObligationId,taxPayerId){
	FetchStdDtlForPartial.fetchStdDtlForPartial(bclSplObliDtlId,standardObligationId,taxPayerId,{async:false,callback:function(data){
		if(data!=null){
			pmtSplStandardLevyDtlDTOArray = data;
			if(pmtSplStandardLevyDtlDTOArray.length>=1){
				var cntr = 0;
				var tabObj = document.getElementById("standardLevyDetailTable");
				for(var l = tabObj.rows.length; l >1 ;l--){
					tabObj.deleteRow(l -1);
				}	
				for(var i=0;i<pmtSplStandardLevyDtlDTOArray.length;i++){
					cntr = parseInt(cntr);
					var tabRow = tabObj.insertRow(tabObj.rows.length);
					tabRow.id="stdDtlRow_"+cntr;
					var tabCell = new Array();
					for (var j=0;j<6;j++){
						tabCell[j] = tabRow.insertCell(j);
					}
					var pmtSplDetailVO = pmtSplStandardLevyDtlDTOArray[i];

					tabCell[0].innerHTML = cntr+1;
					tabCell[0].style.textAlign="center";
					tabCell[0].style.fontSize="11";

					tabCell[1].innerHTML = pmtSplDetailVO.comoType;
					tabCell[1].style.textAlign="center";
					tabCell[1].style.fontSize="11";

					tabCell[2].innerHTML = pmtSplDetailVO.quntManu;
					tabCell[2].style.textAlign="center";
					tabCell[2].style.fontSize="11";

					tabCell[3].innerHTML =convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.exFactVal).toFixed(2),true);
					tabCell[3].style.textAlign="center";
					tabCell[3].style.fontSize="11";

					tabCell[4].innerHTML = pmtSplDetailVO.levyRateStd;
					tabCell[4].style.textAlign="right";
					tabCell[4].style.fontSize="11";

					tabCell[5].innerHTML = convertToKenyanShillingFormatValWithDecimal(Math.ceil(pmtSplDetailVO.amtPaidByCommo).toFixed(2),true);
					tabCell[5].style.textAlign="right";
					tabCell[5].style.fontSize="11";

					cntr = cntr+1;
				}
				document.getElementById("navigationTableSplHdr").style.display = '';
				document.getElementById("navigationTableSpltbl").style.display = '';
				document.getElementById("standardLevyDetailTable").style.display = "";
			}

		}
	}});

}


function validateStd1Dtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, paymentRegOTRStdDevDtl1Json);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}
function validateStd2Dtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, paymentRegOTRStdDevDtl2Json);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}
function validateStd3Dtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, paymentRegOTRStdDevDtl3Json);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}
function validateStd4Dtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, paymentRegOTRStdDevDtl4Json);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}
function validateStd5Dtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, paymentRegOTRStdDevDtl5Json);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}
function validateStd6Dtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, paymentRegOTRStdDevDtl6Json);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}
function validateStdAmountDtls(id)
{
	var rtnFlag;
	rtnFlag = validateFormFieldOnEvent(id, paymentRegOTRStdDevAmountDetailsJson);
	{
		getErrTabToggle('TabView','2');	
		if(!rtnFlag)
		{
			tabview_switch('TabView', '2');
			hideAndShowTable("errorDiv");
			document.getElementById('btnTbl').style.display="none";
		}
		return rtnFlag;	
	}
}

function beforeAddStandardLevyDtlPartial1(row)
{
	var checkDuplicateFlag = checkDuplicateForStandard(row,'standardLevyDtlPartial1');
	if(checkDuplicateFlag==false)
	{
		return false;
	}
	else
	{
		var taxPeriod=document.getElementById('cmbTaxPeriodMonth').selectedIndex;
		var taxPeriodValue= document.getElementById('cmbTaxPeriodMonth')[taxPeriod].text;
		var taxPeriod = document.getElementById('cmbTaxPeriodYear').selectedIndex;
		var taxPeriodYear =document.getElementById('cmbTaxPeriodYear')[taxPeriod].text;
		document.getElementById('in_standardLevyDtlPartial1_3').value=taxPeriodValue+"-"+taxPeriodYear;
		document.getElementById('standardLevyDtl1').style.display = '';
		document.getElementById('in_standardLevyDtlPartial1_14').value=document.getElementById('cmbTaxPeriodMonth').value;
		document.getElementById('hidTotalAmtPaid').value=removeCommaFrmInput(document.getElementById('in_standardLevyDtlPartial1_5').value);
		TotalAmtToPaidStandardLevy1=removeCommaFrmInput(document.getElementById('in_standardLevyDtlPartial1_6').value);
		tabObj1 = document.getElementById('standardLevyDtlPartial1');
		if(tabObj1.rows.length>6)
		{
			alert(cntAddMoreThanFive);
			return false;
		}
	}
}
function afterAddStandardLevyDtlPartial1()
{
	var tmpAmt=removeCommaFrmInput(document.getElementById('txtTotalAmountPayableOTR').value);
	var tmpAmtToPaid=removeCommaFrmInput(document.getElementById('txtTotalAmountPaidOTR').value);
	document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmtToPaid,10)+parseInt(TotalAmtToPaidStandardLevy1,10)),true); 
	document.getElementById('txtTotalAmountPayableOTR').value=convertToKenyanShillingFormatVal(removeCommaFrmInput(parseInt(tmpAmt,10)+parseInt(document.getElementById('hidTotalAmtPaid').value,10)),true); 
	selectedFlagStandardLevy1=selectedFlagStandardLevy1+1;
	document.getElementById('in_standardLevyDtlPartial1_5').value=0;
	document.getElementById('in_standardLevyDtlPartial1_6').value=0;
	document.getElementById('in_standardLevyDtlPartial1_7').value=0;
	document.getElementById('in_standardLevyDtlPartial1_8').value=0;
	document.getElementById('in_standardLevyDtlPartial1_9').value=0;
	document.getElementById('in_standardLevyDtlPartial1_10').value=0;
	//checkAmtToBePaid();
	document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
	document.getElementById('cmbTaxPeriodYear').selectedIndex=0; 
	document.getElementById('cmbTaxPeriodMonth').disabled=true;
	selectedFlagPartial=selectedFlagPartial+1;
	document.getElementById('stdRadio_'+rowNumbmerPartial).checked=false;
	document.getElementById('standardLevyDetailTable').style.display='none';
	document.getElementById('standardLevyDtl1').style.display='none';
}
function afterDeleteIntoStandardLevyDtlPartial1(rows)
{
	deleteFlagStandardLevy1 = 1;
}
function beforeDeleteStandardLevyDtlPartial1()
{

}

function validateDeleteRowIntoStandardLevyDtlPartial1(tab_str, rowno, cols)
{

	if(deleteFlagStandardLevy1==1)
	{
		var table = document.getElementById('standardLevyDtlPartial1');
		totalAmt = removeCommaFrmInput(document.getElementById('txtTotalAmountPayableOTR').value);
		var tempAmt = table.rows[rowno].cells[5].innerHTML;
		totalAmt =  parseInt(totalAmt,10) - parseInt(removeCommaFrmInput(tempAmt),10);
		document.getElementById('txtTotalAmountPayableOTR').value = convertToKenyanShillingFormatVal(totalAmt, true);
		amtToPaidStd=removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOTR").value);
		amtToPaidStd= parseInt(amtToPaidStd,10)-parseInt(removeCommaFrmInput(table.rows[rowno].cells[6].innerHTML),10);
		document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(amtToPaidStd, true);
		deleteFlagStandardLevy1 = 0;
		selectedFlagStandardLevy1 = selectedFlagStandardLevy1-1;
		selectedFlagPartial=selectedFlagPartial-1;
		currentPaymentStandard();
	}
	else
	{
		deleteFlagStandardLevy1 = 0;
	}
}

function currentPaymentStandard()
{
	if((selectedFlagPartial==0))
	{
		document.getElementById('standardLevyFieldlset1').style.display="";
		document.getElementById('standardLevyFieldlset').style.display="";
		document.getElementById('standardLevydiv1').style.display="";
		document.getElementById('standardLevyDtl1').style.display=""; 
		document.getElementById('standardLevyAdd1').style.display=""; 
		//show partial
		document.getElementById('standardLevyFieldlsetPatial').style.display="none";
		document.getElementById('standardLevydivPartial').style.display="none";
		document.getElementById('standardLevyAddPartial1').style.display="none"; 
		document.getElementById('standardLevyDtlPartial1').style.display="none"; 
		document.getElementById("standardLevyDetailTable").style.display = "none";
		document.getElementById('cmbTaxPeriodYear').disabled=false;
		document.getElementById('hidIsPartial').value = "N";
		document.getElementById('cmbTaxPeriodYear').selectedIndex=0;
		document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
	}
}

function confirmForPartialStandard()
{
	if(document.getElementById('hidIsPartial').value == "Y" || document.getElementById('hidIsPartial').value == "y" )
	{
		if(selectedFlagPartial==0)
		{
			if (confirm(previousLiabilityAddingAlert))
			{
				return addStandardLevyTable('standardLevyDtlPartial1');
			}
		}
		else
		{
			return addStandardLevyTable('standardLevyDtlPartial1');
		}
	}
}
function clearStdTblPartial1()
{
	if(clear_table('standardLevyDtlPartial1','12'))
	{
		document.getElementById('stdRadio_'+rowNumbmerPartial).checked=false;
		document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
		document.getElementById('in_standardLevyDtlPartial1_5').value=0;
		document.getElementById('in_standardLevyDtlPartial1_6').value=0;
		document.getElementById('in_standardLevyDtlPartial1_7').value=0;
		document.getElementById('in_standardLevyDtlPartial1_8').value=0;
		document.getElementById('in_standardLevyDtlPartial1_9').value=0;
		document.getElementById('in_standardLevyDtlPartial1_10').value=0;
		document.getElementById('cmbTaxPeriodYear').selectedIndex=0; 
		if(selectedFlagPartial==0)
		{

			document.getElementById('cmbTaxPeriodMonth').disabled=true;
			currentPaymentStandard();
		}
	}
}

function beforeModifyIntoStandardLevyDtlPartial1(row)
{
	var checkDuplicateFlag = addStandardLevyTable('standardLevyDtlPartial1',row);
	if(checkDuplicateFlag==false)
	{
		return false;
	}
	else
	{
		amtToPaidStd=removeCommaFrmInput(document.getElementById("txtTotalAmountPaidOTR").value);
		var taxPeriod=document.getElementById('cmbTaxPeriodMonth').selectedIndex;
		var taxPeriodValue= document.getElementById('cmbTaxPeriodMonth')[taxPeriod].text;
		var taxPeriod = document.getElementById('cmbTaxPeriodYear').selectedIndex;
		var taxPeriodYear =document.getElementById('cmbTaxPeriodYear')[taxPeriod].text;
		document.getElementById('in_standardLevyDtlPartial1_3').value=taxPeriodValue+"-"+taxPeriodYear;
		document.getElementById('in_standardLevyDtlPartial1_14').value=document.getElementById('cmbTaxPeriodMonth').value;
	}

	//document.getElementById('cmbTaxPeriodMonth').value=document.getElementById('in_widowsTable_11').value;
}


function afterModifyIntoStandardLevyDtlPartial1()
{
	modifyFlagStandardLevy1 = 0;
	commonModifyFlag=0;
	var table = document.getElementById('standardLevyDtlPartial1'); 
	amtToPaidStd = parseInt(removeCommaFrmInput(amtToPaidStd),10) + parseInt(removeCommaFrmInput(table.rows[rowno].cells[6].innerHTML),10) - parseInt(removeCommaFrmInput(TotalAmtToPaidStd),10);
	document.getElementById('txtTotalAmountPaidOTR').value=convertToKenyanShillingFormatVal(amtToPaidStd, true);
	document.getElementById('cmbTaxPeriodMonth').selectedIndex=0;
	document.getElementById('in_standardLevyDtlPartial1_5').value=0;
	document.getElementById('in_standardLevyDtlPartial1_6').value=0;
	document.getElementById('in_standardLevyDtlPartial1_7').value=0;
	document.getElementById('in_standardLevyDtlPartial1_8').value=0;
	document.getElementById('in_standardLevyDtlPartial1_9').value=0;
	document.getElementById('in_standardLevyDtlPartial1_10').value=0;
	document.getElementById('cmbTaxPeriodYear').selectedIndex=0; 
	document.getElementById('cmbTaxPeriodYear').disabled=true;
	document.getElementById('cmbTaxPeriodMonth').disabled=true;
}

function validateModifyRowIntoStandardLevyDtlPartial1(tab_str, cols_1, rowno, cols_2)
{
	modifyFlagStandardLevy1 = 1;
	commonModifyFlag=1;
	TotalAmtToPaidStd=document.getElementById('in_standardLevyDtlPartial1_6').value;
	var year =parseInt(document.getElementById('in_standardLevyDtlPartial1_14').value.substr(6, document.getElementById('in_standardLevyDtlPartial1_14').value.length),10);
	document.getElementById('cmbTaxPeriodYear').value=year;
	getSelectedMonthOfSelectedYearWeb('cmbTaxPeriodYear','cmbTaxPeriodMonth','false');
	document.getElementById('cmbTaxPeriodMonth').value=document.getElementById('in_standardLevyDtlPartial1_14').value;
	document.getElementById('cmbTaxPeriodMonth').disabled=true;
}
function isStdLevyRegistered(){
	var taxpayerId = document.getElementById('hidTaxPayerId').value;
	var obligationId = standardObligationId;

	var taxperiodFromDtStd = document.getElementById('cmbTaxPeriodMonth').value;
	var entryNoStd= document.getElementById('in_standardLevyDtl1_4').value;
	var PmtSplDetailVO = {
			taxpayerId  : taxpayerId,
			obligationId : obligationId,

			taxperiodFromDtStd : taxperiodFromDtStd,
			entryNoStd:entryNoStd
	};

	if(isSplObligationRegisteredWeb(PmtSplDetailVO))
		return true;
	else
		return false;

}